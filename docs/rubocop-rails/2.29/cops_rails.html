<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rails :: RuboCop Docs</title>
    <link rel="canonical" href="https://docs.rubocop.org/rubocop-rails/cops_rails.html">
    <link rel="prev" href="cops.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="stylesheet" href="../../_/css/site-extra.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3.3.3">
<style>:root{--docsearch-primary-color: #bd362f} </style>
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140153536-1"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-140153536-1')</script>
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://rubocop.org">RuboCop</a>
        <span class="separator">//</span>
        <a href="https://docs.rubocop.org">Docs</a>
      </div>
      <div class="navbar-item">
        <div id="docsearch"></div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href=index.html>Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Style Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://rubystyle.guide">Ruby</a>
            <a class="navbar-item" href="https://rails.rubystyle.guide">Rails</a>
            <a class="navbar-item" href="https://rspec.rubystyle.guide">RSpec</a>
            <a class="navbar-item" href="https://minitest.rubystyle.guide">Minitest</a>
          </div>
        </div>
        <a class="navbar-item" href="https://www.rubydoc.info/gems/rubocop">API Docs</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Projects</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rubocop/rubocop">RuboCop</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-ast">RuboCop AST</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-capybara">RuboCop Capybara</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-factory_bot">RuboCop factory_bot</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-minitest">RuboCop Minitest</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-performance">RuboCop Performance</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rails">RuboCop Rails</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rake">RuboCop Rake</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rspec">RuboCop RSpec</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rspec_rails">RuboCop RSpec Rails</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rubocop">GitHub Org</a>
            <a class="navbar-item" href="https://gitter.im/bbatsov/rubocop">Chat (Gitter)</a>
            <a class="navbar-item" href="https://opencollective.com/rubocop">Open Collective</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rubocop-rails" data-version="2.29">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">RuboCop Rails</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cops.html">Cops</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Cops Documentation</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="cops_rails.html">Rails</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RuboCop Rails</span>
    <span class="version">2.29</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../rubocop/index.html">RuboCop</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.72/index.html">1.72</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.71/index.html">1.71</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.70/index.html">1.70</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.69/index.html">1.69</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.68/index.html">1.68</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.67/index.html">1.67</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.66/index.html">1.66</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.65/index.html">1.65</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.64/index.html">1.64</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.63/index.html">1.63</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.62/index.html">1.62</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.61/index.html">1.61</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.60/index.html">1.60</a>
        </li>
        <li class="version">
          <a href="../../rubocop/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-ast/index.html">RuboCop AST</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-ast/index.html">master</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.12/index.html">1.12</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.11/index.html">1.11</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.10/index.html">1.10</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.9/index.html">1.9</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.8/index.html">1.8</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.7/index.html">1.7</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.6/index.html">1.6</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.5/index.html">1.5</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.4/index.html">1.4</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.3/index.html">1.3</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.2/index.html">1.2</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.1/index.html">1.1</a>
        </li>
        <li class="version">
          <a href="../../rubocop-ast/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-capybara/index.html">RuboCop Capybara</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-capybara/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop-capybara/2.21/index.html">2.21</a>
        </li>
        <li class="version">
          <a href="../../rubocop-capybara/2.20/index.html">2.20</a>
        </li>
        <li class="version">
          <a href="../../rubocop-capybara/2.19/index.html">2.19</a>
        </li>
        <li class="version">
          <a href="../../rubocop-capybara/2.18/index.html">2.18</a>
        </li>
        <li class="version">
          <a href="../../rubocop-capybara/2.17/index.html">2.17</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-factory_bot/index.html">RuboCop factory_bot</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-factory_bot/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop-factory_bot/2.26/index.html">2.26</a>
        </li>
        <li class="version">
          <a href="../../rubocop-factory_bot/2.25/index.html">2.25</a>
        </li>
        <li class="version">
          <a href="../../rubocop-factory_bot/2.24/index.html">2.24</a>
        </li>
        <li class="version">
          <a href="../../rubocop-factory_bot/2.23/index.html">2.23</a>
        </li>
        <li class="version">
          <a href="../../rubocop-factory_bot/2.22/index.html">2.22</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-minitest/index.html">RuboCop Minitest</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-minitest/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.37/index.html">0.37</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.36/index.html">0.36</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../../rubocop-minitest/0.25/index.html">0.25</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-packaging/index.html">RuboCop Packaging</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-packaging/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-performance/index.html">RuboCop Performance</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-performance/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.24/index.html">1.24</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.23/index.html">1.23</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.22/index.html">1.22</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.21/index.html">1.21</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.20/index.html">1.20</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.19/index.html">1.19</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.18/index.html">1.18</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.17/index.html">1.17</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.16/index.html">1.16</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.15/index.html">1.15</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.14/index.html">1.14</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.13/index.html">1.13</a>
        </li>
        <li class="version">
          <a href="../../rubocop-performance/1.12/index.html">1.12</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">RuboCop Rails</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../index.html">default</a>
        </li>
        <li class="version">
          <a href="../2.30/index.html">2.30</a>
        </li>
        <li class="version is-current">
          <a href="index.html">2.29</a>
        </li>
        <li class="version">
          <a href="../2.28/index.html">2.28</a>
        </li>
        <li class="version">
          <a href="../2.27/index.html">2.27</a>
        </li>
        <li class="version">
          <a href="../2.26/index.html">2.26</a>
        </li>
        <li class="version">
          <a href="../2.25/index.html">2.25</a>
        </li>
        <li class="version">
          <a href="../2.24/index.html">2.24</a>
        </li>
        <li class="version">
          <a href="../2.23/index.html">2.23</a>
        </li>
        <li class="version">
          <a href="../2.22/index.html">2.22</a>
        </li>
        <li class="version">
          <a href="../2.21/index.html">2.21</a>
        </li>
        <li class="version">
          <a href="../2.20/index.html">2.20</a>
        </li>
        <li class="version">
          <a href="../2.19/index.html">2.19</a>
        </li>
        <li class="version">
          <a href="../2.18/index.html">2.18</a>
        </li>
        <li class="version">
          <a href="../2.17/index.html">2.17</a>
        </li>
        <li class="version">
          <a href="../2.16/index.html">2.16</a>
        </li>
        <li class="version">
          <a href="../2.15/index.html">2.15</a>
        </li>
        <li class="version">
          <a href="../2.14/index.html">2.14</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-rspec/index.html">RuboCop RSpec</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-rspec/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/3.1/index.html">3.1</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/3.0/index.html">3.0</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.31/index.html">2.31</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.30/index.html">2.30</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.29/index.html">2.29</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.28/index.html">2.28</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.27/index.html">2.27</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.26/index.html">2.26</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/2.25/index.html">2.25</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec/1.44/index.html">1.44</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../rubocop-rspec_rails/index.html">RuboCop RSpec Rails</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../rubocop-rspec_rails/index.html">default</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec_rails/2.30/index.html">2.30</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec_rails/2.29/index.html">2.29</a>
        </li>
        <li class="version">
          <a href="../../rubocop-rspec_rails/2.28/index.html">2.28</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../rubocop/1.72/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">RuboCop Rails</a></li>
    <li>Cops Documentation</li>
    <li><a href="cops_rails.html">Rails</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2.29</button>
  <div class="version-menu">
    <a class="version" href="../cops_rails.html">default</a>
    <a class="version" href="../2.30/cops_rails.html">2.30</a>
    <a class="version is-current" href="cops_rails.html">2.29</a>
    <a class="version" href="../2.28/cops_rails.html">2.28</a>
    <a class="version" href="../2.27/cops_rails.html">2.27</a>
    <a class="version" href="../2.26/cops_rails.html">2.26</a>
    <a class="version" href="../2.25/cops_rails.html">2.25</a>
    <a class="version" href="../2.24/cops_rails.html">2.24</a>
    <a class="version" href="../2.23/cops_rails.html">2.23</a>
    <a class="version" href="../2.22/cops_rails.html">2.22</a>
    <a class="version" href="../2.21/cops_rails.html">2.21</a>
    <a class="version" href="../2.20/cops_rails.html">2.20</a>
    <a class="version" href="../2.19/cops_rails.html">2.19</a>
    <a class="version" href="../2.18/cops_rails.html">2.18</a>
    <a class="version" href="../2.17/cops_rails.html">2.17</a>
    <a class="version" href="../2.16/cops_rails.html">2.16</a>
    <a class="version" href="../2.15/cops_rails.html">2.15</a>
    <a class="version" href="../2.14/cops_rails.html">2.14</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/rubocop/rubocop-rails/blob/v2.29.0/docs/modules/ROOT/pages/cops_rails.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Rails</h1>
<div class="sect1">
<h2 id="railsactioncontrollerflashbeforerender"><a class="anchor" href="#railsactioncontrollerflashbeforerender"></a>Rails/ActionControllerFlashBeforeRender</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Using <code>flash</code> assignment before <code>render</code> in Rails controllers will persist the message for too long.
Check <a href="https://guides.rubyonrails.org/action_controller_overview.html#flash-now" class="bare">https://guides.rubyonrails.org/action_controller_overview.html#flash-now</a></p>
</div>
<div class="sect2">
<h3 id="safety-railsactioncontrollerflashbeforerender"><a class="anchor" href="#safety-railsactioncontrollerflashbeforerender"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it replaces <code>flash</code> by <code>flash.now</code>.
Even though it is usually a mistake, it might be used intentionally.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsactioncontrollerflashbeforerender"><a class="anchor" href="#examples-railsactioncontrollerflashbeforerender"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class HomeController &lt; ApplicationController
  def create
    flash[:alert] = "msg"
    render :index
  end
end

# good
class HomeController &lt; ApplicationController
  def create
    flash.now[:alert] = "msg"
    render :index
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactioncontrollertestcase"><a class="anchor" href="#railsactioncontrollertestcase"></a>Rails/ActionControllerTestCase</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Using <code>ActionController::TestCase</code> is discouraged and should be replaced by
<code>ActionDispatch::IntegrationTest</code>. Controller tests are too close to the
internals of a controller whereas integration tests mimic the browser/user.</p>
</div>
<div class="sect2">
<h3 id="safety-railsactioncontrollertestcase"><a class="anchor" href="#safety-railsactioncontrollertestcase"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because the API of each test case class is different.
Make sure to update each test of your controller test cases after changing the superclass.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsactioncontrollertestcase"><a class="anchor" href="#examples-railsactioncontrollertestcase"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class MyControllerTest &lt; ActionController::TestCase
end

# good
class MyControllerTest &lt; ActionDispatch::IntegrationTest
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsactioncontrollertestcase"><a class="anchor" href="#configurable-attributes-railsactioncontrollertestcase"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>**/test/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsactioncontrollertestcase"><a class="anchor" href="#references-railsactioncontrollertestcase"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#integration-testing" class="bare">https://rails.rubystyle.guide/#integration-testing</a></p>
</li>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActionController/TestCase.html" class="bare">https://api.rubyonrails.org/classes/ActionController/TestCase.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactionfilter"><a class="anchor" href="#railsactionfilter"></a>Rails/ActionFilter</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.22</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the consistent use of action filter methods.</p>
</div>
<div class="paragraph">
<p>The cop is configurable and can enforce the use of the older
something_filter methods or the newer something_action methods.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This cop is deprecated. Because the <code>*_filter</code> methods were removed in Rails 4.2,
and that Rails version is no longer supported by RuboCop Rails. This cop will be removed in RuboCop Rails 3.0.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railsactionfilter"><a class="anchor" href="#examples-railsactionfilter"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-action-_default_-railsactionfilter"><a class="anchor" href="#enforcedstyle_-action-_default_-railsactionfilter"></a>EnforcedStyle: action (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
after_filter :do_stuff
append_around_filter :do_stuff
skip_after_filter :do_stuff

# good
after_action :do_stuff
append_around_action :do_stuff
skip_after_action :do_stuff</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-filter-railsactionfilter"><a class="anchor" href="#enforcedstyle_-filter-railsactionfilter"></a>EnforcedStyle: filter</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
after_action :do_stuff
append_around_action :do_stuff
skip_after_action :do_stuff

# good
after_filter :do_stuff
append_around_filter :do_stuff
skip_after_filter :do_stuff</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsactionfilter"><a class="anchor" href="#configurable-attributes-railsactionfilter"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>action</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>action</code>, <code>filter</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/controllers/**/*.rb</code>, <code>app/mailers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactionorder"><a class="anchor" href="#railsactionorder"></a>Rails/ActionOrder</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces consistent ordering of the standard Rails RESTful controller actions.</p>
</div>
<div class="paragraph">
<p>The cop is configurable and can enforce any ordering of the standard actions.
All other methods are ignored. So, the actions specified in <code>ExpectedOrder</code> should be
defined before actions not specified.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"> Rails/ActionOrder:
   ExpectedOrder:
     - index
     - show
     - new
     - edit
     - create
     - update
     - destroy</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsactionorder"><a class="anchor" href="#examples-railsactionorder"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def index; end
def destroy; end
def show; end

# good
def index; end
def show; end
def destroy; end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsactionorder"><a class="anchor" href="#configurable-attributes-railsactionorder"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ExpectedOrder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>index</code>, <code>show</code>, <code>new</code>, <code>edit</code>, <code>create</code>, <code>update</code>, <code>destroy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/controllers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactiverecordaliases"><a class="anchor" href="#railsactiverecordaliases"></a>Rails/ActiveRecordAliases</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that ActiveRecord aliases are not used. The direct method names
are more clear and easier to read.</p>
</div>
<div class="sect2">
<h3 id="safety-railsactiverecordaliases"><a class="anchor" href="#safety-railsactiverecordaliases"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because custom <code>update_attributes</code> method call was changed to
<code>update</code> but the method name remained same in the method definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsactiverecordaliases"><a class="anchor" href="#examples-railsactiverecordaliases"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
book.update_attributes!(author: 'Alice')

# good
book.update!(author: 'Alice')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactiverecordcallbacksorder"><a class="anchor" href="#railsactiverecordcallbacksorder"></a>Rails/ActiveRecordCallbacksOrder</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that Active Record callbacks are declared
in the order in which they will be executed.</p>
</div>
<div class="sect2">
<h3 id="examples-railsactiverecordcallbacksorder"><a class="anchor" href="#examples-railsactiverecordcallbacksorder"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Person &lt; ApplicationRecord
  after_commit :after_commit_callback
  before_validation :before_validation_callback
end

# good
class Person &lt; ApplicationRecord
  before_validation :before_validation_callback
  after_commit :after_commit_callback
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsactiverecordcallbacksorder"><a class="anchor" href="#configurable-attributes-railsactiverecordcallbacksorder"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsactiverecordcallbacksorder"><a class="anchor" href="#references-railsactiverecordcallbacksorder"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#callbacks-order" class="bare">https://rails.rubystyle.guide/#callbacks-order</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactiverecordoverride"><a class="anchor" href="#railsactiverecordoverride"></a>Rails/ActiveRecordOverride</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for overriding built-in Active Record methods instead of using
callbacks.</p>
</div>
<div class="sect2">
<h3 id="examples-railsactiverecordoverride"><a class="anchor" href="#examples-railsactiverecordoverride"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Book &lt; ApplicationRecord
  def save
    self.title = title.upcase!
    super
  end
end

# good
class Book &lt; ApplicationRecord
  before_save :upcase_title

  def upcase_title
    self.title = title.upcase!
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsactiverecordoverride"><a class="anchor" href="#configurable-attributes-railsactiverecordoverride"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactivesupportaliases"><a class="anchor" href="#railsactivesupportaliases"></a>Rails/ActiveSupportAliases</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that ActiveSupport aliases to core ruby methods
are not used.</p>
</div>
<div class="sect2">
<h3 id="examples-railsactivesupportaliases"><a class="anchor" href="#examples-railsactivesupportaliases"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
'some_string'.start_with?('prefix')
'some_string'.end_with?('suffix')
[1, 2, 'a'] &lt;&lt; 'b'
[1, 2, 'a'].unshift('b')

# bad
'some_string'.starts_with?('prefix')
'some_string'.ends_with?('suffix')
[1, 2, 'a'].append('b')
[1, 2, 'a'].prepend('b')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsactivesupportonload"><a class="anchor" href="#railsactivesupportonload"></a>Rails/ActiveSupportOnLoad</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.24</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for Rails framework classes that are patched directly instead of using Active Support load hooks. Direct
patching forcibly loads the framework referenced, using hooks defers loading until it&#8217;s actually needed.</p>
</div>
<div class="sect2">
<h3 id="safety-railsactivesupportonload"><a class="anchor" href="#safety-railsactivesupportonload"></a>Safety</h3>
<div class="paragraph">
<p>While using lazy load hooks is recommended, it changes the order in which is code is loaded and may reveal
load order dependency bugs.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsactivesupportonload"><a class="anchor" href="#examples-railsactivesupportonload"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
ActiveRecord::Base.include(MyClass)

# good
ActiveSupport.on_load(:active_record) { include MyClass }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsactivesupportonload"><a class="anchor" href="#references-railsactivesupportonload"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActiveSupport/LazyLoadHooks.html" class="bare">https://api.rubyonrails.org/classes/ActiveSupport/LazyLoadHooks.html</a></p>
</li>
<li>
<p><a href="https://guides.rubyonrails.org/engines.html#available-load-hooks" class="bare">https://guides.rubyonrails.org/engines.html#available-load-hooks</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsaddcolumnindex"><a class="anchor" href="#railsaddcolumnindex"></a>Rails/AddColumnIndex</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for migrations using <code>add_column</code> that have an <code>index</code>
key. <code>add_column</code> does not accept <code>index</code>, but also does not raise an
error for extra keys, so it is possible to mistakenly add the key without
realizing it will not actually add an index.</p>
</div>
<div class="sect2">
<h3 id="examples-railsaddcolumnindex"><a class="anchor" href="#examples-railsaddcolumnindex"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad (will not add an index)
add_column :table, :column, :integer, index: true

# good
add_column :table, :column, :integer
add_index :table, :column</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsaddcolumnindex"><a class="anchor" href="#configurable-attributes-railsaddcolumnindex"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsaftercommitoverride"><a class="anchor" href="#railsaftercommitoverride"></a>Rails/AfterCommitOverride</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces that there is only one call to <code>after_commit</code>
(and its aliases - <code>after_create_commit</code>, <code>after_update_commit</code>,
and <code>after_destroy_commit</code>) with the same callback name per model.</p>
</div>
<div class="sect2">
<h3 id="examples-railsaftercommitoverride"><a class="anchor" href="#examples-railsaftercommitoverride"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
# This won't be triggered.
after_create_commit :log_action

# This will override the callback added by
# after_create_commit.
after_update_commit :log_action

# bad
# This won't be triggered.
after_commit :log_action, on: :create
# This won't be triggered.
after_update_commit :log_action
# This will override both previous callbacks.
after_commit :log_action, on: :destroy

# good
after_save_commit :log_action

# good
after_create_commit :log_create_action
after_update_commit :log_update_action</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsapplicationcontroller"><a class="anchor" href="#railsapplicationcontroller"></a>Rails/ApplicationController</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that controllers subclass <code>ApplicationController</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railsapplicationcontroller"><a class="anchor" href="#safety-railsapplicationcontroller"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it may let the logic from <code>ApplicationController</code>
sneak into a controller that is not purposed to inherit logic common among other controllers.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsapplicationcontroller"><a class="anchor" href="#examples-railsapplicationcontroller"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
class MyController &lt; ApplicationController
  # ...
end

# bad
class MyController &lt; ActionController::Base
  # ...
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsapplicationjob"><a class="anchor" href="#railsapplicationjob"></a>Rails/ApplicationJob</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.49</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that jobs subclass <code>ApplicationJob</code> with Rails 5.0.</p>
</div>
<div class="sect2">
<h3 id="safety-railsapplicationjob"><a class="anchor" href="#safety-railsapplicationjob"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it may let the logic from <code>ApplicationJob</code>
sneak into a job that is not purposed to inherit logic common among other jobs.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsapplicationjob"><a class="anchor" href="#examples-railsapplicationjob"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
class Rails5Job &lt; ApplicationJob
  # ...
end

# bad
class Rails4Job &lt; ActiveJob::Base
  # ...
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsapplicationmailer"><a class="anchor" href="#railsapplicationmailer"></a>Rails/ApplicationMailer</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that mailers subclass <code>ApplicationMailer</code> with Rails 5.0.</p>
</div>
<div class="sect2">
<h3 id="safety-railsapplicationmailer"><a class="anchor" href="#safety-railsapplicationmailer"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it may let the logic from <code>ApplicationMailer</code>
sneak into a mailer that is not purposed to inherit logic common among other mailers.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsapplicationmailer"><a class="anchor" href="#examples-railsapplicationmailer"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
class MyMailer &lt; ApplicationMailer
  # ...
end

# bad
class MyMailer &lt; ActionMailer::Base
  # ...
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsapplicationrecord"><a class="anchor" href="#railsapplicationrecord"></a>Rails/ApplicationRecord</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.49</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.26</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that models subclass <code>ApplicationRecord</code> with Rails 5.0.</p>
</div>
<div class="paragraph">
<p>It is a common practice to define models inside migrations in order to retain forward
compatibility by avoiding loading any application code. And so migration files are excluded
by default for this cop.</p>
</div>
<div class="sect2">
<h3 id="safety-railsapplicationrecord"><a class="anchor" href="#safety-railsapplicationrecord"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it may let the logic from <code>ApplicationRecord</code>
sneak into an Active Record model that is not purposed to inherit logic common among other
Active Record models.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsapplicationrecord"><a class="anchor" href="#examples-railsapplicationrecord"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
class Rails5Model &lt; ApplicationRecord
  # ...
end

# bad
class Rails4Model &lt; ActiveRecord::Base
  # ...
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsapplicationrecord"><a class="anchor" href="#configurable-attributes-railsapplicationrecord"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsarelstar"><a class="anchor" href="#railsarelstar"></a>Rails/ArelStar</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Prevents usage of <code>"*"</code> on an Arel::Table column reference.</p>
</div>
<div class="paragraph">
<p>Using <code>arel_table["<strong>"]</code> causes the outputted string to be a literal
quoted asterisk (e.g. &lt;tt&gt;`my_model`.<code></strong></code>&lt;/tt&gt;). This causes the
database to look for a column named &lt;tt&gt;`<strong><code>&lt;/tt&gt; (or `"</strong>"</code>) as opposed
to expanding the column list as one would likely expect.</p>
</div>
<div class="sect2">
<h3 id="safety-railsarelstar"><a class="anchor" href="#safety-railsarelstar"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it turns a quoted <code><strong></code> into
an SQL <code></strong></code>, unquoted. <code><strong></code> is a valid column name in certain databases
supported by Rails, and even though it is usually a mistake,
it might denote legitimate access to a column named <code></strong></code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsarelstar"><a class="anchor" href="#examples-railsarelstar"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
MyTable.arel_table["*"]

# good
MyTable.arel_table[Arel.star]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsassertnot"><a class="anchor" href="#railsassertnot"></a>Rails/AssertNot</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use <code>assert_not</code> instead of <code>assert !</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railsassertnot"><a class="anchor" href="#examples-railsassertnot"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
assert !x

# good
assert_not x</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsassertnot"><a class="anchor" href="#configurable-attributes-railsassertnot"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>**/test/**/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsattributedefaultblockvalue"><a class="anchor" href="#railsattributedefaultblockvalue"></a>Rails/AttributeDefaultBlockValue</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for <code>attribute</code> class methods that specify a <code>:default</code> option
which value is an array, string literal or method call without a block.
It will accept all other values, such as string, symbol, integer and float literals
as well as constants.</p>
</div>
<div class="sect2">
<h3 id="examples-railsattributedefaultblockvalue"><a class="anchor" href="#examples-railsattributedefaultblockvalue"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class User &lt; ApplicationRecord
  attribute :confirmed_at, :datetime, default: Time.zone.now
end

# good
class User &lt; ApplicationRecord
  attribute :confirmed_at, :datetime, default: -&gt; { Time.zone.now }
end

# bad
class User &lt; ApplicationRecord
  attribute :roles, :string, array: true, default: []
end

# good
class User &lt; ApplicationRecord
  attribute :roles, :string, array: true, default: -&gt; { [] }
end

# bad
class User &lt; ApplicationRecord
  attribute :configuration, default: {}
end

# good
class User &lt; ApplicationRecord
  attribute :configuration, default: -&gt; { {} }
end

# good
class User &lt; ApplicationRecord
  attribute :role, :string, default: :customer
end

# good
class User &lt; ApplicationRecord
  attribute :activated, :boolean, default: false
end

# good
class User &lt; ApplicationRecord
  attribute :login_count, :integer, default: 0
end

# good
class User &lt; ApplicationRecord
  FOO = 123
  attribute :custom_attribute, :integer, default: FOO
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsattributedefaultblockvalue"><a class="anchor" href="#configurable-attributes-railsattributedefaultblockvalue"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsbelongsto"><a class="anchor" href="#railsbelongsto"></a>Rails/BelongsTo</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for belongs_to associations where we control whether the
association is required via the deprecated <code>required</code> option instead.</p>
</div>
<div class="paragraph">
<p>Since Rails 5, belongs_to associations are required by default and this
can be controlled through the use of <code>optional: true</code>.</p>
</div>
<div class="paragraph">
<p>From the release notes:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>belongs_to will now trigger a validation error by default if the
association is not present. You can turn this off on a
per-association basis with optional: true. Also deprecate required
option in favor of optional for belongs_to. (Pull Request)</pre>
</div>
</div>
<div class="paragraph">
<p>In the case that the developer is doing <code>required: false</code>, we
definitely want to autocorrect to <code>optional: true</code>.</p>
</div>
<div class="paragraph">
<p>However, without knowing whether they&#8217;ve set overridden the default
value of <code>config.active_record.belongs_to_required_by_default</code>, we
can&#8217;t say whether it&#8217;s safe to remove <code>required: true</code> or whether we
should replace it with <code>optional: false</code> (or, similarly, remove a
superfluous <code>optional: false</code>). Therefore, in the cases we&#8217;re using
<code>required: true</code>, we&#8217;ll simply invert it to <code>optional: false</code> and the
user can remove depending on their defaults.</p>
</div>
<div class="sect2">
<h3 id="examples-railsbelongsto"><a class="anchor" href="#examples-railsbelongsto"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Post &lt; ApplicationRecord
  belongs_to :blog, required: false
end

# good
class Post &lt; ApplicationRecord
  belongs_to :blog, optional: true
end

# bad
class Post &lt; ApplicationRecord
  belongs_to :blog, required: true
end

# good
class Post &lt; ApplicationRecord
  belongs_to :blog, optional: false
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsbelongsto"><a class="anchor" href="#references-railsbelongsto"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://guides.rubyonrails.org/5_0_release_notes.html" class="bare">https://guides.rubyonrails.org/5_0_release_notes.html</a></p>
</li>
<li>
<p><a href="https://github.com/rails/rails/pull/18937" class="bare">https://github.com/rails/rails/pull/18937</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsblank"><a class="anchor" href="#railsblank"></a>Rails/Blank</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for code that can be written with simpler conditionals
using <code>Object#blank?</code> defined by Active Support.</p>
</div>
<div class="paragraph">
<p>Interaction with <code>Style/UnlessElse</code>:
The configuration of <code>NotPresent</code> will not produce an offense in the
context of <code>unless else</code> if <code>Style/UnlessElse</code> is enabled. This is
to prevent interference between the autocorrection of the two cops.</p>
</div>
<div class="sect2">
<h3 id="safety-railsblank"><a class="anchor" href="#safety-railsblank"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe autocorrection, because <code>' '.empty?</code> returns false,
but <code>' '.blank?</code> returns true. Therefore, autocorrection is not compatible
if the receiver is a non-empty blank string, tab, or newline meta characters.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsblank"><a class="anchor" href="#examples-railsblank"></a>Examples</h3>
<div class="sect3">
<h4 id="nilorempty_-true-_default_-railsblank"><a class="anchor" href="#nilorempty_-true-_default_-railsblank"></a>NilOrEmpty: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Converts usages of `nil? || empty?` to `blank?`

# bad
foo.nil? || foo.empty?
foo == nil || foo.empty?

# good
foo.blank?</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notpresent_-true-_default_-railsblank"><a class="anchor" href="#notpresent_-true-_default_-railsblank"></a>NotPresent: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Converts usages of `!present?` to `blank?`

# bad
!foo.present?

# good
foo.blank?</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unlesspresent_-true-_default_-railsblank"><a class="anchor" href="#unlesspresent_-true-_default_-railsblank"></a>UnlessPresent: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Converts usages of `unless present?` to `if blank?`

# bad
something unless foo.present?

# good
something if foo.blank?

# bad
unless foo.present?
  something
end

# good
if foo.blank?
  something
end

# good
def blank?
  !present?
end</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsblank"><a class="anchor" href="#configurable-attributes-railsblank"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NilOrEmpty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotPresent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UnlessPresent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsbulkchangetable"><a class="anchor" href="#railsbulkchangetable"></a>Rails/BulkChangeTable</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.57</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks whether alter queries are combinable.
If combinable queries are detected, it suggests to you
to use <code>change_table</code> with <code>bulk: true</code> instead.
This option causes the migration to generate a single
ALTER TABLE statement combining multiple column alterations.</p>
</div>
<div class="paragraph">
<p>The <code>bulk</code> option is only supported on the MySQL and
the PostgreSQL (5.2 later) adapter; thus it will
automatically detect an adapter from <code>development</code> environment
in <code>config/database.yml</code> or the environment variable <code>DATABASE_URL</code>
when the <code>Database</code> option is not set.
If the adapter is not <code>mysql2</code>, <code>trilogy</code>, <code>postgresql</code>, or <code>postgis</code>,
this Cop ignores offenses.</p>
</div>
<div class="sect2">
<h3 id="examples-railsbulkchangetable"><a class="anchor" href="#examples-railsbulkchangetable"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def change
  add_column :users, :name, :string, null: false
  add_column :users, :nickname, :string

  # ALTER TABLE `users` ADD `name` varchar(255) NOT NULL
  # ALTER TABLE `users` ADD `nickname` varchar(255)
end

# good
def change
  change_table :users, bulk: true do |t|
    t.string :name, null: false
    t.string :nickname
  end

  # ALTER TABLE `users` ADD `name` varchar(255) NOT NULL,
  #                     ADD `nickname` varchar(255)
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def change
  change_table :users do |t|
    t.string :name, null: false
    t.string :nickname
  end
end

# good
def change
  change_table :users, bulk: true do |t|
    t.string :name, null: false
    t.string :nickname
  end
end

# good
# When you don't want to combine alter queries.
def change
  change_table :users, bulk: false do |t|
    t.string :name, null: false
    t.string :nickname
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsbulkchangetable"><a class="anchor" href="#configurable-attributes-railsbulkchangetable"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;none&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql</code>, <code>postgresql</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsbulkchangetable"><a class="anchor" href="#references-railsbulkchangetable"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-change_table" class="bare">https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/SchemaStatements.html#method-i-change_table</a></p>
</li>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Table.html" class="bare">https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Table.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railscompactblank"><a class="anchor" href="#railscompactblank"></a>Rails/CompactBlank</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 6.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks if collection can be blank-compacted with <code>compact_blank</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railscompactblank"><a class="anchor" href="#safety-railscompactblank"></a>Safety</h3>
<div class="paragraph">
<p>It is unsafe by default because false positives may occur in the
blank check of block arguments to the receiver object.</p>
</div>
<div class="paragraph">
<p>For example, <code>[[1, 2], [3, nil]].reject { |first, second| second.blank? }</code> and
<code>[[1, 2], [3, nil]].compact_blank</code> are not compatible. The same is true for <code>blank?</code>.
This will work fine when the receiver is a hash object.</p>
</div>
<div class="paragraph">
<p>And <code>compact_blank!</code> has different implementations for <code>Array</code>, <code>Hash</code>, and
<code>ActionController::Parameters</code>.
<code>Array#compact_blank!</code>, <code>Hash#compact_blank!</code> are equivalent to <code>delete_if(&amp;:blank?)</code>.
If the cop makes a mistake, autocorrected code may get unexpected behavior.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railscompactblank"><a class="anchor" href="#examples-railscompactblank"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
collection.reject(&amp;:blank?)
collection.reject { |_k, v| v.blank? }
collection.select(&amp;:present?)
collection.select { |_k, v| v.present? }
collection.filter(&amp;:present?)
collection.filter { |_k, v| v.present? }

# good
collection.compact_blank

# bad
collection.delete_if(&amp;:blank?)            # Same behavior as `Array#compact_blank!` and `Hash#compact_blank!`
collection.delete_if { |_k, v| v.blank? } # Same behavior as `Array#compact_blank!` and `Hash#compact_blank!`
collection.keep_if(&amp;:present?)            # Same behavior as `Array#compact_blank!` and `Hash#compact_blank!`
collection.keep_if { |_k, v| v.present? } # Same behavior as `Array#compact_blank!` and `Hash#compact_blank!`

# good
collection.compact_blank!</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railscontenttag"><a class="anchor" href="#railscontenttag"></a>Rails/ContentTag</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.12</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks legacy syntax usage of <code>tag</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Allow <code>tag</code> when the first argument is a variable because
<code>tag(name)</code> is simpler rather than <code>tag.public_send(name)</code>.
And this cop will be renamed to something like <code>LegacyTag</code> in the future. (e.g. RuboCop Rails 3.0)
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railscontenttag"><a class="anchor" href="#examples-railscontenttag"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
tag(:p)
tag(:br, class: 'classname')

# good
tag.p
tag.br(class: 'classname')
tag(name, class: 'classname')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railscontenttag"><a class="anchor" href="#configurable-attributes-railscontenttag"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code>, <code>config/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railscontenttag"><a class="anchor" href="#references-railscontenttag"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rubocop/rubocop-rails/issues/260" class="bare">https://github.com/rubocop/rubocop-rails/issues/260</a></p>
</li>
<li>
<p><a href="https://github.com/rails/rails/issues/25195" class="bare">https://github.com/rails/rails/issues/25195</a></p>
</li>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/TagHelper.html#method-i-content_tag" class="bare">https://api.rubyonrails.org/classes/ActionView/Helpers/TagHelper.html#method-i-content_tag</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railscreatetablewithtimestamps"><a class="anchor" href="#railscreatetablewithtimestamps"></a>Rails/CreateTableWithTimestamps</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks the migration for which timestamps are not included when creating a new table.
In many cases, timestamps are useful information and should be added.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Allow <code>timestamps</code> not written when <code>id: false</code> because this emphasizes respecting
user&#8217;s editing intentions.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railscreatetablewithtimestamps"><a class="anchor" href="#examples-railscreatetablewithtimestamps"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
create_table :users

# bad
create_table :users do |t|
  t.string :name
  t.string :email
end

# good
create_table :users do |t|
  t.string :name
  t.string :email

  t.timestamps
end

# good
create_table :users do |t|
  t.string :name
  t.string :email

  t.datetime :created_at, default: -&gt; { 'CURRENT_TIMESTAMP' }
end

# good
create_table :users do |t|
  t.string :name
  t.string :email

  t.datetime :updated_at, default: -&gt; { 'CURRENT_TIMESTAMP' }
end

# good
create_table :users, articles, id: false do |t|
  t.integer :user_id
  t.integer :article_id
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railscreatetablewithtimestamps"><a class="anchor" href="#configurable-attributes-railscreatetablewithtimestamps"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*_create_active_storage_tables.active_storage.rb</code>, <code>db/**/*_create_active_storage_variant_records.active_storage.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdangerouscolumnnames"><a class="anchor" href="#railsdangerouscolumnnames"></a>Rails/DangerousColumnNames</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Avoid dangerous column names.</p>
</div>
<div class="paragraph">
<p>Some column names are considered dangerous because they would overwrite methods already defined.</p>
</div>
<div class="sect2">
<h3 id="examples-railsdangerouscolumnnames"><a class="anchor" href="#examples-railsdangerouscolumnnames"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
add_column :users, :save

# good
add_column :users, :saved</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsdangerouscolumnnames"><a class="anchor" href="#configurable-attributes-railsdangerouscolumnnames"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdate"><a class="anchor" href="#railsdate"></a>Rails/Date</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the correct use of Date methods,
such as Date.today, Date.current etc.</p>
</div>
<div class="paragraph">
<p>Using <code>Date.today</code> is dangerous, because it doesn&#8217;t know anything about
Rails time zone. You must use <code>Time.zone.today</code> instead.</p>
</div>
<div class="paragraph">
<p>The cop also reports warnings when you are using <code>to_time</code> method,
because it doesn&#8217;t know about Rails time zone either.</p>
</div>
<div class="paragraph">
<p>Two styles are supported for this cop. When <code>EnforcedStyle</code> is <code>strict</code>
then the Date methods <code>today</code>, <code>current</code>, <code>yesterday</code>, and <code>tomorrow</code>
are prohibited and the usage of both <code>to_time</code>
and <code>to_time_in_current_zone</code> are reported as warning.</p>
</div>
<div class="paragraph">
<p>When <code>EnforcedStyle</code> is <code>flexible</code> then only <code>Date.today</code> is prohibited.</p>
</div>
<div class="paragraph">
<p>And you can set a warning for <code>to_time</code> with <code>AllowToTime: false</code>.
<code>AllowToTime</code> is <code>true</code> by default to prevent false positive on <code>DateTime</code> object.</p>
</div>
<div class="sect2">
<h3 id="safety-railsdate"><a class="anchor" href="#safety-railsdate"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it may change handling time.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsdate"><a class="anchor" href="#examples-railsdate"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-flexible-_default_-railsdate"><a class="anchor" href="#enforcedstyle_-flexible-_default_-railsdate"></a>EnforcedStyle: flexible (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Date.today

# good
Time.zone.today
Time.zone.today - 1.day
Date.current
Date.yesterday
date.in_time_zone</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-strict-railsdate"><a class="anchor" href="#enforcedstyle_-strict-railsdate"></a>EnforcedStyle: strict</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Date.current
Date.yesterday
Date.today

# good
Time.zone.today
Time.zone.today - 1.day</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowtotime_-true-_default_-railsdate"><a class="anchor" href="#allowtotime_-true-_default_-railsdate"></a>AllowToTime: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
date.to_time</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowtotime_-false-railsdate"><a class="anchor" href="#allowtotime_-false-railsdate"></a>AllowToTime: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
date.to_time</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsdate"><a class="anchor" href="#configurable-attributes-railsdate"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flexible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strict</code>, <code>flexible</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowToTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdefaultscope"><a class="anchor" href="#railsdefaultscope"></a>Rails/DefaultScope</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for uses of <code>default_scope</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railsdefaultscope"><a class="anchor" href="#examples-railsdefaultscope"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
default_scope -&gt; { where(hidden: false) }

# good
scope :published, -&gt; { where(hidden: false) }

# bad
def self.default_scope
  where(hidden: false)
end

# good
def self.published
  where(hidden: false)
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdelegate"><a class="anchor" href="#railsdelegate"></a>Rails/Delegate</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.50</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for delegations that could have been created
automatically with the <code>delegate</code> method.</p>
</div>
<div class="paragraph">
<p>Safe navigation <code>&amp;.</code> is ignored because Rails' <code>allow_nil</code>
option checks not just for nil but also delegates if nil
responds to the delegated method.</p>
</div>
<div class="paragraph">
<p>The <code>EnforceForPrefixed</code> option (defaulted to <code>true</code>) means that
using the target object as a prefix of the method name
without using the <code>delegate</code> method will be a violation.
When set to <code>false</code>, this case is legal.</p>
</div>
<div class="sect2">
<h3 id="examples-railsdelegate"><a class="anchor" href="#examples-railsdelegate"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def bar
  foo.bar
end

# good
delegate :bar, to: :foo

# bad
def bar
  self.bar
end

# good
delegate :bar, to: :self

# good
def bar
  foo&amp;.bar
end

# good
private
def bar
  foo.bar
end</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="enforceforprefixed_-true-_default_-railsdelegate"><a class="anchor" href="#enforceforprefixed_-true-_default_-railsdelegate"></a>EnforceForPrefixed: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def foo_bar
  foo.bar
end

# good
delegate :bar, to: :foo, prefix: true</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforceforprefixed_-false-railsdelegate"><a class="anchor" href="#enforceforprefixed_-false-railsdelegate"></a>EnforceForPrefixed: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
def foo_bar
  foo.bar
end

# good
delegate :bar, to: :foo, prefix: true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsdelegate"><a class="anchor" href="#configurable-attributes-railsdelegate"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforceForPrefixed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdelegateallowblank"><a class="anchor" href="#railsdelegateallowblank"></a>Rails/DelegateAllowBlank</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.44</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for delegations that pass :allow_blank as an option
instead of :allow_nil. :allow_blank is not a valid option to pass
to ActiveSupport#delegate.</p>
</div>
<div class="sect2">
<h3 id="examples-railsdelegateallowblank"><a class="anchor" href="#examples-railsdelegateallowblank"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
delegate :foo, to: :bar, allow_blank: true

# good
delegate :foo, to: :bar, allow_nil: true</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdeprecatedactivemodelerrorsmethods"><a class="anchor" href="#railsdeprecatedactivemodelerrorsmethods"></a>Rails/DeprecatedActiveModelErrorsMethods</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks direct manipulation of ActiveModel#errors as hash.
These operations are deprecated in Rails 6.1 and will not work in Rails 7.</p>
</div>
<div class="sect2">
<h3 id="safety-railsdeprecatedactivemodelerrorsmethods"><a class="anchor" href="#safety-railsdeprecatedactivemodelerrorsmethods"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it can report <code>errors</code> manipulation on non-ActiveModel,
which is obviously valid.
The cop has no way of knowing whether a variable is an ActiveModel or not.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsdeprecatedactivemodelerrorsmethods"><a class="anchor" href="#examples-railsdeprecatedactivemodelerrorsmethods"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
user.errors[:name] &lt;&lt; 'msg'
user.errors.messages[:name] &lt;&lt; 'msg'

# good
user.errors.add(:name, 'msg')

# bad
user.errors[:name].clear
user.errors.messages[:name].clear

# good
user.errors.delete(:name)

# bad
user.errors.keys.include?(:attr)

# good
user.errors.attribute_names.include?(:attr)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsdeprecatedactivemodelerrorsmethods"><a class="anchor" href="#configurable-attributes-railsdeprecatedactivemodelerrorsmethods"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdotseparatedkeys"><a class="anchor" href="#railsdotseparatedkeys"></a>Rails/DotSeparatedKeys</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of dot-separated locale keys instead of specifying the <code>:scope</code> option
with an array or a single symbol in <code>I18n</code> translation methods.
Dot-separated notation is easier to read and trace the hierarchy.</p>
</div>
<div class="sect2">
<h3 id="examples-railsdotseparatedkeys"><a class="anchor" href="#examples-railsdotseparatedkeys"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
I18n.t :record_invalid, scope: [:activerecord, :errors, :messages]
I18n.t :title, scope: :invitation

# good
I18n.t 'activerecord.errors.messages.record_invalid'
I18n.t :record_invalid, scope: 'activerecord.errors.messages'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsdotseparatedkeys"><a class="anchor" href="#references-railsdotseparatedkeys"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#dot-separated-keys" class="bare">https://rails.rubystyle.guide/#dot-separated-keys</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsduplicateassociation"><a class="anchor" href="#railsduplicateassociation"></a>Rails/DuplicateAssociation</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for associations that have been defined multiple times in the same file.</p>
</div>
<div class="paragraph">
<p>When an association is defined multiple times on a model, Active Record overrides the
previously defined association with the new one. Because of this, this cop&#8217;s autocorrection
simply keeps the last of any duplicates and discards the rest.</p>
</div>
<div class="sect2">
<h3 id="examples-railsduplicateassociation"><a class="anchor" href="#examples-railsduplicateassociation"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
belongs_to :foo
belongs_to :bar
has_one :foo

# good
belongs_to :bar
has_one :foo

# bad
has_many :foo, class_name: 'Foo'
has_many :bar, class_name: 'Foo'
has_one :baz

# good
has_many :bar, class_name: 'Foo'
has_one :foo</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsduplicateassociation"><a class="anchor" href="#configurable-attributes-railsduplicateassociation"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsduplicatescope"><a class="anchor" href="#railsduplicatescope"></a>Rails/DuplicateScope</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for multiple scopes in a model that have the same <code>where</code> clause. This
often means you copy/pasted a scope, updated the name, and forgot to change the condition.</p>
</div>
<div class="sect2">
<h3 id="examples-railsduplicatescope"><a class="anchor" href="#examples-railsduplicatescope"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
scope :visible, -&gt; { where(visible: true) }
scope :hidden, -&gt; { where(visible: true) }

# good
scope :visible, -&gt; { where(visible: true) }
scope :hidden, -&gt; { where(visible: false) }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsduplicatescope"><a class="anchor" href="#configurable-attributes-railsduplicatescope"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdurationarithmetic"><a class="anchor" href="#railsdurationarithmetic"></a>Rails/DurationArithmetic</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks if a duration is added to or subtracted from <code>Time.current</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railsdurationarithmetic"><a class="anchor" href="#examples-railsdurationarithmetic"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Time.current - 1.minute
Time.current + 2.days

# good - using relative would make it harder to express and read
Date.yesterday + 3.days
created_at - 1.minute
3.days - 1.hour

# good
1.minute.ago
2.days.from_now</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsdurationarithmetic"><a class="anchor" href="#references-railsdurationarithmetic"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#duration-arithmetic" class="bare">https://rails.rubystyle.guide#duration-arithmetic</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsdynamicfindby"><a class="anchor" href="#railsdynamicfindby"></a>Rails/DynamicFindBy</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.44</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks dynamic <code>find_by_*</code> methods.
Use <code>find_by</code> instead of dynamic method.
See. <a href="https://rails.rubystyle.guide#find_by" class="bare">https://rails.rubystyle.guide#find_by</a></p>
</div>
<div class="sect2">
<h3 id="safety-railsdynamicfindby"><a class="anchor" href="#safety-railsdynamicfindby"></a>Safety</h3>
<div class="paragraph">
<p>It is certainly unsafe when not configured properly, i.e. user-defined <code>find_by_xxx</code>
method is not added to cop&#8217;s <code>AllowedMethods</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsdynamicfindby"><a class="anchor" href="#examples-railsdynamicfindby"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.find_by_name(name)
User.find_by_name_and_email(name)
User.find_by_email!(name)

# good
User.find_by(name: name)
User.find_by(name: name, email: email)
User.find_by!(email: email)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowedmethods_-__find_by_sql__-_find_by_token_for__-_default_-railsdynamicfindby"><a class="anchor" href="#allowedmethods_-__find_by_sql__-_find_by_token_for__-_default_-railsdynamicfindby"></a>AllowedMethods: ['find_by_sql', 'find_by_token_for'] (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.find_by_query(users_query)
User.find_by_token_for(:password_reset, token)

# good
User.find_by_sql(users_sql)
User.find_by_token_for(:password_reset, token)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowedreceivers_-__gem__specification__-_page__-_default_-railsdynamicfindby"><a class="anchor" href="#allowedreceivers_-__gem__specification__-_page__-_default_-railsdynamicfindby"></a>AllowedReceivers: ['Gem::Specification', 'page'] (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Specification.find_by_name('backend').gem_dir
page.find_by_id('a_dom_id').click

# good
Gem::Specification.find_by_name('backend').gem_dir
page.find_by_id('a_dom_id').click</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsdynamicfindby"><a class="anchor" href="#configurable-attributes-railsdynamicfindby"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whitelist</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>find_by_sql</code>, <code>find_by_token_for</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>find_by_sql</code>, <code>find_by_token_for</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedReceivers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Gem::Specification</code>, <code>page</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsdynamicfindby"><a class="anchor" href="#references-railsdynamicfindby"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#find_by" class="bare">https://rails.rubystyle.guide#find_by</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railseagerevaluationlogmessage"><a class="anchor" href="#railseagerevaluationlogmessage"></a>Rails/EagerEvaluationLogMessage</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that blocks are used for interpolated strings passed to
<code>Rails.logger.debug</code>.</p>
</div>
<div class="paragraph">
<p>By default, Rails production environments use the <code>:info</code> log level.
At the <code>:info</code> log level, <code>Rails.logger.debug</code> statements do not result
in log output. However, Ruby must eagerly evaluate interpolated string
arguments passed as method arguments. Passing a block to
<code>Rails.logger.debug</code> prevents costly evaluation of interpolated strings
when no output would be produced anyway.</p>
</div>
<div class="sect2">
<h3 id="examples-railseagerevaluationlogmessage"><a class="anchor" href="#examples-railseagerevaluationlogmessage"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.logger.debug "The time is #{Time.zone.now}."

# good
Rails.logger.debug { "The time is #{Time.zone.now}." }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railseagerevaluationlogmessage"><a class="anchor" href="#references-railseagerevaluationlogmessage"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://guides.rubyonrails.org/debugging_rails_applications.html#impact-of-logs-on-performance" class="bare">https://guides.rubyonrails.org/debugging_rails_applications.html#impact-of-logs-on-performance</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsenumhash"><a class="anchor" href="#railsenumhash"></a>Rails/EnumHash</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for enums written with array syntax.</p>
</div>
<div class="paragraph">
<p>When using array syntax, adding an element in a
position other than the last causes all previous
definitions to shift. Explicitly specifying the
value for each key prevents this from happening.</p>
</div>
<div class="sect2">
<h3 id="examples-railsenumhash"><a class="anchor" href="#examples-railsenumhash"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
enum :status, [:active, :archived]

# good
enum :status, { active: 0, archived: 1 }

# bad
enum status: [:active, :archived]

# good
enum status: { active: 0, archived: 1 }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsenumhash"><a class="anchor" href="#configurable-attributes-railsenumhash"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsenumhash"><a class="anchor" href="#references-railsenumhash"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#enums" class="bare">https://rails.rubystyle.guide#enums</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsenumsyntax"><a class="anchor" href="#railsenumsyntax"></a>Rails/EnumSyntax</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Requires Ruby version 3.0
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 7.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.26</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for enums written with keyword arguments syntax.</p>
</div>
<div class="paragraph">
<p>Defining enums with keyword arguments syntax is deprecated and will be removed in Rails 8.0.
Positional arguments should be used instead:</p>
</div>
<div class="sect2">
<h3 id="examples-railsenumsyntax"><a class="anchor" href="#examples-railsenumsyntax"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
enum status: { active: 0, archived: 1 }, _prefix: true

# good
enum :status, { active: 0, archived: 1 }, prefix: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsenumsyntax"><a class="anchor" href="#configurable-attributes-railsenumsyntax"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsenumuniqueness"><a class="anchor" href="#railsenumuniqueness"></a>Rails/EnumUniqueness</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.46</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for duplicate values in enum declarations.</p>
</div>
<div class="sect2">
<h3 id="examples-railsenumuniqueness"><a class="anchor" href="#examples-railsenumuniqueness"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
enum :status, { active: 0, archived: 0 }

# good
enum :status, { active: 0, archived: 1 }

# bad
enum :status, [:active, :archived, :active]

# good
enum :status, [:active, :archived]

# bad
enum status: { active: 0, archived: 0 }

# good
enum status: { active: 0, archived: 1 }

# bad
enum status: [:active, :archived, :active]

# good
enum status: [:active, :archived]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsenumuniqueness"><a class="anchor" href="#configurable-attributes-railsenumuniqueness"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsenvlocal"><a class="anchor" href="#railsenvlocal"></a>Rails/EnvLocal</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 7.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for usage of <code>Rails.env.development? || Rails.env.test?</code> which
can be replaced with <code>Rails.env.local?</code>, introduced in Rails 7.1.</p>
</div>
<div class="sect2">
<h3 id="examples-railsenvlocal"><a class="anchor" href="#examples-railsenvlocal"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.env.development? || Rails.env.test?

# good
Rails.env.local?</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsenvironmentcomparison"><a class="anchor" href="#railsenvironmentcomparison"></a>Rails/EnvironmentComparison</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that Rails.env is compared using <code>.production?</code>-like
methods instead of equality against a string or symbol.</p>
</div>
<div class="sect2">
<h3 id="examples-railsenvironmentcomparison"><a class="anchor" href="#examples-railsenvironmentcomparison"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.env == 'production'

# bad, always returns false
Rails.env == :test

# good
Rails.env.production?</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsenvironmentvariableaccess"><a class="anchor" href="#railsenvironmentvariableaccess"></a>Rails/EnvironmentVariableAccess</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.24</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for direct access to environment variables through the
<code>ENV</code> variable within the application code. This can lead to runtime
errors due to misconfiguration that could have been discovered at boot
time if the environment variables were loaded as part of initialization
and copied into the application&#8217;s configuration or secrets. The cop can
be configured to allow either reads or writes if required.</p>
</div>
<div class="sect2">
<h3 id="examples-railsenvironmentvariableaccess"><a class="anchor" href="#examples-railsenvironmentvariableaccess"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
Rails.application.config.foo
Rails.application.config.x.foo.bar
Rails.application.secrets.foo
Rails.application.config.foo = "bar"</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowreads_-false-_default_-railsenvironmentvariableaccess"><a class="anchor" href="#allowreads_-false-_default_-railsenvironmentvariableaccess"></a>AllowReads: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
ENV["FOO"]
ENV.fetch("FOO")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowreads_-true-railsenvironmentvariableaccess"><a class="anchor" href="#allowreads_-true-railsenvironmentvariableaccess"></a>AllowReads: true</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
ENV["FOO"]
ENV.fetch("FOO")</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowwrites_-false-_default_-railsenvironmentvariableaccess"><a class="anchor" href="#allowwrites_-false-_default_-railsenvironmentvariableaccess"></a>AllowWrites: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
ENV["FOO"] = "bar"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowwrites_-true-railsenvironmentvariableaccess"><a class="anchor" href="#allowwrites_-true-railsenvironmentvariableaccess"></a>AllowWrites: true</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
ENV["FOO"] = "bar"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsenvironmentvariableaccess"><a class="anchor" href="#configurable-attributes-railsenvironmentvariableaccess"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/**/*.rb</code>, <code>config/initializers/**/*.rb</code>, <code>lib/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/**/*.rake</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowReads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowWrites</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsexit"><a class="anchor" href="#railsexit"></a>Rails/Exit</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.41</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces that <code>exit</code> calls are not used within a rails app.
Valid options are instead to raise an error, break, return, or some
other form of stopping execution of current request.</p>
</div>
<div class="paragraph">
<p>There are two obvious cases where <code>exit</code> is particularly harmful:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Usage in library code for your application. Even though Rails will
rescue from a <code>SystemExit</code> and continue on, unit testing that library
code will result in specs exiting (potentially silently if <code>exit(0)</code>
is used.)</p>
</li>
<li>
<p>Usage in application code outside of the web process could result in
the program exiting, which could result in the code failing to run and
do its job.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="examples-railsexit"><a class="anchor" href="#examples-railsexit"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
exit(0)

# good
raise 'a bad error has happened'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsexit"><a class="anchor" href="#configurable-attributes-railsexit"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/**/*.rb</code>, <code>config/**/*.rb</code>, <code>lib/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/**/*.rake</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsexpandeddaterange"><a class="anchor" href="#railsexpandeddaterange"></a>Rails/ExpandedDateRange</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for expanded date range. It only compatible <code>..</code> range is targeted.
Incompatible <code>&#8230;&#8203;</code> range is ignored.</p>
</div>
<div class="sect2">
<h3 id="examples-railsexpandeddaterange"><a class="anchor" href="#examples-railsexpandeddaterange"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
date.beginning_of_day..date.end_of_day
date.beginning_of_week..date.end_of_week
date.beginning_of_month..date.end_of_month
date.beginning_of_quarter..date.end_of_quarter
date.beginning_of_year..date.end_of_year

# good
date.all_day
date.all_week
date.all_month
date.all_quarter
date.all_year</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsexpandeddaterange"><a class="anchor" href="#references-railsexpandeddaterange"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#date-time-range" class="bare">https://rails.rubystyle.guide/#date-time-range</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsfilepath"><a class="anchor" href="#railsfilepath"></a>Rails/FilePath</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of file path joining process to use <code>Rails.root.join</code> clause.
It is used to add uniformity when joining paths.</p>
</div>
<div class="sect2">
<h3 id="examples-railsfilepath"><a class="anchor" href="#examples-railsfilepath"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-slashes-_default_-railsfilepath"><a class="anchor" href="#enforcedstyle_-slashes-_default_-railsfilepath"></a>EnforcedStyle: slashes (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.root.join('app', 'models', 'goober')

# good
Rails.root.join('app/models/goober')

# bad
File.join(Rails.root, 'app/models/goober')
"#{Rails.root}/app/models/goober"

# good
Rails.root.join('app/models/goober').to_s</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-arguments-railsfilepath"><a class="anchor" href="#enforcedstyle_-arguments-railsfilepath"></a>EnforcedStyle: arguments</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.root.join('app/models/goober')

# good
Rails.root.join('app', 'models', 'goober')

# bad
File.join(Rails.root, 'app/models/goober')
"#{Rails.root}/app/models/goober"

# good
Rails.root.join('app', 'models', 'goober').to_s</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsfilepath"><a class="anchor" href="#configurable-attributes-railsfilepath"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>slashes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>slashes</code>, <code>arguments</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsfindby"><a class="anchor" href="#railsfindby"></a>Rails/FindBy</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.21</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>where.take</code> and change them to use <code>find_by</code> instead.</p>
</div>
<div class="paragraph">
<p>And <code>where(&#8230;&#8203;).first</code> can return different results from <code>find_by</code>.
(They order records differently, so the "first" record can be different.)</p>
</div>
<div class="paragraph">
<p>If you also want to detect <code>where.first</code>, you can set <code>IgnoreWhereFirst</code> to false.</p>
</div>
<div class="sect2">
<h3 id="examples-railsfindby"><a class="anchor" href="#examples-railsfindby"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where(name: 'Bruce').take

# good
User.find_by(name: 'Bruce')</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="ignorewherefirst_-true-_default_-railsfindby"><a class="anchor" href="#ignorewherefirst_-true-_default_-railsfindby"></a>IgnoreWhereFirst: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
User.where(name: 'Bruce').first</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ignorewherefirst_-false-railsfindby"><a class="anchor" href="#ignorewherefirst_-false-railsfindby"></a>IgnoreWhereFirst: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where(name: 'Bruce').first</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsfindby"><a class="anchor" href="#configurable-attributes-railsfindby"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IgnoreWhereFirst</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsfindby"><a class="anchor" href="#references-railsfindby"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#find_by" class="bare">https://rails.rubystyle.guide#find_by</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsfindbyid"><a class="anchor" href="#railsfindbyid"></a>Rails/FindById</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces that <code>ActiveRecord#find</code> is used instead of
<code>where.take!</code>, <code>find_by!</code>, and <code>find_by_id!</code> to retrieve a single record
by primary key when you expect it to be found.</p>
</div>
<div class="sect2">
<h3 id="examples-railsfindbyid"><a class="anchor" href="#examples-railsfindbyid"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where(id: id).take!
User.find_by_id!(id)
User.find_by!(id: id)

# good
User.find(id)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsfindbyid"><a class="anchor" href="#references-railsfindbyid"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#find" class="bare">https://rails.rubystyle.guide/#find</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsfindeach"><a class="anchor" href="#railsfindeach"></a>Rails/FindEach</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.21</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>all.each</code> and change them to use <code>all.find_each</code> instead.</p>
</div>
<div class="sect2">
<h3 id="safety-railsfindeach"><a class="anchor" href="#safety-railsfindeach"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe if the receiver object is not an Active Record object.
Also, <code>all.each</code> returns an <code>Array</code> instance and <code>all.find_each</code> returns nil,
so the return values are different.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsfindeach"><a class="anchor" href="#examples-railsfindeach"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.all.each

# good
User.all.find_each</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowedmethods_-__order__-railsfindeach"><a class="anchor" href="#allowedmethods_-__order__-railsfindeach"></a>AllowedMethods: ['order']</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
User.order(:foo).each</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowedpattern_-__order__-railsfindeach"><a class="anchor" href="#allowedpattern_-__order__-railsfindeach"></a>AllowedPattern: ['order']</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
User.order(:foo).each</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsfindeach"><a class="anchor" href="#configurable-attributes-railsfindeach"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>order</code>, <code>limit</code>, <code>select</code>, <code>lock</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedPatterns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsfindeach"><a class="anchor" href="#references-railsfindeach"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#find-each" class="bare">https://rails.rubystyle.guide#find-each</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsfreezetime"><a class="anchor" href="#railsfreezetime"></a>Rails/FreezeTime</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.2
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>travel_to</code> with an argument of the current time and
change them to use <code>freeze_time</code> instead.</p>
</div>
<div class="sect2">
<h3 id="safety-railsfreezetime"><a class="anchor" href="#safety-railsfreezetime"></a>Safety</h3>
<div class="paragraph">
<p>This cops autocorrection is unsafe because <code>freeze_time</code> just delegates to
<code>travel_to</code> with a default <code>Time.now</code>, it is not strictly equivalent to <code>Time.now</code>
if the argument of <code>travel_to</code> is the current time considering time zone.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsfreezetime"><a class="anchor" href="#examples-railsfreezetime"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
travel_to(Time.now)
travel_to(Time.new)
travel_to(DateTime.now)
travel_to(Time.current)
travel_to(Time.zone.now)
travel_to(Time.now.in_time_zone)
travel_to(Time.current.to_time)

# good
freeze_time</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsfreezetime"><a class="anchor" href="#references-railsfreezetime"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#freeze-time" class="bare">https://rails.rubystyle.guide/#freeze-time</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railshasandbelongstomany"><a class="anchor" href="#railshasandbelongstomany"></a>Rails/HasAndBelongsToMany</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of the has_and_belongs_to_many macro.</p>
</div>
<div class="sect2">
<h3 id="examples-railshasandbelongstomany"><a class="anchor" href="#examples-railshasandbelongstomany"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
# has_and_belongs_to_many :ingredients

# good
# has_many :ingredients, through: :recipe_ingredients</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railshasandbelongstomany"><a class="anchor" href="#configurable-attributes-railshasandbelongstomany"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railshasandbelongstomany"><a class="anchor" href="#references-railshasandbelongstomany"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#has-many-through" class="bare">https://rails.rubystyle.guide#has-many-through</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railshasmanyorhasonedependent"><a class="anchor" href="#railshasmanyorhasonedependent"></a>Rails/HasManyOrHasOneDependent</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for <code>has_many</code> or <code>has_one</code> associations that don&#8217;t
specify a <code>:dependent</code> option.</p>
</div>
<div class="paragraph">
<p>It doesn&#8217;t register an offense if <code>:through</code> or <code>dependent: nil</code>
is specified, or if the model is read-only.</p>
</div>
<div class="sect2">
<h3 id="examples-railshasmanyorhasonedependent"><a class="anchor" href="#examples-railshasmanyorhasonedependent"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class User &lt; ActiveRecord::Base
  has_many :comments
  has_one :avatar
end

# good
class User &lt; ActiveRecord::Base
  has_many :comments, dependent: :restrict_with_exception
  has_one :avatar, dependent: :destroy
  has_many :articles, dependent: nil
  has_many :patients, through: :appointments
end

class User &lt; ActiveRecord::Base
  has_many :comments
  has_one :avatar

  def readonly?
    true
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railshasmanyorhasonedependent"><a class="anchor" href="#configurable-attributes-railshasmanyorhasonedependent"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railshasmanyorhasonedependent"><a class="anchor" href="#references-railshasmanyorhasonedependent"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#has_many-has_one-dependent-option" class="bare">https://rails.rubystyle.guide#has_many-has_one-dependent-option</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railshelperinstancevariable"><a class="anchor" href="#railshelperinstancevariable"></a>Rails/HelperInstanceVariable</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for use of the helper methods which reference
instance variables.</p>
</div>
<div class="paragraph">
<p>Relying on instance variables makes it difficult to reuse helper
methods.</p>
</div>
<div class="paragraph">
<p>If it seems awkward to explicitly pass in each dependent
variable, consider moving the behavior elsewhere, for
example to a model, decorator or presenter.</p>
</div>
<div class="paragraph">
<p>Provided that a class inherits <code>ActionView::Helpers::FormBuilder</code>,
an offense will not be registered.</p>
</div>
<div class="sect2">
<h3 id="examples-railshelperinstancevariable"><a class="anchor" href="#examples-railshelperinstancevariable"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def welcome_message
  "Hello #{@user.name}"
end

# good
def welcome_message(user)
  "Hello #{user.name}"
end

# good
class MyFormBuilder &lt; ActionView::Helpers::FormBuilder
  @template.do_something
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railshelperinstancevariable"><a class="anchor" href="#configurable-attributes-railshelperinstancevariable"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/helpers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railshttppositionalarguments"><a class="anchor" href="#railshttppositionalarguments"></a>Rails/HttpPositionalArguments</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.44</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of http methods like <code>get</code>, <code>post</code>,
<code>put</code>, <code>patch</code> without the usage of keyword arguments in your tests and
change them to use keyword args. This cop only applies to Rails &gt;= 5.
If you are running Rails &lt; 5 you should disable the
Rails/HttpPositionalArguments cop or set your TargetRailsVersion in your
.rubocop.yml file to 4.2.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It does not detect any cases where <code>include Rack::Test::Methods</code> is used
which makes the http methods incompatible behavior.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railshttppositionalarguments"><a class="anchor" href="#examples-railshttppositionalarguments"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
get :new, { user_id: 1}

# good
get :new, params: { user_id: 1 }
get :new, **options</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railshttppositionalarguments"><a class="anchor" href="#configurable-attributes-railshttppositionalarguments"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spec/**/*</code>, <code>test/**/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railshttpstatus"><a class="anchor" href="#railshttpstatus"></a>Rails/HttpStatus</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.54</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces use of symbolic or numeric value to define HTTP status.</p>
</div>
<div class="sect2">
<h3 id="examples-railshttpstatus"><a class="anchor" href="#examples-railshttpstatus"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-symbolic-_default_-railshttpstatus"><a class="anchor" href="#enforcedstyle_-symbolic-_default_-railshttpstatus"></a>EnforcedStyle: symbolic (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
render :foo, status: 200
render :foo, status: '200'
render json: { foo: 'bar' }, status: 200
render plain: 'foo/bar', status: 304
redirect_to root_url, status: 301
head 200
assert_response 200
assert_redirected_to '/some/path', status: 301

# good
render :foo, status: :ok
render json: { foo: 'bar' }, status: :ok
render plain: 'foo/bar', status: :not_modified
redirect_to root_url, status: :moved_permanently
head :ok
assert_response :ok
assert_redirected_to '/some/path', status: :moved_permanently</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-numeric-railshttpstatus"><a class="anchor" href="#enforcedstyle_-numeric-railshttpstatus"></a>EnforcedStyle: numeric</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
render :foo, status: :ok
render json: { foo: 'bar' }, status: :not_found
render plain: 'foo/bar', status: :not_modified
redirect_to root_url, status: :moved_permanently
head :ok
assert_response :ok
assert_redirected_to '/some/path', status: :moved_permanently

# good
render :foo, status: 200
render json: { foo: 'bar' }, status: 404
render plain: 'foo/bar', status: 304
redirect_to root_url, status: 301
head 200
assert_response 200
assert_redirected_to '/some/path', status: 301</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railshttpstatus"><a class="anchor" href="#configurable-attributes-railshttpstatus"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>symbolic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>numeric</code>, <code>symbolic</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsi18nlazylookup"><a class="anchor" href="#railsi18nlazylookup"></a>Rails/I18nLazyLookup</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for places where I18n "lazy" lookup can be used.</p>
</div>
<div class="paragraph">
<p>This cop has two different enforcement modes. When the EnforcedStyle
is <code>lazy</code> (the default), explicit lookups are added as offenses.</p>
</div>
<div class="paragraph">
<p>When the EnforcedStyle is <code>explicit</code> then lazy lookups are added as
offenses.</p>
</div>
<div class="sect2">
<h3 id="examples-railsi18nlazylookup"><a class="anchor" href="#examples-railsi18nlazylookup"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-lazy-_default_-railsi18nlazylookup"><a class="anchor" href="#enforcedstyle_-lazy-_default_-railsi18nlazylookup"></a>EnforcedStyle: lazy (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># en.yml
# en:
#   books:
#     create:
#       success: Book created!

# bad
class BooksController &lt; ApplicationController
  def create
    # ...
    redirect_to books_url, notice: t('books.create.success')
  end
end

# good
class BooksController &lt; ApplicationController
  def create
    # ...
    redirect_to books_url, notice: t('.success')
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-explicit-railsi18nlazylookup"><a class="anchor" href="#enforcedstyle_-explicit-railsi18nlazylookup"></a>EnforcedStyle: explicit</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class BooksController &lt; ApplicationController
  def create
    # ...
    redirect_to books_url, notice: t('.success')
  end
end

# good
class BooksController &lt; ApplicationController
  def create
    # ...
    redirect_to books_url, notice: t('books.create.success')
  end
end</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsi18nlazylookup"><a class="anchor" href="#configurable-attributes-railsi18nlazylookup"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lazy</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lazy</code>, <code>explicit</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/controllers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsi18nlazylookup"><a class="anchor" href="#references-railsi18nlazylookup"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#lazy-lookup" class="bare">https://rails.rubystyle.guide/#lazy-lookup</a></p>
</li>
<li>
<p><a href="https://guides.rubyonrails.org/i18n.html#lazy-lookup" class="bare">https://guides.rubyonrails.org/i18n.html#lazy-lookup</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsi18nlocaleassignment"><a class="anchor" href="#railsi18nlocaleassignment"></a>Rails/I18nLocaleAssignment</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of <code>I18n.locale=</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>locale</code> attribute persists for the rest of the Ruby runtime, potentially causing
unexpected behavior at a later time.
Using <code>I18n.with_locale</code> ensures the code passed in the block is the only place <code>I18n.locale</code> is affected.
It eliminates the possibility of a <code>locale</code> sticking around longer than intended.</p>
</div>
<div class="sect2">
<h3 id="examples-railsi18nlocaleassignment"><a class="anchor" href="#examples-railsi18nlocaleassignment"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
I18n.locale = :fr

# good
I18n.with_locale(:fr) do
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsi18nlocaleassignment"><a class="anchor" href="#configurable-attributes-railsi18nlocaleassignment"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spec/**/*.rb</code>, <code>test/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsi18nlocaletexts"><a class="anchor" href="#railsi18nlocaletexts"></a>Rails/I18nLocaleTexts</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces use of I18n and locale files instead of locale specific strings.</p>
</div>
<div class="sect2">
<h3 id="examples-railsi18nlocaletexts"><a class="anchor" href="#examples-railsi18nlocaletexts"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class User &lt; ApplicationRecord
  validates :email, presence: { message: "must be present" }
end

# good
# config/locales/en.yml
# en:
#   activerecord:
#     errors:
#       models:
#         user:
#           blank: "must be present"

class User &lt; ApplicationRecord
  validates :email, presence: true
end

# bad
class PostsController &lt; ApplicationController
  def create
    # ...
    redirect_to root_path, notice: "Post created!"
  end
end

# good
# config/locales/en.yml
# en:
#   posts:
#     create:
#       success: "Post created!"

class PostsController &lt; ApplicationController
  def create
    # ...
    redirect_to root_path, notice: t(".success")
  end
end

# bad
class UserMailer &lt; ApplicationMailer
  def welcome(user)
    mail(to: user.email, subject: "Welcome to My Awesome Site")
  end
end

# good
# config/locales/en.yml
# en:
#   user_mailer:
#     welcome:
#       subject: "Welcome to My Awesome Site"

class UserMailer &lt; ApplicationMailer
  def welcome(user)
    mail(to: user.email)
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsi18nlocaletexts"><a class="anchor" href="#references-railsi18nlocaletexts"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#locale-texts" class="bare">https://rails.rubystyle.guide/#locale-texts</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsignoredcolumnsassignment"><a class="anchor" href="#railsignoredcolumnsassignment"></a>Rails/IgnoredColumnsAssignment</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for assignments of <code>ignored_columns</code> that may override previous
assignments.</p>
</div>
<div class="paragraph">
<p>Overwriting previous assignments is usually a mistake, since it will
un-ignore the first set of columns. Since duplicate column names is not
a problem, it is better to simply append to the list.</p>
</div>
<div class="sect2">
<h3 id="examples-railsignoredcolumnsassignment"><a class="anchor" href="#examples-railsignoredcolumnsassignment"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class User &lt; ActiveRecord::Base
  self.ignored_columns = [:one]
end

# bad
class User &lt; ActiveRecord::Base
  self.ignored_columns = [:one, :two]
end

# good
class User &lt; ActiveRecord::Base
  self.ignored_columns += [:one, :two]
end

# good
class User &lt; ActiveRecord::Base
  self.ignored_columns += [:one]
  self.ignored_columns += [:two]
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsignoredcolumnsassignment"><a class="anchor" href="#references-railsignoredcolumnsassignment"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#append-ignored-columns" class="bare">https://rails.rubystyle.guide/#append-ignored-columns</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsignoredskipactionfilteroption"><a class="anchor" href="#railsignoredskipactionfilteroption"></a>Rails/IgnoredSkipActionFilterOption</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that <code>if</code> and <code>only</code> (or <code>except</code>) are not used together
as options of <code>skip_*</code> action filter.</p>
</div>
<div class="paragraph">
<p>The <code>if</code> option will be ignored when <code>if</code> and <code>only</code> are used together.
Similarly, the <code>except</code> option will be ignored when <code>if</code> and <code>except</code>
are used together.</p>
</div>
<div class="sect2">
<h3 id="examples-railsignoredskipactionfilteroption"><a class="anchor" href="#examples-railsignoredskipactionfilteroption"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class MyPageController &lt; ApplicationController
  skip_before_action :login_required,
    only: :show, if: :trusted_origin?
end

# good
class MyPageController &lt; ApplicationController
  skip_before_action :login_required,
    if: -&gt; { trusted_origin? &amp;&amp; action_name == "show" }
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class MyPageController &lt; ApplicationController
  skip_before_action :login_required,
    except: :admin, if: :trusted_origin?
end

# good
class MyPageController &lt; ApplicationController
  skip_before_action :login_required,
    if: -&gt; { trusted_origin? &amp;&amp; action_name != "admin" }
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsignoredskipactionfilteroption"><a class="anchor" href="#configurable-attributes-railsignoredskipactionfilteroption"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/controllers/**/*.rb</code>, <code>app/mailers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsignoredskipactionfilteroption"><a class="anchor" href="#references-railsignoredskipactionfilteroption"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://api.rubyonrails.org/classes/AbstractController/Callbacks/ClassMethods.html#method-i-_normalize_callback_options" class="bare">https://api.rubyonrails.org/classes/AbstractController/Callbacks/ClassMethods.html#method-i-_normalize_callback_options</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsindexby"><a class="anchor" href="#railsindexby"></a>Rails/IndexBy</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for uses of <code>each_with_object({}) { &#8230;&#8203; }</code>,
<code>map { &#8230;&#8203; }.to_h</code>, and <code>Hash[map { &#8230;&#8203; }]</code> that are transforming
an enumerable into a hash where the values are the original elements.
Rails provides the <code>index_by</code> method for this purpose.</p>
</div>
<div class="sect2">
<h3 id="examples-railsindexby"><a class="anchor" href="#examples-railsindexby"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3].each_with_object({}) { |el, h| h[foo(el)] = el }
[1, 2, 3].to_h { |el| [foo(el), el] }
[1, 2, 3].map { |el| [foo(el), el] }.to_h
Hash[[1, 2, 3].collect { |el| [foo(el), el] }]

# good
[1, 2, 3].index_by { |el| foo(el) }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsindexwith"><a class="anchor" href="#railsindexwith"></a>Rails/IndexWith</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 6.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for uses of <code>each_with_object({}) { &#8230;&#8203; }</code>,
<code>map { &#8230;&#8203; }.to_h</code>, and <code>Hash[map { &#8230;&#8203; }]</code> that are transforming
an enumerable into a hash where the keys are the original elements.
Rails provides the <code>index_with</code> method for this purpose.</p>
</div>
<div class="sect2">
<h3 id="examples-railsindexwith"><a class="anchor" href="#examples-railsindexwith"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3].each_with_object({}) { |el, h| h[el] = foo(el) }
[1, 2, 3].to_h { |el| [el, foo(el)] }
[1, 2, 3].map { |el| [el, foo(el)] }.to_h
Hash[[1, 2, 3].collect { |el| [el, foo(el)] }]

# good
[1, 2, 3].index_with { |el| foo(el) }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsinquiry"><a class="anchor" href="#railsinquiry"></a>Rails/Inquiry</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that Active Support&#8217;s <code>inquiry</code> method is not used.</p>
</div>
<div class="sect2">
<h3 id="examples-railsinquiry"><a class="anchor" href="#examples-railsinquiry"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad - String#inquiry
ruby = 'two'.inquiry
ruby.two?

# good
ruby = 'two'
ruby == 'two'

# bad - Array#inquiry
pets = %w(cat dog).inquiry
pets.gopher?

# good
pets = %w(cat dog)
pets.include? 'cat'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsinquiry"><a class="anchor" href="#references-railsinquiry"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#inquiry" class="bare">https://rails.rubystyle.guide/#inquiry</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsinverseof"><a class="anchor" href="#railsinverseof"></a>Rails/InverseOf</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for has_(one|many) and belongs_to associations where
Active Record can&#8217;t automatically determine the inverse association
because of a scope or the options used. Using the blog with order scope
example below, traversing the a Blog&#8217;s association in both directions
with <code>blog.posts.first.blog</code> would cause the <code>blog</code> to be loaded from
the database twice.</p>
</div>
<div class="paragraph">
<p><code>:inverse_of</code> must be manually specified for Active Record to use the
associated object in memory, or set to <code>false</code> to opt-out. Note that
setting <code>nil</code> does not stop Active Record from trying to determine the
inverse automatically, and is not considered a valid value for this.</p>
</div>
<div class="sect2">
<h3 id="examples-railsinverseof"><a class="anchor" href="#examples-railsinverseof"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
class Blog &lt; ApplicationRecord
  has_many :posts
end

class Post &lt; ApplicationRecord
  belongs_to :blog
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Blog &lt; ApplicationRecord
  has_many :posts, -&gt; { order(published_at: :desc) }
end

class Post &lt; ApplicationRecord
  belongs_to :blog
end

# good
class Blog &lt; ApplicationRecord
  has_many(:posts,
           -&gt; { order(published_at: :desc) },
           inverse_of: :blog)
end

class Post &lt; ApplicationRecord
  belongs_to :blog
end

# good
class Blog &lt; ApplicationRecord
  with_options inverse_of: :blog do
    has_many :posts, -&gt; { order(published_at: :desc) }
  end
end

class Post &lt; ApplicationRecord
  belongs_to :blog
end

# good
# When you don't want to use the inverse association.
class Blog &lt; ApplicationRecord
  has_many(:posts,
           -&gt; { order(published_at: :desc) },
           inverse_of: false)
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Picture &lt; ApplicationRecord
  belongs_to :imageable, polymorphic: true
end

class Employee &lt; ApplicationRecord
  has_many :pictures, as: :imageable
end

class Product &lt; ApplicationRecord
  has_many :pictures, as: :imageable
end

# good
class Picture &lt; ApplicationRecord
  belongs_to :imageable, polymorphic: true
end

class Employee &lt; ApplicationRecord
  has_many :pictures, as: :imageable, inverse_of: :imageable
end

class Product &lt; ApplicationRecord
  has_many :pictures, as: :imageable, inverse_of: :imageable
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
# However, RuboCop can not detect this pattern...
class Physician &lt; ApplicationRecord
  has_many :appointments
  has_many :patients, through: :appointments
end

class Appointment &lt; ApplicationRecord
  belongs_to :physician
  belongs_to :patient
end

class Patient &lt; ApplicationRecord
  has_many :appointments
  has_many :physicians, through: :appointments
end

# good
class Physician &lt; ApplicationRecord
  has_many :appointments
  has_many :patients, through: :appointments
end

class Appointment &lt; ApplicationRecord
  belongs_to :physician, inverse_of: :appointments
  belongs_to :patient, inverse_of: :appointments
end

class Patient &lt; ApplicationRecord
  has_many :appointments
  has_many :physicians, through: :appointments
end</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="ignorescopes_-false-_default_-railsinverseof"><a class="anchor" href="#ignorescopes_-false-_default_-railsinverseof"></a>IgnoreScopes: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Blog &lt; ApplicationRecord
  has_many :posts, -&gt; { order(published_at: :desc) }
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ignorescopes_-true-railsinverseof"><a class="anchor" href="#ignorescopes_-true-railsinverseof"></a>IgnoreScopes: true</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
class Blog &lt; ApplicationRecord
  has_many :posts, -&gt; { order(published_at: :desc) }
end</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsinverseof"><a class="anchor" href="#configurable-attributes-railsinverseof"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IgnoreScopes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsinverseof"><a class="anchor" href="#references-railsinverseof"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://guides.rubyonrails.org/association_basics.html#bi-directional-associations" class="bare">https://guides.rubyonrails.org/association_basics.html#bi-directional-associations</a></p>
</li>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Setting+Inverses" class="bare">https://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Setting+Inverses</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railslexicallyscopedactionfilter"><a class="anchor" href="#railslexicallyscopedactionfilter"></a>Rails/LexicallyScopedActionFilter</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that methods specified in the filter&#8217;s <code>only</code> or
<code>except</code> options are defined within the same class or module.</p>
</div>
<div class="sect2">
<h3 id="safety-railslexicallyscopedactionfilter"><a class="anchor" href="#safety-railslexicallyscopedactionfilter"></a>Safety</h3>
<div class="paragraph">
<p>You can technically specify methods of superclass or methods added by
mixins on the filter, but these can confuse developers. If you specify
methods that are defined in other classes or modules, you should
define the filter in that class or module.</p>
</div>
<div class="paragraph">
<p>If you rely on behavior defined in the superclass actions, you must
remember to invoke <code>super</code> in the subclass actions.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railslexicallyscopedactionfilter"><a class="anchor" href="#examples-railslexicallyscopedactionfilter"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class LoginController &lt; ApplicationController
  before_action :require_login, only: %i[index settings logout]

  def index
  end
end

# good
class LoginController &lt; ApplicationController
  before_action :require_login, only: %i[index settings logout]

  def index
  end

  def settings
  end

  def logout
  end
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
module FooMixin
  extend ActiveSupport::Concern

  included do
    before_action proc { authenticate }, only: :foo
  end
end

# good
module FooMixin
  extend ActiveSupport::Concern

  included do
    before_action proc { authenticate }, only: :foo
  end

  def foo
    # something
  end
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">class ContentController &lt; ApplicationController
  def update
    @content.update(content_attributes)
  end
end

class ArticlesController &lt; ContentController
  before_action :load_article, only: [:update]

  # the cop requires this method, but it relies on behavior defined
  # in the superclass, so needs to invoke `super`
  def update
    super
  end

  private

  def load_article
    @content = Article.find(params[:article_id])
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railslexicallyscopedactionfilter"><a class="anchor" href="#configurable-attributes-railslexicallyscopedactionfilter"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/controllers/**/*.rb</code>, <code>app/mailers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railslexicallyscopedactionfilter"><a class="anchor" href="#references-railslexicallyscopedactionfilter"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#lexically-scoped-action-filter" class="bare">https://rails.rubystyle.guide#lexically-scoped-action-filter</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railslinktoblank"><a class="anchor" href="#railslinktoblank"></a>Rails/LinkToBlank</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for calls to <code>link_to</code>, <code>link_to_if</code>, and <code>link_to_unless</code> methods that contain a
<code>target: '_blank'</code> but no <code>rel: 'noopener'</code>. This can be a security
risk as the loaded page will have control over the previous page
and could change its location for phishing purposes.</p>
</div>
<div class="paragraph">
<p>The option <code>rel: 'noreferrer'</code> also blocks this behavior
and removes the http-referrer header.</p>
</div>
<div class="sect2">
<h3 id="examples-railslinktoblank"><a class="anchor" href="#examples-railslinktoblank"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
link_to 'Click here', url, target: '_blank'

# good
link_to 'Click here', url, target: '_blank', rel: 'noopener'

# good
link_to 'Click here', url, target: '_blank', rel: 'noreferrer'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railslinktoblank"><a class="anchor" href="#references-railslinktoblank"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://mathiasbynens.github.io/rel-noopener/" class="bare">https://mathiasbynens.github.io/rel-noopener/</a></p>
</li>
<li>
<p><a href="https://html.spec.whatwg.org/multipage/links.html#link-type-noopener" class="bare">https://html.spec.whatwg.org/multipage/links.html#link-type-noopener</a></p>
</li>
<li>
<p><a href="https://html.spec.whatwg.org/multipage/links.html#link-type-noreferrer" class="bare">https://html.spec.whatwg.org/multipage/links.html#link-type-noreferrer</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsmailername"><a class="anchor" href="#railsmailername"></a>Rails/MailerName</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces that mailer names end with <code>Mailer</code> suffix.</p>
</div>
<div class="paragraph">
<p>Without the <code>Mailer</code> suffix it isn&#8217;t immediately apparent what&#8217;s a mailer
and which views are related to the mailer.</p>
</div>
<div class="sect2">
<h3 id="safety-railsmailername"><a class="anchor" href="#safety-railsmailername"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because renaming a constant is
always an unsafe operation.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsmailername"><a class="anchor" href="#examples-railsmailername"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class User &lt; ActionMailer::Base
end

class User &lt; ApplicationMailer
end

# good
class UserMailer &lt; ActionMailer::Base
end

class UserMailer &lt; ApplicationMailer
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsmailername"><a class="anchor" href="#configurable-attributes-railsmailername"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/mailers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsmailername"><a class="anchor" href="#references-railsmailername"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#mailer-name" class="bare">https://rails.rubystyle.guide/#mailer-name</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsmatchroute"><a class="anchor" href="#railsmatchroute"></a>Rails/MatchRoute</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where defining routes with <code>match</code>
can be replaced with a specific HTTP method.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t use <code>match</code> to define any routes unless there is a need to map multiple request types
among [:get, :post, :patch, :put, :delete] to a single action using the <code>:via</code> option.</p>
</div>
<div class="sect2">
<h3 id="examples-railsmatchroute"><a class="anchor" href="#examples-railsmatchroute"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
match ':controller/:action/:id'
match 'photos/:id', to: 'photos#show', via: :get

# good
get ':controller/:action/:id'
get 'photos/:id', to: 'photos#show'
match 'photos/:id', to: 'photos#show', via: [:get, :post]
match 'photos/:id', to: 'photos#show', via: :all</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsmatchroute"><a class="anchor" href="#configurable-attributes-railsmatchroute"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config/routes.rb</code>, <code>config/routes/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsmatchroute"><a class="anchor" href="#references-railsmatchroute"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#no-match-routes" class="bare">https://rails.rubystyle.guide/#no-match-routes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsmigrationclassname"><a class="anchor" href="#railsmigrationclassname"></a>Rails/MigrationClassName</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Makes sure that each migration file defines a migration class
whose name matches the file name.
(e.g. <code>20220224111111_create_users.rb</code> should define <code>CreateUsers</code> class.)</p>
</div>
<div class="sect2">
<h3 id="examples-railsmigrationclassname"><a class="anchor" href="#examples-railsmigrationclassname"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># db/migrate/20220224111111_create_users.rb

# bad
class SellBooks &lt; ActiveRecord::Migration[7.0]
end

# good
class CreateUsers &lt; ActiveRecord::Migration[7.0]
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsmigrationclassname"><a class="anchor" href="#configurable-attributes-railsmigrationclassname"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsmultipleroutepaths"><a class="anchor" href="#railsmultipleroutepaths"></a>Rails/MultipleRoutePaths</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for mapping a route with multiple paths, which is deprecated and will be removed in Rails 8.1.</p>
</div>
<div class="sect2">
<h3 id="examples-railsmultipleroutepaths"><a class="anchor" href="#examples-railsmultipleroutepaths"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
get '/users', '/other_path', to: 'users#index'

# good
get '/users', to: 'users#index'
get '/other_path', to: 'users#index'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsmultipleroutepaths"><a class="anchor" href="#configurable-attributes-railsmultipleroutepaths"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config/routes.rb</code>, <code>config/routes/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsnegateinclude"><a class="anchor" href="#railsnegateinclude"></a>Rails/NegateInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of <code>collection.exclude?(obj)</code>
over <code>!collection.include?(obj)</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railsnegateinclude"><a class="anchor" href="#safety-railsnegateinclude"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because false positive will occur for
receiver objects that do not have an <code>exclude?</code> method. (e.g. <code>IPAddr</code>)</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsnegateinclude"><a class="anchor" href="#examples-railsnegateinclude"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
!array.include?(2)
!hash.include?(:key)

# good
array.exclude?(2)
hash.exclude?(:key)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsnegateinclude"><a class="anchor" href="#references-railsnegateinclude"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#exclude" class="bare">https://rails.rubystyle.guide#exclude</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsnotnullcolumn"><a class="anchor" href="#railsnotnullcolumn"></a>Rails/NotNullColumn</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.43</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.20</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for add_column calls with a NOT NULL constraint without a default
value.</p>
</div>
<div class="paragraph">
<p>This cop only applies when adding a column to an existing table, since
existing records will not have a value for the new column. New tables
can freely use NOT NULL columns without defaults, since there are no
records that could violate the constraint.</p>
</div>
<div class="paragraph">
<p>If you need to add a NOT NULL column to an existing table, you must add
it as nullable first, back-fill the data, and then use
<code>change_column_null</code>. Alternatively, you could add the column with a
default first to have the database automatically backfill existing rows,
and then use <code>change_column_default</code> to remove the default.</p>
</div>
<div class="paragraph">
<p><code>TEXT</code> cannot have a default value in MySQL.
The cop will automatically detect an adapter from <code>development</code>
environment in <code>config/database.yml</code> or the environment variable
<code>DATABASE_URL</code> when the <code>Database</code> option is not set. If the database
is MySQL, this cop ignores offenses for <code>TEXT</code> columns.</p>
</div>
<div class="sect2">
<h3 id="examples-railsnotnullcolumn"><a class="anchor" href="#examples-railsnotnullcolumn"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
add_column :users, :name, :string, null: false
add_reference :products, :category, null: false
change_table :users do |t|
  t.string :name, null: false
end

# good
add_column :users, :name, :string, null: true
add_column :users, :name, :string, null: false, default: ''
change_table :users do |t|
  t.string :name, null: false, default: ''
end
add_reference :products, :category
change_column_null :products, :category_id, false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsnotnullcolumn"><a class="anchor" href="#configurable-attributes-railsnotnullcolumn"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Database</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;none&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>mysql</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsorderbyid"><a class="anchor" href="#railsorderbyid"></a>Rails/OrderById</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for places where ordering by <code>id</code> column is used.</p>
</div>
<div class="paragraph">
<p>Don&#8217;t use the <code>id</code> column for ordering. The sequence of ids is not guaranteed
to be in any particular order, despite often (incidentally) being chronological.
Use a timestamp column to order chronologically. As a bonus the intent is clearer.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure the changed order column does not introduce performance
bottlenecks and appropriate database indexes are added.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railsorderbyid"><a class="anchor" href="#examples-railsorderbyid"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
scope :chronological, -&gt; { order(id: :asc) }
scope :chronological, -&gt; { order(primary_key =&gt; :asc) }

# good
scope :chronological, -&gt; { order(created_at: :asc) }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsorderbyid"><a class="anchor" href="#references-railsorderbyid"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#order-by-id" class="bare">https://rails.rubystyle.guide/#order-by-id</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsoutput"><a class="anchor" href="#railsoutput"></a>Rails/Output</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.19</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of output calls like puts and print</p>
</div>
<div class="sect2">
<h3 id="safety-railsoutput"><a class="anchor" href="#safety-railsoutput"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because depending on the Rails log level configuration,
changing from <code>puts</code> to <code>Rails.logger.debug</code> could result in no output being shown.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsoutput"><a class="anchor" href="#examples-railsoutput"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
puts 'A debug message'
pp 'A debug message'
print 'A debug message'

# good
Rails.logger.debug 'A debug message'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsoutput"><a class="anchor" href="#configurable-attributes-railsoutput"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/**/*.rb</code>, <code>config/**/*.rb</code>, <code>db/**/*.rb</code>, <code>lib/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsoutputsafety"><a class="anchor" href="#railsoutputsafety"></a>Rails/OutputSafety</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.41</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of output safety calls like <code>html_safe</code>,
<code>raw</code>, and <code>safe_concat</code>. These methods do not escape content. They
simply return a SafeBuffer containing the content as is. Instead,
use <code>safe_join</code> to join content and escape it and concat to
concatenate content and escape it, ensuring its safety.</p>
</div>
<div class="sect2">
<h3 id="examples-railsoutputsafety"><a class="anchor" href="#examples-railsoutputsafety"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">user_content = "&lt;b&gt;hi&lt;/b&gt;"

# bad
"&lt;p&gt;#{user_content}&lt;/p&gt;".html_safe
# =&gt; ActiveSupport::SafeBuffer "&lt;p&gt;&lt;b&gt;hi&lt;/b&gt;&lt;/p&gt;"

# good
content_tag(:p, user_content)
# =&gt; ActiveSupport::SafeBuffer "&lt;p&gt;&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt;&lt;/p&gt;"

# bad
out = ""
out &lt;&lt; "&lt;li&gt;#{user_content}&lt;/li&gt;"
out &lt;&lt; "&lt;li&gt;#{user_content}&lt;/li&gt;"
out.html_safe
# =&gt; ActiveSupport::SafeBuffer "&lt;li&gt;&lt;b&gt;hi&lt;/b&gt;&lt;/li&gt;&lt;li&gt;&lt;b&gt;hi&lt;/b&gt;&lt;/li&gt;"

# good
out = []
out &lt;&lt; content_tag(:li, user_content)
out &lt;&lt; content_tag(:li, user_content)
safe_join(out)
# =&gt; ActiveSupport::SafeBuffer
#    "&lt;li&gt;&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt;&lt;/li&gt;&lt;li&gt;&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt;&lt;/li&gt;"

# bad
out = "&lt;h1&gt;trusted content&lt;/h1&gt;".html_safe
out.safe_concat(user_content)
# =&gt; ActiveSupport::SafeBuffer "&lt;h1&gt;trusted_content&lt;/h1&gt;&lt;b&gt;hi&lt;/b&gt;"

# good
out = "&lt;h1&gt;trusted content&lt;/h1&gt;".html_safe
out.concat(user_content)
# =&gt; ActiveSupport::SafeBuffer
#    "&lt;h1&gt;trusted_content&lt;/h1&gt;&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt;"

# safe, though maybe not good style
out = "trusted content"
result = out.concat(user_content)
# =&gt; String "trusted content&lt;b&gt;hi&lt;/b&gt;"
# because when rendered in ERB the String will be escaped:
# &lt;%= result %&gt;
# =&gt; trusted content&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt;

# bad
(user_content + " " + content_tag(:span, user_content)).html_safe
# =&gt; ActiveSupport::SafeBuffer "&lt;b&gt;hi&lt;/b&gt; &lt;span&gt;&lt;b&gt;hi&lt;/b&gt;&lt;/span&gt;"

# good
safe_join([user_content, " ", content_tag(:span, user_content)])
# =&gt; ActiveSupport::SafeBuffer
#    "&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt; &lt;span&gt;&amp;lt;b&amp;gt;hi&amp;lt;/b&amp;gt;&lt;/span&gt;"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspick"><a class="anchor" href="#railspick"></a>Rails/Pick</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 6.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of <code>pick</code> over <code>pluck(&#8230;&#8203;).first</code>.</p>
</div>
<div class="paragraph">
<p>Using <code>pluck</code> followed by <code>first</code> creates an intermediate array, which
<code>pick</code> avoids. When called on an Active Record relation, <code>pick</code> adds a
limit to the query so that only one value is fetched from the database.</p>
</div>
<div class="paragraph">
<p>Note that when <code>pick</code> is added to a relation with an existing limit, it
causes a subquery to be added. In most cases this is undesirable, and
care should be taken while resolving this violation.</p>
</div>
<div class="sect2">
<h3 id="safety-railspick"><a class="anchor" href="#safety-railspick"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>pluck</code> is defined on both <code>ActiveRecord::Relation</code> and <code>Enumerable</code>,
whereas <code>pick</code> is only defined on <code>ActiveRecord::Relation</code> in Rails 6.0. This was addressed
in Rails 6.1 via rails/rails#38760, at which point the cop is safe.</p>
</div>
<div class="paragraph">
<p>See: <a href="https://github.com/rubocop/rubocop-rails/pull/249" class="bare">https://github.com/rubocop/rubocop-rails/pull/249</a></p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railspick"><a class="anchor" href="#examples-railspick"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Model.pluck(:a).first
[{ a: :b, c: :d }].pluck(:a, :b).first

# good
Model.pick(:a)
[{ a: :b, c: :d }].pick(:a, :b)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railspick"><a class="anchor" href="#references-railspick"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#pick" class="bare">https://rails.rubystyle.guide#pick</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspluck"><a class="anchor" href="#railspluck"></a>Rails/Pluck</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of <code>pluck</code> over <code>map</code>.</p>
</div>
<div class="paragraph">
<p><code>pluck</code> can be used instead of <code>map</code> to extract a single key from each
element in an enumerable. When called on an Active Record relation, it
results in a more efficient query that only selects the necessary key.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the receiver&#8217;s relation is not loaded and <code>pluck</code> is used inside an iteration,
it may result in N+1 queries because <code>pluck</code> queries the database on each iteration.
This cop ignores offenses for <code>map/collect</code> when they are suspected to be part of an iteration
to prevent such potential issues.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">users = User.all
5.times do
  users.map { |user| user[:foo] } # Only one query is executed
end

users = User.all
5.times do
  users.pluck(:id) # A query is executed on every iteration
end</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-railspluck"><a class="anchor" href="#safety-railspluck"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because model can use column aliases.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Original code
User.select('name AS nickname').map { |user| user[:nickname] } # =&gt; array of nicknames

# After autocorrection
User.select('name AS nickname').pluck(:nickname) # =&gt; raises ActiveRecord::StatementInvalid</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-railspluck"><a class="anchor" href="#examples-railspluck"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Post.published.map { |post| post[:title] }
[{ a: :b, c: :d }].collect { |el| el[:a] }

# good
Post.published.pluck(:title)
[{ a: :b, c: :d }].pluck(:a)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railspluck"><a class="anchor" href="#references-railspluck"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#pluck" class="bare">https://rails.rubystyle.guide#pluck</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspluckid"><a class="anchor" href="#railspluckid"></a>Rails/PluckId</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of <code>ids</code> over <code>pluck(:id)</code> and <code>pluck(primary_key)</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railspluckid"><a class="anchor" href="#safety-railspluckid"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe if the receiver object is not an Active Record object.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railspluckid"><a class="anchor" href="#examples-railspluckid"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.pluck(:id)
user.posts.pluck(:id)

def self.user_ids
  pluck(primary_key)
end

# good
User.ids
user.posts.ids

def self.user_ids
  ids
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railspluckid"><a class="anchor" href="#references-railspluckid"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#ids" class="bare">https://rails.rubystyle.guide/#ids</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspluckinwhere"><a class="anchor" href="#railspluckinwhere"></a>Rails/PluckInWhere</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>pluck</code> is used in <code>where</code> query methods
and can be replaced with <code>select</code>.</p>
</div>
<div class="paragraph">
<p>Since <code>pluck</code> is an eager method and hits the database immediately,
using <code>select</code> helps to avoid additional database queries by running as
a subquery.</p>
</div>
<div class="paragraph">
<p>This cop has two modes of enforcement. When the <code>EnforcedStyle</code> is set
to <code>conservative</code> (the default), only calls to <code>pluck</code> on a constant
(e.g. a model class) within <code>where</code> are considered offenses.</p>
</div>
<div class="sect2">
<h3 id="safety-railspluckinwhere"><a class="anchor" href="#safety-railspluckinwhere"></a>Safety</h3>
<div class="paragraph">
<p>When <code>EnforcedStyle</code> is set to <code>aggressive</code>, all calls to <code>pluck</code>
within <code>where</code> are considered offenses. This might lead to false
positives because the check cannot distinguish between calls to
<code>pluck</code> on an <code>ActiveRecord::Relation</code> instance and calls to <code>pluck</code>
on an <code>Array</code> instance.</p>
</div>
<div class="paragraph">
<p>Additionally, when using a subquery with the SQL <code>IN</code> operator,
databases like PostgreSQL and MySQL can&#8217;t optimize complex queries as
well. They need to scan all records of the outer table against the
subquery result sequentially, rather than using an index. This can
cause significant performance issues compared to writing the query
differently or using <code>pluck</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railspluckinwhere"><a class="anchor" href="#examples-railspluckinwhere"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Post.where(user_id: User.active.pluck(:id))
Post.where(user_id: User.active.ids)
Post.where.not(user_id: User.active.pluck(:id))

# good
Post.where(user_id: User.active.select(:id))
Post.where(user_id: active_users.select(:id))
Post.where.not(user_id: active_users.select(:id))</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-conservative-_default_-railspluckinwhere"><a class="anchor" href="#enforcedstyle_-conservative-_default_-railspluckinwhere"></a>EnforcedStyle: conservative (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
Post.where(user_id: active_users.pluck(:id))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-aggressive-railspluckinwhere"><a class="anchor" href="#enforcedstyle_-aggressive-railspluckinwhere"></a>EnforcedStyle: aggressive</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Post.where(user_id: active_users.pluck(:id))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railspluckinwhere"><a class="anchor" href="#configurable-attributes-railspluckinwhere"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conservative</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conservative</code>, <code>aggressive</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspluralizationgrammar"><a class="anchor" href="#railspluralizationgrammar"></a>Rails/PluralizationGrammar</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.35</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for correct grammar when using ActiveSupport&#8217;s
core extensions to the numeric classes.</p>
</div>
<div class="sect2">
<h3 id="examples-railspluralizationgrammar"><a class="anchor" href="#examples-railspluralizationgrammar"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
3.day.ago
1.months.ago
5.megabyte
1.gigabytes

# good
3.days.ago
1.month.ago
5.megabytes
1.gigabyte</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspresence"><a class="anchor" href="#railspresence"></a>Rails/Presence</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks code that can be written more easily using
<code>Object#presence</code> defined by Active Support.</p>
</div>
<div class="sect2">
<h3 id="examples-railspresence"><a class="anchor" href="#examples-railspresence"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
a.present? ? a : nil

# bad
!a.present? ? nil : a

# bad
a.blank? ? nil : a

# bad
!a.blank? ? a : nil

# good
a.presence</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
a.present? ? a : b

# bad
!a.present? ? b : a

# bad
a.blank? ? b : a

# bad
!a.blank? ? a : b

# good
a.presence || b</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railspresent"><a class="anchor" href="#railspresent"></a>Rails/Present</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.67</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for code that can be written with simpler conditionals
using <code>Object#present?</code> defined by Active Support.</p>
</div>
<div class="paragraph">
<p>Interaction with <code>Style/UnlessElse</code>:
The configuration of <code>NotBlank</code> will not produce an offense in the
context of <code>unless else</code> if <code>Style/UnlessElse</code> is enabled. This is
to prevent interference between the autocorrection of the two cops.</p>
</div>
<div class="sect2">
<h3 id="examples-railspresent"><a class="anchor" href="#examples-railspresent"></a>Examples</h3>
<div class="sect3">
<h4 id="notnilandnotempty_-true-_default_-railspresent"><a class="anchor" href="#notnilandnotempty_-true-_default_-railspresent"></a>NotNilAndNotEmpty: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Converts usages of `!nil? &amp;&amp; !empty?` to `present?`

# bad
!foo.nil? &amp;&amp; !foo.empty?

# bad
foo != nil &amp;&amp; !foo.empty?

# good
foo.present?</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="notblank_-true-_default_-railspresent"><a class="anchor" href="#notblank_-true-_default_-railspresent"></a>NotBlank: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Converts usages of `!blank?` to `present?`

# bad
!foo.blank?

# bad
not foo.blank?

# good
foo.present?</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unlessblank_-true-_default_-railspresent"><a class="anchor" href="#unlessblank_-true-_default_-railspresent"></a>UnlessBlank: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Converts usages of `unless blank?` to `if present?`

# bad
something unless foo.blank?

# good
something if foo.present?</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railspresent"><a class="anchor" href="#configurable-attributes-railspresent"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotNilAndNotEmpty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NotBlank</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UnlessBlank</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrakeenvironment"><a class="anchor" href="#railsrakeenvironment"></a>Rails/RakeEnvironment</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for Rake tasks without the <code>:environment</code> task
dependency. The <code>:environment</code> task loads application code for other
Rake tasks. Without it, tasks cannot make use of application code like
models.</p>
</div>
<div class="paragraph">
<p>You can ignore the offense if the task satisfies at least one of the
following conditions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The task does not need application code.</p>
</li>
<li>
<p>The task invokes the <code>:environment</code> task.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="safety-railsrakeenvironment"><a class="anchor" href="#safety-railsrakeenvironment"></a>Safety</h3>
<div class="paragraph">
<p>Probably not a problem in most cases, but it is possible that calling <code>:environment</code> task
will break a behavior. It&#8217;s also slower. E.g. some task that only needs one gem to be
loaded to run will run significantly faster without loading the whole application.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsrakeenvironment"><a class="anchor" href="#examples-railsrakeenvironment"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
task :foo do
  do_something
end

# good
task foo: :environment do
  do_something
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsrakeenvironment"><a class="anchor" href="#configurable-attributes-railsrakeenvironment"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>**/Rakefile</code>, <code>**/*.rake</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>lib/capistrano/tasks/**/*.rake</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsreadwriteattribute"><a class="anchor" href="#railsreadwriteattribute"></a>Rails/ReadWriteAttribute</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.29</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of the <code>read_attribute</code> or <code>write_attribute</code>
methods and recommends square brackets instead.</p>
</div>
<div class="paragraph">
<p>If an attribute is missing from the instance (for example, when
initialized by a partial <code>select</code>) then <code>read_attribute</code>
will return nil, but square brackets will raise
an <code>ActiveModel::MissingAttributeError</code>.</p>
</div>
<div class="paragraph">
<p>Explicitly raising an error in this situation is preferable, and that
is why rubocop recommends using square brackets.</p>
</div>
<div class="paragraph">
<p>When called from within a method with the same name as the attribute,
<code>read_attribute</code> and <code>write_attribute</code> must be used to prevent an
infinite loop:</p>
</div>
<div class="sect2">
<h3 id="examples-railsreadwriteattribute"><a class="anchor" href="#examples-railsreadwriteattribute"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
x = read_attribute(:attr)
write_attribute(:attr, val)

# good
x = self[:attr]
self[:attr] = val</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
def foo
  bar || read_attribute(:foo)
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsreadwriteattribute"><a class="anchor" href="#configurable-attributes-railsreadwriteattribute"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsreadwriteattribute"><a class="anchor" href="#references-railsreadwriteattribute"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#read-attribute" class="bare">https://rails.rubystyle.guide#read-attribute</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsredundantactiverecordallmethod"><a class="anchor" href="#railsredundantactiverecordallmethod"></a>Rails/RedundantActiveRecordAllMethod</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Detect redundant <code>all</code> used as a receiver for Active Record query methods.</p>
</div>
<div class="paragraph">
<p>For the methods <code>delete_all</code> and <code>destroy_all</code>, this cop will only check cases where the receiver is a model.
It will ignore cases where the receiver is an association (e.g., <code>user.articles.all.delete_all</code>).
This is because omitting <code>all</code> from an association changes the methods
from <code>ActiveRecord::Relation</code> to <code>ActiveRecord::Associations::CollectionProxy</code>,
which can affect their behavior.</p>
</div>
<div class="sect2">
<h3 id="safety-railsredundantactiverecordallmethod"><a class="anchor" href="#safety-railsredundantactiverecordallmethod"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for autocorrection if the receiver for <code>all</code> is not an Active Record object.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsredundantactiverecordallmethod"><a class="anchor" href="#examples-railsredundantactiverecordallmethod"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.all.find(id)
User.all.order(:created_at)
users.all.where(id: ids)
user.articles.all.order(:created_at)

# good
User.find(id)
User.order(:created_at)
users.where(id: ids)
user.articles.order(:created_at)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowedreceivers_-__actionmailer__preview__-_activesupport__timezone__-_default_-railsredundantactiverecordallmethod"><a class="anchor" href="#allowedreceivers_-__actionmailer__preview__-_activesupport__timezone__-_default_-railsredundantactiverecordallmethod"></a>AllowedReceivers: ['ActionMailer::Preview', 'ActiveSupport::TimeZone'] (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
ActionMailer::Preview.all.first
ActiveSupport::TimeZone.all.first</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsredundantactiverecordallmethod"><a class="anchor" href="#configurable-attributes-railsredundantactiverecordallmethod"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedReceivers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ActionMailer::Preview</code>, <code>ActiveSupport::TimeZone</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsredundantactiverecordallmethod"><a class="anchor" href="#references-railsredundantactiverecordallmethod"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#redundant-all" class="bare">https://rails.rubystyle.guide/#redundant-all</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsredundantallownil"><a class="anchor" href="#railsredundantallownil"></a>Rails/RedundantAllowNil</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks Rails model validations for a redundant <code>allow_nil</code> when
<code>allow_blank</code> is present.</p>
</div>
<div class="sect2">
<h3 id="examples-railsredundantallownil"><a class="anchor" href="#examples-railsredundantallownil"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
validates :x, length: { is: 5 }, allow_nil: true, allow_blank: true

# bad
validates :x, length: { is: 5 }, allow_nil: false, allow_blank: true

# bad
validates :x, length: { is: 5 }, allow_nil: false, allow_blank: false

# good
validates :x, length: { is: 5 }, allow_blank: true

# good
validates :x, length: { is: 5 }, allow_blank: false

# good
# Here, `nil` is valid but `''` is not
validates :x, length: { is: 5 }, allow_nil: true, allow_blank: false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsredundantallownil"><a class="anchor" href="#configurable-attributes-railsredundantallownil"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsredundantforeignkey"><a class="anchor" href="#railsredundantforeignkey"></a>Rails/RedundantForeignKey</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Detects cases where the <code>:foreign_key</code> option on associations
is redundant.</p>
</div>
<div class="sect2">
<h3 id="examples-railsredundantforeignkey"><a class="anchor" href="#examples-railsredundantforeignkey"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Post
  has_many :comments, foreign_key: 'post_id'
end

class Comment
  belongs_to :post, foreign_key: 'post_id'
end

# good
class Post
  has_many :comments
end

class Comment
  belongs_to :author, foreign_key: 'user_id'
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsredundantpresencevalidationonbelongsto"><a class="anchor" href="#railsredundantpresencevalidationonbelongsto"></a>Rails/RedundantPresenceValidationOnBelongsTo</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Since Rails 5.0 the default for <code>belongs_to</code> is <code>optional: false</code>
unless <code>config.active_record.belongs_to_required_by_default</code> is
explicitly set to <code>false</code>. The presence validator is added
automatically, and explicit presence validation is redundant.</p>
</div>
<div class="sect2">
<h3 id="safety-railsredundantpresencevalidationonbelongsto"><a class="anchor" href="#safety-railsredundantpresencevalidationonbelongsto"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it changes the default error message
from "can&#8217;t be blank" to "must exist".</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsredundantpresencevalidationonbelongsto"><a class="anchor" href="#examples-railsredundantpresencevalidationonbelongsto"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
belongs_to :user
validates :user, presence: true

# bad
belongs_to :user
validates :user_id, presence: true

# bad
belongs_to :author, foreign_key: :user_id
validates :user_id, presence: true

# good
belongs_to :user

# good
belongs_to :author, foreign_key: :user_id</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsredundantreceiverinwithoptions"><a class="anchor" href="#railsredundantreceiverinwithoptions"></a>Rails/RedundantReceiverInWithOptions</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for redundant receiver in <code>with_options</code>.
Receiver is implicit from Rails 4.2 or higher.</p>
</div>
<div class="sect2">
<h3 id="examples-railsredundantreceiverinwithoptions"><a class="anchor" href="#examples-railsredundantreceiverinwithoptions"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class Account &lt; ApplicationRecord
  with_options dependent: :destroy do |assoc|
    assoc.has_many :customers
    assoc.has_many :products
    assoc.has_many :invoices
    assoc.has_many :expenses
  end
end

# good
class Account &lt; ApplicationRecord
  with_options dependent: :destroy do
    has_many :customers
    has_many :products
    has_many :invoices
    has_many :expenses
  end
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
with_options options: false do |merger|
  merger.invoke(merger.something)
end

# good
with_options options: false do
  invoke(something)
end

# good
client = Client.new
with_options options: false do |merger|
  client.invoke(merger.something, something)
end

# ok
# When `with_options` includes a block, all scoping scenarios
# cannot be evaluated. Thus, it is ok to include the explicit
# receiver.
with_options options: false do |merger|
  merger.invoke
  with_another_method do |another_receiver|
    merger.invoke(another_receiver)
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsredundanttravelback"><a class="anchor" href="#railsredundanttravelback"></a>Rails/RedundantTravelBack</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.2
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for redundant <code>travel_back</code> calls.
Since Rails 5.2, <code>travel_back</code> is automatically called at the end of the test.</p>
</div>
<div class="sect2">
<h3 id="examples-railsredundanttravelback"><a class="anchor" href="#examples-railsredundanttravelback"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def teardown
  do_something
  travel_back
end

# good
def teardown
  do_something
end

# bad
after do
  do_something
  travel_back
end

# good
after do
  do_something
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsredundanttravelback"><a class="anchor" href="#configurable-attributes-railsredundanttravelback"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spec/**/*.rb</code>, <code>test/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsreflectionclassname"><a class="anchor" href="#railsreflectionclassname"></a>Rails/ReflectionClassName</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks if the value of the option <code>class_name</code>, in
the definition of a reflection is a string.</p>
</div>
<div class="sect2">
<h3 id="safety-railsreflectionclassname"><a class="anchor" href="#safety-railsreflectionclassname"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it cannot be determined whether
constant or method return value specified to <code>class_name</code> is a string.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsreflectionclassname"><a class="anchor" href="#examples-railsreflectionclassname"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
has_many :accounts, class_name: Account
has_many :accounts, class_name: Account.name

# good
has_many :accounts, class_name: 'Account'</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrefutemethods"><a class="anchor" href="#railsrefutemethods"></a>Rails/RefuteMethods</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use <code>assert_not</code> methods instead of <code>refute</code> methods.</p>
</div>
<div class="sect2">
<h3 id="examples-railsrefutemethods"><a class="anchor" href="#examples-railsrefutemethods"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-assert_not-_default_-railsrefutemethods"><a class="anchor" href="#enforcedstyle_-assert_not-_default_-railsrefutemethods"></a>EnforcedStyle: assert_not (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
refute false
refute_empty [1, 2, 3]
refute_equal true, false

# good
assert_not false
assert_not_empty [1, 2, 3]
assert_not_equal true, false</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-refute-railsrefutemethods"><a class="anchor" href="#enforcedstyle_-refute-railsrefutemethods"></a>EnforcedStyle: refute</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
assert_not false
assert_not_empty [1, 2, 3]
assert_not_equal true, false

# good
refute false
refute_empty [1, 2, 3]
refute_equal true, false</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsrefutemethods"><a class="anchor" href="#configurable-attributes-railsrefutemethods"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assert_not</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>assert_not</code>, <code>refute</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>**/test/**/*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrelativedateconstant"><a class="anchor" href="#railsrelativedateconstant"></a>Rails/RelativeDateConstant</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks whether constant value isn&#8217;t relative date.
Because the relative date will be evaluated only once.</p>
</div>
<div class="sect2">
<h3 id="safety-railsrelativedateconstant"><a class="anchor" href="#safety-railsrelativedateconstant"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because its dependence on the constant is not corrected.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsrelativedateconstant"><a class="anchor" href="#examples-railsrelativedateconstant"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class SomeClass
  EXPIRED_AT = 1.week.since
end

# good
class SomeClass
  EXPIRES = 1.week

  def self.expired_at
    EXPIRES.since
  end
end

# good
class SomeClass
  def self.expired_at
    1.week.since
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrenderinline"><a class="anchor" href="#railsrenderinline"></a>Rails/RenderInline</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Looks for inline rendering within controller actions.</p>
</div>
<div class="sect2">
<h3 id="examples-railsrenderinline"><a class="anchor" href="#examples-railsrenderinline"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class ProductsController &lt; ApplicationController
  def index
    render inline: "&lt;% products.each do |p| %&gt;&lt;p&gt;&lt;%= p.name %&gt;&lt;/p&gt;&lt;% end %&gt;", type: :erb
  end
end

# good
# app/views/products/index.html.erb
# &lt;% products.each do |p| %&gt;
#   &lt;p&gt;&lt;%= p.name %&gt;&lt;/p&gt;
# &lt;% end %&gt;

class ProductsController &lt; ApplicationController
  def index
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsrenderinline"><a class="anchor" href="#references-railsrenderinline"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#inline-rendering" class="bare">https://rails.rubystyle.guide/#inline-rendering</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrenderplaintext"><a class="anchor" href="#railsrenderplaintext"></a>Rails/RenderPlainText</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>render text:</code> can be
replaced with <code>render plain:</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railsrenderplaintext"><a class="anchor" href="#examples-railsrenderplaintext"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad - explicit MIME type to `text/plain`
render text: 'Ruby!', content_type: 'text/plain'

# good - short and precise
render plain: 'Ruby!'

# good - explicit MIME type not to `text/plain`
render text: 'Ruby!', content_type: 'text/html'</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="contenttypecompatibility_-true-_default_-railsrenderplaintext"><a class="anchor" href="#contenttypecompatibility_-true-_default_-railsrenderplaintext"></a>ContentTypeCompatibility: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good - sets MIME type to `text/html`
render text: 'Ruby!'</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="contenttypecompatibility_-false-railsrenderplaintext"><a class="anchor" href="#contenttypecompatibility_-false-railsrenderplaintext"></a>ContentTypeCompatibility: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad - sets MIME type to `text/html`
render text: 'Ruby!'</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsrenderplaintext"><a class="anchor" href="#configurable-attributes-railsrenderplaintext"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ContentTypeCompatibility</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsrenderplaintext"><a class="anchor" href="#references-railsrenderplaintext"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#plain-text-rendering" class="bare">https://rails.rubystyle.guide/#plain-text-rendering</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrequestreferer"><a class="anchor" href="#railsrequestreferer"></a>Rails/RequestReferer</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.41</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for consistent uses of <code>request.referer</code> or
<code>request.referrer</code>, depending on the cop&#8217;s configuration.</p>
</div>
<div class="sect2">
<h3 id="examples-railsrequestreferer"><a class="anchor" href="#examples-railsrequestreferer"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-referer-_default_-railsrequestreferer"><a class="anchor" href="#enforcedstyle_-referer-_default_-railsrequestreferer"></a>EnforcedStyle: referer (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
request.referrer

# good
request.referer</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-referrer-railsrequestreferer"><a class="anchor" href="#enforcedstyle_-referrer-railsrequestreferer"></a>EnforcedStyle: referrer</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
request.referer

# good
request.referrer</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsrequestreferer"><a class="anchor" href="#configurable-attributes-railsrequestreferer"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>referer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>referer</code>, <code>referrer</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrequiredependency"><a class="anchor" href="#railsrequiredependency"></a>Rails/RequireDependency</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 6.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the usage of <code>require_dependency</code>.</p>
</div>
<div class="paragraph">
<p><code>require_dependency</code> is an obsolete method for Rails applications running in Zeitwerk mode.
In Zeitwerk mode, the semantics should match Ruby&#8217;s and no need to be defensive with load order,
just refer to classes and modules normally.
If the constant name is dynamic, camelize if needed, and constantize.</p>
</div>
<div class="paragraph">
<p>Applications running in Zeitwerk mode should not use <code>require_dependency</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This cop is disabled by default. Please enable it if you are using Zeitwerk mode.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railsrequiredependency"><a class="anchor" href="#examples-railsrequiredependency"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
require_dependency 'some_lib'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsrequiredependency"><a class="anchor" href="#references-railsrequiredependency"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://guides.rubyonrails.org/autoloading_and_reloading_constants.html" class="bare">https://guides.rubyonrails.org/autoloading_and_reloading_constants.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsresponseparsedbody"><a class="anchor" href="#railsresponseparsedbody"></a>Rails/ResponseParsedBody</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.19</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Prefer <code>response.parsed_body</code> to custom parsing logic for <code>response.body</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railsresponseparsedbody"><a class="anchor" href="#safety-railsresponseparsedbody"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because Content-Type may not be <code>application/json</code> or <code>text/html</code>.
For example, the proprietary Content-Type provided by corporate entities such as
<code>application/vnd.github+json</code> is not supported at <code>response.parsed_body</code> by default,
so you still have to use <code>JSON.parse(response.body)</code> there.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsresponseparsedbody"><a class="anchor" href="#examples-railsresponseparsedbody"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
JSON.parse(response.body)

# bad
Nokogiri::HTML.parse(response.body)

# bad
Nokogiri::HTML5.parse(response.body)

# good
response.parsed_body</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsresponseparsedbody"><a class="anchor" href="#configurable-attributes-railsresponseparsedbody"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spec/controllers/**/*.rb</code>, <code>spec/requests/**/*.rb</code>, <code>test/controllers/**/*.rb</code>, <code>test/integration/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsreversiblemigration"><a class="anchor" href="#railsreversiblemigration"></a>Rails/ReversibleMigration</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks whether the change method of the migration file is
reversible.</p>
</div>
<div class="sect2">
<h3 id="examples-railsreversiblemigration"><a class="anchor" href="#examples-railsreversiblemigration"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def change
  change_table :users do |t|
    t.remove :name
  end
end

# good
def change
  change_table :users do |t|
    t.remove :name, type: :string
  end
end

# good
def change
  create_table :users do |t|
    t.string :name
  end
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># drop_table

# bad
def change
  drop_table :users
end

# good
def change
  drop_table :users do |t|
    t.string :name
  end
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># change_column_default

# bad
def change
  change_column_default(:suppliers, :qualification, 'new')
end

# good
def change
  change_column_default(:posts, :state, from: nil, to: "draft")
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># remove_column

# bad
def change
  remove_column(:suppliers, :qualification)
end

# good
def change
  remove_column(:suppliers, :qualification, :string)
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># remove_foreign_key

# bad
def change
  remove_foreign_key :accounts, column: :owner_id
end

# good
def change
  remove_foreign_key :accounts, :branches
end

# good
def change
  remove_foreign_key :accounts, to_table: :branches
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># change_table

# bad
def change
  change_table :users do |t|
    t.remove :name
    t.change_default :authorized, 1
    t.change :price, :string
  end
end

# good
def change
  change_table :users do |t|
    t.string :name
  end
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># remove_columns

# bad
def change
  remove_columns :users, :name, :email
end

# good
def change
  reversible do |dir|
    dir.up do
      remove_columns :users, :name, :email
    end

    dir.down do
      add_column :users, :name, :string
      add_column :users, :email, :string
    end
  end
end

# good (Rails &gt;= 6.1, see https://github.com/rails/rails/pull/36589)
def change
  remove_columns :users, :name, :email, type: :string
end</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># remove_index

# bad
def change
  remove_index :users, name: :index_users_on_email
end

# good
def change
  remove_index :users, :email
end

# good
def change
  remove_index :users, column: :email
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsreversiblemigration"><a class="anchor" href="#configurable-attributes-railsreversiblemigration"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsreversiblemigration"><a class="anchor" href="#references-railsreversiblemigration"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#reversible-migration" class="bare">https://rails.rubystyle.guide#reversible-migration</a></p>
</li>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActiveRecord/Migration/CommandRecorder.html" class="bare">https://api.rubyonrails.org/classes/ActiveRecord/Migration/CommandRecorder.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsreversiblemigrationmethoddefinition"><a class="anchor" href="#railsreversiblemigrationmethoddefinition"></a>Rails/ReversibleMigrationMethodDefinition</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks whether the migration implements
either a <code>change</code> method or both an <code>up</code> and a <code>down</code>
method.</p>
</div>
<div class="sect2">
<h3 id="examples-railsreversiblemigrationmethoddefinition"><a class="anchor" href="#examples-railsreversiblemigrationmethoddefinition"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class SomeMigration &lt; ActiveRecord::Migration[6.0]
  def up
    # up migration
  end

  # &lt;----- missing down method
end

class SomeMigration &lt; ActiveRecord::Migration[6.0]
  # &lt;----- missing up method

  def down
    # down migration
  end
end

# good
class SomeMigration &lt; ActiveRecord::Migration[6.0]
  def change
    # reversible migration
  end
end

# good
class SomeMigration &lt; ActiveRecord::Migration[6.0]
  def up
    # up migration
  end

  def down
    # down migration
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsreversiblemigrationmethoddefinition"><a class="anchor" href="#configurable-attributes-railsreversiblemigrationmethoddefinition"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrootjoinchain"><a class="anchor" href="#railsrootjoinchain"></a>Rails/RootJoinChain</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use a single <code>#join</code> instead of chaining on <code>Rails.root</code> or <code>Rails.public_path</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railsrootjoinchain"><a class="anchor" href="#examples-railsrootjoinchain"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.root.join('db').join('schema.rb')
Rails.root.join('db').join(migrate).join('migration.rb')
Rails.public_path.join('path').join('file.pdf')
Rails.public_path.join('path').join(to).join('file.pdf')

# good
Rails.root.join('db', 'schema.rb')
Rails.root.join('db', migrate, 'migration.rb')
Rails.public_path.join('path', 'file.pdf')
Rails.public_path.join('path', to, 'file.pdf')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrootpathnamemethods"><a class="anchor" href="#railsrootpathnamemethods"></a>Rails/RootPathnameMethods</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use <code>Rails.root</code> IO methods instead of passing it to <code>File</code>.</p>
</div>
<div class="paragraph">
<p><code>Rails.root</code> is an instance of <code>Pathname</code>
so we can apply many IO methods directly.</p>
</div>
<div class="paragraph">
<p>This cop works best when used together with
<code>Style/FileRead</code>, <code>Style/FileWrite</code> and <code>Rails/RootJoinChain</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railsrootpathnamemethods"><a class="anchor" href="#safety-railsrootpathnamemethods"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for autocorrection because <code>Dir</code>'s <code>children</code>, <code>each_child</code>, <code>entries</code>, and <code>glob</code>
methods return string element, but these methods of <code>Pathname</code> return <code>Pathname</code> element.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsrootpathnamemethods"><a class="anchor" href="#examples-railsrootpathnamemethods"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
File.open(Rails.root.join('db', 'schema.rb'))
File.open(Rails.root.join('db', 'schema.rb'), 'w')
File.read(Rails.root.join('db', 'schema.rb'))
File.binread(Rails.root.join('db', 'schema.rb'))
File.write(Rails.root.join('db', 'schema.rb'), content)
File.binwrite(Rails.root.join('db', 'schema.rb'), content)
Dir.glob(Rails.root.join('db', 'schema.rb'))
Dir[Rails.root.join('db', 'schema.rb')]

# good
Rails.root.join('db', 'schema.rb').open
Rails.root.join('db', 'schema.rb').open('w')
Rails.root.join('db', 'schema.rb').read
Rails.root.join('db', 'schema.rb').binread
Rails.root.join('db', 'schema.rb').write(content)
Rails.root.join('db', 'schema.rb').binwrite(content)
Rails.root.glob("db/schema.rb")</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsrootpublicpath"><a class="anchor" href="#railsrootpublicpath"></a>Rails/RootPublicPath</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Favor <code>Rails.public_path</code> over <code>Rails.root</code> with <code>'public'</code></p>
</div>
<div class="sect2">
<h3 id="examples-railsrootpublicpath"><a class="anchor" href="#examples-railsrootpublicpath"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.root.join('public')
Rails.root.join('public/file.pdf')
Rails.root.join('public', 'file.pdf')

# good
Rails.public_path
Rails.public_path.join('file.pdf')
Rails.public_path.join('file.pdf')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railssafenavigation"><a class="anchor" href="#railssafenavigation"></a>Rails/SafeNavigation</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Requires Ruby version 2.3
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.43</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Converts usages of <code>try!</code> to <code>&amp;.</code>. It can also be configured
to convert <code>try</code>. It will convert code to use safe navigation
if the target Ruby version is set to 2.3+</p>
</div>
<div class="sect2">
<h3 id="examples-railssafenavigation"><a class="anchor" href="#examples-railssafenavigation"></a>Examples</h3>
<div class="sect3">
<h4 id="converttry_-false-_default_-railssafenavigation"><a class="anchor" href="#converttry_-false-_default_-railssafenavigation"></a>ConvertTry: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
foo.try!(:bar)
foo.try!(:bar, baz)
foo.try!(:bar) { |e| e.baz }

foo.try!(:[], 0)

# good
foo.try(:bar)
foo.try(:bar, baz)
foo.try(:bar) { |e| e.baz }

foo&amp;.bar
foo&amp;.bar(baz)
foo&amp;.bar { |e| e.baz }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="converttry_-true-railssafenavigation"><a class="anchor" href="#converttry_-true-railssafenavigation"></a>ConvertTry: true</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
foo.try!(:bar)
foo.try!(:bar, baz)
foo.try!(:bar) { |e| e.baz }
foo.try(:bar)
foo.try(:bar, baz)
foo.try(:bar) { |e| e.baz }

# good
foo&amp;.bar
foo&amp;.bar(baz)
foo&amp;.bar { |e| e.baz }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railssafenavigation"><a class="anchor" href="#configurable-attributes-railssafenavigation"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ConvertTry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railssafenavigationwithblank"><a class="anchor" href="#railssafenavigationwithblank"></a>Rails/SafeNavigationWithBlank</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks to make sure safe navigation isn&#8217;t used with <code>blank?</code> in
a conditional.</p>
</div>
<div class="sect2">
<h3 id="safety-railssafenavigationwithblank"><a class="anchor" href="#safety-railssafenavigationwithblank"></a>Safety</h3>
<div class="paragraph">
<p>While the safe navigation operator is generally a good idea, when
checking <code>foo&amp;.blank?</code> in a conditional, <code>foo</code> being <code>nil</code> will actually
do the opposite of what the author intends.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">foo&amp;.blank? #=&gt; nil
foo.blank? #=&gt; true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-railssafenavigationwithblank"><a class="anchor" href="#examples-railssafenavigationwithblank"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
do_something if foo&amp;.blank?
do_something unless foo&amp;.blank?

# good
do_something if foo.blank?
do_something unless foo.blank?</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railssavebang"><a class="anchor" href="#railssavebang"></a>Rails/SaveBang</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.42</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.59</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies possible cases where Active Record save! or related
should be used instead of save because the model might have failed to
save and an exception is better than unhandled failure.</p>
</div>
<div class="paragraph">
<p>This will allow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>update or save calls, assigned to a variable,
or used as a condition in an if/unless/case statement.</p>
</li>
<li>
<p>create calls, assigned to a variable that then has a
call to <code>persisted?</code>, or whose return value is checked by
<code>persisted?</code> immediately</p>
</li>
<li>
<p>calls if the result is explicitly returned from methods and blocks,
or provided as arguments.</p>
</li>
<li>
<p>calls whose signature doesn&#8217;t look like an ActiveRecord
persistence method.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default it will also allow implicit returns from methods and blocks.
that behavior can be turned off with <code>AllowImplicitReturn: false</code>.</p>
</div>
<div class="paragraph">
<p>You can permit receivers that are giving false positives with
<code>AllowedReceivers: []</code></p>
</div>
<div class="sect2">
<h3 id="safety-railssavebang"><a class="anchor" href="#safety-railssavebang"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because a custom <code>update</code> method call would be changed to <code>update!</code>,
but the method name in the definition would be unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># Original code
def update_attributes
end

update_attributes

# After running rubocop --safe-autocorrect
def update_attributes
end

update</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-railssavebang"><a class="anchor" href="#examples-railssavebang"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
user.save
user.update(name: 'Joe')
user.find_or_create_by(name: 'Joe')
user.destroy

# good
unless user.save
  # ...
end
user.save!
user.update!(name: 'Joe')
user.find_or_create_by!(name: 'Joe')
user.destroy!

user = User.find_or_create_by(name: 'Joe')
unless user.persisted?
  # ...
end

def save_user
  return user.save
end</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowimplicitreturn_-true-_default_-railssavebang"><a class="anchor" href="#allowimplicitreturn_-true-_default_-railssavebang"></a>AllowImplicitReturn: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
users.each { |u| u.save }

def save_user
  user.save
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowimplicitreturn_-false-railssavebang"><a class="anchor" href="#allowimplicitreturn_-false-railssavebang"></a>AllowImplicitReturn: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
users.each { |u| u.save }
def save_user
  user.save
end

# good
users.each { |u| u.save! }

def save_user
  user.save!
end

def save_user
  return user.save
end</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowedreceivers_-__merchant_customers__-_service__mailer__-railssavebang"><a class="anchor" href="#allowedreceivers_-__merchant_customers__-_service__mailer__-railssavebang"></a>AllowedReceivers: ['merchant.customers', 'Service::Mailer']</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
merchant.create
customers.builder.save
Mailer.create

module Service::Mailer
  self.create
end

# good
merchant.customers.create
MerchantService.merchant.customers.destroy
Service::Mailer.update(message: 'Message')
::Service::Mailer.update
Services::Service::Mailer.update(message: 'Message')
Service::Mailer::update</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railssavebang"><a class="anchor" href="#configurable-attributes-railssavebang"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowImplicitReturn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedReceivers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railssavebang"><a class="anchor" href="#references-railssavebang"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#save-bang" class="bare">https://rails.rubystyle.guide#save-bang</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsschemacomment"><a class="anchor" href="#railsschemacomment"></a>Rails/SchemaComment</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of the <code>comment</code> option when adding a new table or column
to the database during a migration.</p>
</div>
<div class="sect2">
<h3 id="examples-railsschemacomment"><a class="anchor" href="#examples-railsschemacomment"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad (no comment for a new column or table)
add_column :table, :column, :integer

create_table :table do |t|
  t.type :column
end

# good
add_column :table, :column, :integer, comment: 'Number of offenses'

create_table :table, comment: 'Table of offenses data' do |t|
  t.type :column, comment: 'Number of offenses'
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsscopeargs"><a class="anchor" href="#railsscopeargs"></a>Rails/ScopeArgs</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.12</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for scope calls where it was passed
a method (usually a scope) instead of a lambda/proc.</p>
</div>
<div class="sect2">
<h3 id="examples-railsscopeargs"><a class="anchor" href="#examples-railsscopeargs"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
scope :something, where(something: true)

# good
scope :something, -&gt; { where(something: true) }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsscopeargs"><a class="anchor" href="#configurable-attributes-railsscopeargs"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsselectmap"><a class="anchor" href="#railsselectmap"></a>Rails/SelectMap</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for uses of <code>select(:column_name)</code> with <code>map(&amp;:column_name)</code>.
These can be replaced with <code>pluck(:column_name)</code>.</p>
</div>
<div class="paragraph">
<p>There also should be some performance improvement since it skips instantiating the model class for matches.</p>
</div>
<div class="sect2">
<h3 id="safety-railsselectmap"><a class="anchor" href="#safety-railsselectmap"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because the model might override the attribute getter.
Additionally, the model&#8217;s <code>after_initialize</code> hooks are skipped when using <code>pluck</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsselectmap"><a class="anchor" href="#examples-railsselectmap"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Model.select(:column_name).map(&amp;:column_name)

# good
Model.pluck(:column_name)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsshorti18n"><a class="anchor" href="#railsshorti18n"></a>Rails/ShortI18n</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces that short forms of <code>I18n</code> methods are used:
<code>t</code> instead of <code>translate</code> and <code>l</code> instead of <code>localize</code>.</p>
</div>
<div class="paragraph">
<p>This cop has two different enforcement modes. When the EnforcedStyle
is conservative (the default) then only <code>I18n.translate</code> and <code>I18n.localize</code>
calls are added as offenses.</p>
</div>
<div class="paragraph">
<p>When the EnforcedStyle is aggressive then all <code>translate</code> and <code>localize</code> calls
without a receiver are added as offenses.</p>
</div>
<div class="sect2">
<h3 id="examples-railsshorti18n"><a class="anchor" href="#examples-railsshorti18n"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
I18n.translate :key
I18n.localize Time.now

# good
I18n.t :key
I18n.l Time.now</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-conservative-_default_-railsshorti18n"><a class="anchor" href="#enforcedstyle_-conservative-_default_-railsshorti18n"></a>EnforcedStyle: conservative (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
translate :key
localize Time.now
t :key
l Time.now</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-aggressive-railsshorti18n"><a class="anchor" href="#enforcedstyle_-aggressive-railsshorti18n"></a>EnforcedStyle: aggressive</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
translate :key
localize Time.now

# good
t :key
l Time.now</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsshorti18n"><a class="anchor" href="#configurable-attributes-railsshorti18n"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conservative</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conservative</code>, <code>aggressive</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsshorti18n"><a class="anchor" href="#references-railsshorti18n"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#short-i18n" class="bare">https://rails.rubystyle.guide/#short-i18n</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsskipsmodelvalidations"><a class="anchor" href="#railsskipsmodelvalidations"></a>Rails/SkipsModelValidations</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.25</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of methods which skip
validations which are listed in
<a href="https://guides.rubyonrails.org/active_record_validations.html#skipping-validations" class="bare">https://guides.rubyonrails.org/active_record_validations.html#skipping-validations</a></p>
</div>
<div class="paragraph">
<p>Methods may be ignored from this rule by configuring a <code>AllowedMethods</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railsskipsmodelvalidations"><a class="anchor" href="#safety-railsskipsmodelvalidations"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe if the receiver object is not an Active Record object.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsskipsmodelvalidations"><a class="anchor" href="#examples-railsskipsmodelvalidations"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Article.first.decrement!(:view_count)
DiscussionBoard.decrement_counter(:post_count, 5)
Article.first.increment!(:view_count)
DiscussionBoard.increment_counter(:post_count, 5)
person.toggle :active
product.touch
Billing.update_all("category = 'authorized', author = 'David'")
user.update_attribute(:website, 'example.com')
user.update_columns(last_request_at: Time.current)
Post.update_counters 5, comment_count: -1, action_count: 1

# good
user.update(website: 'example.com')
FileUtils.touch('file')</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowedmethods_-__touch__-railsskipsmodelvalidations"><a class="anchor" href="#allowedmethods_-__touch__-railsskipsmodelvalidations"></a>AllowedMethods: ["touch"]</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
DiscussionBoard.decrement_counter(:post_count, 5)
DiscussionBoard.increment_counter(:post_count, 5)
person.toggle :active

# good
user.touch</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsskipsmodelvalidations"><a class="anchor" href="#configurable-attributes-railsskipsmodelvalidations"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForbiddenMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>decrement!</code>, <code>decrement_counter</code>, <code>increment!</code>, <code>increment_counter</code>, <code>insert</code>, <code>insert!</code>, <code>insert_all</code>, <code>insert_all!</code>, <code>toggle!</code>, <code>touch</code>, <code>touch_all</code>, <code>update_all</code>, <code>update_attribute</code>, <code>update_column</code>, <code>update_columns</code>, <code>update_counters</code>, <code>upsert</code>, <code>upsert_all</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowedMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsskipsmodelvalidations"><a class="anchor" href="#references-railsskipsmodelvalidations"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://guides.rubyonrails.org/active_record_validations.html#skipping-validations" class="bare">https://guides.rubyonrails.org/active_record_validations.html#skipping-validations</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railssquishedsqlheredocs"><a class="anchor" href="#railssquishedsqlheredocs"></a>Rails/SquishedSQLHeredocs</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks SQL heredocs to use <code>.squish</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railssquishedsqlheredocs"><a class="anchor" href="#safety-railssquishedsqlheredocs"></a>Safety</h3>
<div class="paragraph">
<p>Some SQL syntax (e.g. PostgreSQL comments and functions) requires newlines
to be preserved in order to work, thus autocorrection for this cop is not safe.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railssquishedsqlheredocs"><a class="anchor" href="#examples-railssquishedsqlheredocs"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
&lt;&lt;-SQL
  SELECT * FROM posts;
SQL

&lt;&lt;-SQL
  SELECT * FROM posts
    WHERE id = 1
SQL

execute(&lt;&lt;~SQL, "Post Load")
  SELECT * FROM posts
    WHERE post_id = 1
SQL

# good
&lt;&lt;-SQL.squish
  SELECT * FROM posts;
SQL

&lt;&lt;~SQL.squish
  SELECT * FROM table
    WHERE id = 1
SQL

execute(&lt;&lt;~SQL.squish, "Post Load")
  SELECT * FROM posts
    WHERE post_id = 1
SQL</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railssquishedsqlheredocs"><a class="anchor" href="#references-railssquishedsqlheredocs"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#squished-heredocs" class="bare">https://rails.rubystyle.guide/#squished-heredocs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsstripheredoc"><a class="anchor" href="#railsstripheredoc"></a>Rails/StripHeredoc</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Requires Ruby version 2.3
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of squiggly heredoc over <code>strip_heredoc</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railsstripheredoc"><a class="anchor" href="#examples-railsstripheredoc"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
&lt;&lt;EOS.strip_heredoc
  some text
EOS

# bad
&lt;&lt;-EOS.strip_heredoc
  some text
EOS

# good
&lt;&lt;~EOS
  some text
EOS</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railsstripheredoc"><a class="anchor" href="#references-railsstripheredoc"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#prefer-squiggly-heredoc" class="bare">https://rails.rubystyle.guide/#prefer-squiggly-heredoc</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsstrongparametersexpect"><a class="anchor" href="#railsstrongparametersexpect"></a>Rails/StrongParametersExpect</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 8.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the use of <code>ActionController::Parameters#expect</code> as a method for strong parameter handling.</p>
</div>
<div class="sect2">
<h3 id="safety-railsstrongparametersexpect"><a class="anchor" href="#safety-railsstrongparametersexpect"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is considered unsafe because there are cases where the HTTP status may change
from 500 to 400 when handling invalid parameters. This change, however, reflects an intentional
incompatibility introduced for valid reasons by the <code>expect</code> method, which aligns better with
strong parameter conventions.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsstrongparametersexpect"><a class="anchor" href="#examples-railsstrongparametersexpect"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
params.require(:user).permit(:name, :age)
params.permit(user: [:name, :age]).require(:user)

# good
params.expect(user: [:name, :age])</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsstrongparametersexpect"><a class="anchor" href="#configurable-attributes-railsstrongparametersexpect"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/controllers/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsstrongparametersexpect"><a class="anchor" href="#references-railsstrongparametersexpect"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-expect" class="bare">https://api.rubyonrails.org/classes/ActionController/Parameters.html#method-i-expect</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstablenameassignment"><a class="anchor" href="#railstablenameassignment"></a>Rails/TableNameAssignment</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces the absence of explicit table name assignment.</p>
</div>
<div class="paragraph">
<p><code>self.table_name=</code> should only be used for very good reasons,
such as not having control over the database, or working
on a legacy project.</p>
</div>
<div class="paragraph">
<p>If you need to change how your model&#8217;s name is translated to
a table name, you may want to look at Inflections:
<a href="https://api.rubyonrails.org/classes/ActiveSupport/Inflector/Inflections.html" class="bare">https://api.rubyonrails.org/classes/ActiveSupport/Inflector/Inflections.html</a></p>
</div>
<div class="paragraph">
<p>If you wish to add a prefix in front of your model, or wish to change
the default prefix, <code>self.table_name_prefix</code> might better suit your needs:
<a href="https://api.rubyonrails.org/classes/ActiveRecord/ModelSchema.html#method-c-table_name_prefix-3D" class="bare">https://api.rubyonrails.org/classes/ActiveRecord/ModelSchema.html#method-c-table_name_prefix-3D</a></p>
</div>
<div class="paragraph">
<p>STI base classes named <code>Base</code> are ignored by this cop.
For more information: <a href="https://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html" class="bare">https://api.rubyonrails.org/classes/ActiveRecord/Inheritance.html</a></p>
</div>
<div class="sect2">
<h3 id="examples-railstablenameassignment"><a class="anchor" href="#examples-railstablenameassignment"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
self.table_name = 'some_table_name'
self.table_name = :some_other_name</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railstablenameassignment"><a class="anchor" href="#configurable-attributes-railstablenameassignment"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railstablenameassignment"><a class="anchor" href="#references-railstablenameassignment"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#keep-ar-defaults" class="bare">https://rails.rubystyle.guide/#keep-ar-defaults</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsthreestatebooleancolumn"><a class="anchor" href="#railsthreestatebooleancolumn"></a>Rails/ThreeStateBooleanColumn</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces that boolean columns are created with default values (<code>false</code> or <code>true</code>) and
<code>NOT NULL</code> constraint.</p>
</div>
<div class="sect2">
<h3 id="examples-railsthreestatebooleancolumn"><a class="anchor" href="#examples-railsthreestatebooleancolumn"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
add_column :users, :active, :boolean
t.column :active, :boolean
t.boolean :active

# good
add_column :users, :active, :boolean, default: true, null: false
t.column :active, :boolean, default: true, null: false
t.boolean :active, default: true, null: false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsthreestatebooleancolumn"><a class="anchor" href="#configurable-attributes-railsthreestatebooleancolumn"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>db/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railsthreestatebooleancolumn"><a class="anchor" href="#references-railsthreestatebooleancolumn"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#three-state-boolean" class="bare">https://rails.rubystyle.guide/#three-state-boolean</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstimezone"><a class="anchor" href="#railstimezone"></a>Rails/TimeZone</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of Time methods without zone.</p>
</div>
<div class="paragraph">
<p>Built on top of Ruby on Rails style guide (<a href="https://rails.rubystyle.guide#time" class="bare">https://rails.rubystyle.guide#time</a>)
and the article <a href="http://danilenko.org/2012/7/6/rails_timezones/" class="bare">http://danilenko.org/2012/7/6/rails_timezones/</a></p>
</div>
<div class="paragraph">
<p>Two styles are supported for this cop. When <code>EnforcedStyle</code> is 'strict'
then only use of <code>Time.zone</code> is allowed.</p>
</div>
<div class="paragraph">
<p>When EnforcedStyle is 'flexible' then it&#8217;s also allowed
to use <code>Time#in_time_zone</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railstimezone"><a class="anchor" href="#safety-railstimezone"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it may change handling time.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railstimezone"><a class="anchor" href="#examples-railstimezone"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Time.now
Time.parse('2015-03-02T19:05:37')
'2015-03-02T19:05:37'.to_time

# good
Time.current
Time.zone.now
Time.zone.parse('2015-03-02T19:05:37')
Time.zone.parse('2015-03-02T19:05:37Z') # Respect ISO 8601 format with timezone specifier.
Time.parse('2015-03-02T19:05:37Z') # Also respects ISO 8601
'2015-03-02T19:05:37Z'.to_time # Also respects ISO 8601</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-flexible-_default_-railstimezone"><a class="anchor" href="#enforcedstyle_-flexible-_default_-railstimezone"></a>EnforcedStyle: flexible (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># `flexible` allows usage of `in_time_zone` instead of `zone`.

# good
Time.at(timestamp).in_time_zone</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-strict-railstimezone"><a class="anchor" href="#enforcedstyle_-strict-railstimezone"></a>EnforcedStyle: strict</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># `strict` means that `Time` should be used with `zone`.

# bad
Time.at(timestamp).in_time_zone</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railstimezone"><a class="anchor" href="#configurable-attributes-railstimezone"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>flexible</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>strict</code>, <code>flexible</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>**/*.gemspec</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railstimezone"><a class="anchor" href="#references-railstimezone"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide#time" class="bare">https://rails.rubystyle.guide#time</a></p>
</li>
<li>
<p><a href="http://danilenko.org/2012/7/6/rails_timezones" class="bare">http://danilenko.org/2012/7/6/rails_timezones</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstimezoneassignment"><a class="anchor" href="#railstimezoneassignment"></a>Rails/TimeZoneAssignment</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of <code>Time.zone=</code> method.</p>
</div>
<div class="paragraph">
<p>The <code>zone</code> attribute persists for the rest of the Ruby runtime, potentially causing
unexpected behavior at a later time.
Using <code>Time.use_zone</code> ensures the code passed in the block is the only place Time.zone is affected.
It eliminates the possibility of a <code>zone</code> sticking around longer than intended.</p>
</div>
<div class="sect2">
<h3 id="examples-railstimezoneassignment"><a class="anchor" href="#examples-railstimezoneassignment"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Time.zone = 'EST'

# good
Time.use_zone('EST') do
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railstimezoneassignment"><a class="anchor" href="#configurable-attributes-railstimezoneassignment"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spec/**/*.rb</code>, <code>test/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railstimezoneassignment"><a class="anchor" href="#references-railstimezoneassignment"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://thoughtbot.com/blog/its-about-time-zones" class="bare">https://thoughtbot.com/blog/its-about-time-zones</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstoformatteds"><a class="anchor" href="#railstoformatteds"></a>Rails/ToFormattedS</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 7.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for consistent uses of <code>to_fs</code> or <code>to_formatted_s</code>,
depending on the cop&#8217;s configuration.</p>
</div>
<div class="sect2">
<h3 id="examples-railstoformatteds"><a class="anchor" href="#examples-railstoformatteds"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-to_fs-_default_-railstoformatteds"><a class="anchor" href="#enforcedstyle_-to_fs-_default_-railstoformatteds"></a>EnforcedStyle: to_fs (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
time.to_formatted_s(:db)

# good
time.to_fs(:db)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-to_formatted_s-railstoformatteds"><a class="anchor" href="#enforcedstyle_-to_formatted_s-railstoformatteds"></a>EnforcedStyle: to_formatted_s</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
time.to_fs(:db)

# good
time.to_formatted_s(:db)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railstoformatteds"><a class="anchor" href="#configurable-attributes-railstoformatteds"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>to_fs</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>to_fs</code>, <code>to_formatted_s</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railstoformatteds"><a class="anchor" href="#references-railstoformatteds"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#prefer-to-fs" class="bare">https://rails.rubystyle.guide/#prefer-to-fs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstoswithargument"><a class="anchor" href="#railstoswithargument"></a>Rails/ToSWithArgument</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 7.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies passing any argument to <code>#to_s</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railstoswithargument"><a class="anchor" href="#safety-railstoswithargument"></a>Safety</h3>
<div class="paragraph">
<p>This cop is marked as unsafe because it may detect <code>#to_s</code> calls
that are not related to Active Support implementation.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railstoswithargument"><a class="anchor" href="#examples-railstoswithargument"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
obj.to_s(:delimited)

# good
obj.to_formatted_s(:delimited)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstoplevelhashwithindifferentaccess"><a class="anchor" href="#railstoplevelhashwithindifferentaccess"></a>Rails/TopLevelHashWithIndifferentAccess</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 5.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies top-level <code>HashWithIndifferentAccess</code>.
This has been soft-deprecated since Rails 5.1.</p>
</div>
<div class="sect2">
<h3 id="examples-railstoplevelhashwithindifferentaccess"><a class="anchor" href="#examples-railstoplevelhashwithindifferentaccess"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
HashWithIndifferentAccess.new(foo: 'bar')

# good
ActiveSupport::HashWithIndifferentAccess.new(foo: 'bar')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railstoplevelhashwithindifferentaccess"><a class="anchor" href="#configurable-attributes-railstoplevelhashwithindifferentaccess"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railstoplevelhashwithindifferentaccess"><a class="anchor" href="#references-railstoplevelhashwithindifferentaccess"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://guides.rubyonrails.org/upgrading_ruby_on_rails.html#top-level-hashwithindifferentaccess-is-soft-deprecated" class="bare">https://guides.rubyonrails.org/upgrading_ruby_on_rails.html#top-level-hashwithindifferentaccess-is-soft-deprecated</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railstransactionexitstatement"><a class="anchor" href="#railstransactionexitstatement"></a>Rails/TransactionExitStatement</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of exit statements (namely <code>return</code>,
<code>break</code> and <code>throw</code>) in transactions. This is due to the eventual
unexpected behavior when using ActiveRecord &gt;= 7, where transactions
exited using these statements are being rollbacked rather than
committed (pre ActiveRecord 7 behavior).</p>
</div>
<div class="paragraph">
<p>As alternatives, it would be more intuitive to explicitly raise an
error when rollback is desired, and to use <code>next</code> when commit is
desired.</p>
</div>
<div class="paragraph">
<p>If you are defining custom transaction methods, you can configure it with <code>TransactionMethods</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This cop is disabled on Rails &gt;= 7.2 because transactions were restored
to their historical behavior. In Rails 7.1, the behavior is controlled with
the config <code>active_record.commit_transaction_on_non_local_return</code>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railstransactionexitstatement"><a class="anchor" href="#examples-railstransactionexitstatement"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
ApplicationRecord.transaction do
  return if user.active?
end

# bad
ApplicationRecord.transaction do
  break if user.active?
end

# bad
ApplicationRecord.transaction do
  throw if user.active?
end

# bad, as `with_lock` implicitly opens a transaction too
user.with_lock do
  throw if user.active?
end

# bad, as `with_lock` implicitly opens a transaction too
ApplicationRecord.with_lock do
  break if user.active?
end

# good
ApplicationRecord.transaction do
  # Rollback
  raise "User is active" if user.active?
end

# good
ApplicationRecord.transaction do
  # Commit
  next if user.active?
end</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="transactionmethods_-__custom_transaction__-railstransactionexitstatement"><a class="anchor" href="#transactionmethods_-__custom_transaction__-railstransactionexitstatement"></a>TransactionMethods: ["custom_transaction"]</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
CustomModel.custom_transaction do
  return if user.active?
end</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railstransactionexitstatement"><a class="anchor" href="#configurable-attributes-railstransactionexitstatement"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TransactionMethods</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railstransactionexitstatement"><a class="anchor" href="#references-railstransactionexitstatement"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rails/rails/commit/15aa4200e083" class="bare">https://github.com/rails/rails/commit/15aa4200e083</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsuniqbeforepluck"><a class="anchor" href="#railsuniqbeforepluck"></a>Rails/UniqBeforePluck</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.40</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Prefer using <code>distinct</code> before <code>pluck</code> instead of <code>uniq</code> after <code>pluck</code>.</p>
</div>
<div class="paragraph">
<p>The use of distinct before pluck is preferred because it executes by
the database.</p>
</div>
<div class="paragraph">
<p>This cop has two different enforcement modes. When the EnforcedStyle
is <code>conservative</code> (the default), then only calls to <code>pluck</code> on a constant
(i.e. a model class) before <code>uniq</code> are added as offenses.</p>
</div>
<div class="paragraph">
<p>When the EnforcedStyle is <code>aggressive</code> then all calls to <code>pluck</code> before
distinct are added as offenses. This may lead to false positives
as the cop cannot distinguish between calls to <code>pluck</code> on an
ActiveRecord::Relation vs a call to pluck on an
ActiveRecord::Associations::CollectionProxy.</p>
</div>
<div class="sect2">
<h3 id="safety-railsuniqbeforepluck"><a class="anchor" href="#safety-railsuniqbeforepluck"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for autocorrection because the behavior may change
depending on the database collation.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railsuniqbeforepluck"><a class="anchor" href="#examples-railsuniqbeforepluck"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-conservative-_default_-railsuniqbeforepluck"><a class="anchor" href="#enforcedstyle_-conservative-_default_-railsuniqbeforepluck"></a>EnforcedStyle: conservative (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad - redundantly fetches duplicate values
Album.pluck(:band_name).uniq

# good
Album.distinct.pluck(:band_name)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-aggressive-railsuniqbeforepluck"><a class="anchor" href="#enforcedstyle_-aggressive-railsuniqbeforepluck"></a>EnforcedStyle: aggressive</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad - redundantly fetches duplicate values
Album.pluck(:band_name).uniq

# bad - redundantly fetches duplicate values
Album.where(year: 1985).pluck(:band_name).uniq

# bad - redundantly fetches duplicate values
customer.favourites.pluck(:color).uniq

# good
Album.distinct.pluck(:band_name)
Album.distinct.where(year: 1985).pluck(:band_name)
customer.favourites.distinct.pluck(:color)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsuniqbeforepluck"><a class="anchor" href="#configurable-attributes-railsuniqbeforepluck"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conservative</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>conservative</code>, <code>aggressive</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsuniquevalidationwithoutindex"><a class="anchor" href="#railsuniquevalidationwithoutindex"></a>Rails/UniqueValidationWithoutIndex</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>When you define a uniqueness validation in Active Record model,
you also should add a unique index for the column. There are two reasons.
First, duplicated records may occur even if Active Record&#8217;s validation
is defined.
Second, it will cause slow queries. The validation executes a <code>SELECT</code>
statement with the target column when inserting/updating a record.
If the column does not have an index and the table is large,
the query will be heavy.</p>
</div>
<div class="paragraph">
<p>Note that the cop does nothing if db/schema.rb does not exist.</p>
</div>
<div class="sect2">
<h3 id="examples-railsuniquevalidationwithoutindex"><a class="anchor" href="#examples-railsuniquevalidationwithoutindex"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad - if the schema does not have a unique index
validates :account, uniqueness: true

# good - if the schema has a unique index
validates :account, uniqueness: true

# good - even if the schema does not have a unique index
validates :account, length: { minimum: MIN_LENGTH }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsuniquevalidationwithoutindex"><a class="anchor" href="#configurable-attributes-railsuniquevalidationwithoutindex"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsunknownenv"><a class="anchor" href="#railsunknownenv"></a>Rails/UnknownEnv</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.51</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks that environments called with <code>Rails.env</code> predicates
exist.
By default the cop allows three environments which Rails ships with:
<code>development</code>, <code>test</code>, and <code>production</code>.
More can be added to the <code>Environments</code> config parameter.</p>
</div>
<div class="sect2">
<h3 id="examples-railsunknownenv"><a class="anchor" href="#examples-railsunknownenv"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Rails.env.proudction?
Rails.env == 'proudction'

# good
Rails.env.production?
Rails.env == 'production'</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsunknownenv"><a class="anchor" href="#configurable-attributes-railsunknownenv"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>development</code>, <code>test</code>, <code>production</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsunusedignoredcolumns"><a class="anchor" href="#railsunusedignoredcolumns"></a>Rails/UnusedIgnoredColumns</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.25</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Suggests you remove a column that does not exist in the schema from <code>ignored_columns</code>.
<code>ignored_columns</code> is necessary to drop a column from RDBMS, but you don&#8217;t need it after the migration
to drop the column. You avoid forgetting to remove <code>ignored_columns</code> by this cop.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
This cop can&#8217;t be used to effectively check for unused columns because the development
and production schema can be out of sync until the migration has been run on production. As such,
this cop can cause <code>ignored_columns</code> to be removed even though the production schema still contains
the column, which can lead to downtime when the migration is actually executed. Only enable this cop
if you know your migrations will be run before any of your Rails applications boot with the modified code.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="examples-railsunusedignoredcolumns"><a class="anchor" href="#examples-railsunusedignoredcolumns"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class User &lt; ApplicationRecord
  self.ignored_columns = [:already_removed_column]
end

# good
class User &lt; ApplicationRecord
  self.ignored_columns = [:still_existing_column]
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsunusedignoredcolumns"><a class="anchor" href="#configurable-attributes-railsunusedignoredcolumns"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsunusedrendercontent"><a class="anchor" href="#railsunusedrendercontent"></a>Rails/UnusedRenderContent</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you try to render content along with a non-content status code (100-199, 204, 205, or 304),
it will be dropped from the response.</p>
</div>
<div class="paragraph">
<p>This cop checks for uses of <code>render</code> which specify both body content and a non-content status.</p>
</div>
<div class="sect2">
<h3 id="examples-railsunusedrendercontent"><a class="anchor" href="#examples-railsunusedrendercontent"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
render 'foo', status: :continue
render status: 100, plain: 'Ruby!'

# good
head :continue
head 100</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsunusedrendercontent"><a class="anchor" href="#configurable-attributes-railsunusedrendercontent"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railsvalidation"><a class="anchor" href="#railsvalidation"></a>Rails/Validation</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.41</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for the use of old-style attribute validation macros.</p>
</div>
<div class="sect2">
<h3 id="examples-railsvalidation"><a class="anchor" href="#examples-railsvalidation"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
validates_acceptance_of :foo
validates_comparison_of :foo
validates_confirmation_of :foo
validates_exclusion_of :foo
validates_format_of :foo
validates_inclusion_of :foo
validates_length_of :foo
validates_numericality_of :foo
validates_presence_of :foo
validates_absence_of :foo
validates_size_of :foo
validates_uniqueness_of :foo

# good
validates :foo, acceptance: true
validates :foo, confirmation: true
validates :foo, comparison: true
validates :foo, exclusion: true
validates :foo, format: true
validates :foo, inclusion: true
validates :foo, length: true
validates :foo, numericality: true
validates :foo, presence: true
validates :foo, absence: true
validates :foo, length: true
validates :foo, uniqueness: true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railsvalidation"><a class="anchor" href="#configurable-attributes-railsvalidation"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>app/models/**/*.rb</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railswhereequals"><a class="anchor" href="#railswhereequals"></a>Rails/WhereEquals</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.26</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where manually constructed SQL
in <code>where</code> and <code>where.not</code> can be replaced with
<code>where(attribute: value)</code> and <code>where.not(attribute: value)</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railswhereequals"><a class="anchor" href="#safety-railswhereequals"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because is may change SQL.
See: <a href="https://github.com/rubocop/rubocop-rails/issues/403" class="bare">https://github.com/rubocop/rubocop-rails/issues/403</a></p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railswhereequals"><a class="anchor" href="#examples-railswhereequals"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where('name = ?', 'Gabe')
User.where.not('name = ?', 'Gabe')
User.where('name = :name', name: 'Gabe')
User.where('name IS NULL')
User.where('name IN (?)', ['john', 'jane'])
User.where('name IN (:names)', names: ['john', 'jane'])
User.where('users.name = :name', name: 'Gabe')

# good
User.where(name: 'Gabe')
User.where.not(name: 'Gabe')
User.where(name: nil)
User.where(name: ['john', 'jane'])
User.where(users: { name: 'Gabe' })</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railswhereequals"><a class="anchor" href="#references-railswhereequals"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#hash-conditions" class="bare">https://rails.rubystyle.guide/#hash-conditions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railswhereexists"><a class="anchor" href="#railswhereexists"></a>Rails/WhereExists</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Enforces consistent style when using <code>exists?</code>.</p>
</div>
<div class="paragraph">
<p>Two styles are supported for this cop. When EnforcedStyle is 'exists'
then the cop enforces <code>exists?(&#8230;&#8203;)</code> over <code>where(&#8230;&#8203;).exists?</code>.</p>
</div>
<div class="paragraph">
<p>When EnforcedStyle is 'where' then the cop enforces
<code>where(&#8230;&#8203;).exists?</code> over <code>exists?(&#8230;&#8203;)</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-railswhereexists"><a class="anchor" href="#safety-railswhereexists"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for autocorrection because the behavior may change on the following case:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">Author.includes(:articles).where(articles: {id: id}).exists?
#=&gt; Perform `eager_load` behavior (`LEFT JOIN` query) and get result.

Author.includes(:articles).exists?(articles: {id: id})
#=&gt; Perform `preload` behavior and `ActiveRecord::StatementInvalid` error occurs.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-railswhereexists"><a class="anchor" href="#examples-railswhereexists"></a>Examples</h3>
<div class="sect3">
<h4 id="enforcedstyle_-exists-_default_-railswhereexists"><a class="anchor" href="#enforcedstyle_-exists-_default_-railswhereexists"></a>EnforcedStyle: exists (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where(name: 'john').exists?
User.where(['name = ?', 'john']).exists?
User.where('name = ?', 'john').exists?
user.posts.where(published: true).exists?

# good
User.exists?(name: 'john')
User.where('length(name) &gt; 10').exists?
user.posts.exists?(published: true)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="enforcedstyle_-where-railswhereexists"><a class="anchor" href="#enforcedstyle_-where-railswhereexists"></a>EnforcedStyle: where</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.exists?(name: 'john')
User.exists?(['name = ?', 'john'])
user.posts.exists?(published: true)

# good
User.where(name: 'john').exists?
User.where(['name = ?', 'john']).exists?
User.where('name = ?', 'john').exists?
user.posts.where(published: true).exists?
User.where('length(name) &gt; 10').exists?</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railswhereexists"><a class="anchor" href="#configurable-attributes-railswhereexists"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnforcedStyle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exists</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>exists</code>, <code>where</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railswheremissing"><a class="anchor" href="#railswheremissing"></a>Rails/WhereMissing</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 6.1
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Use <code>where.missing(&#8230;&#8203;)</code> to find missing relationship records.</p>
</div>
<div class="paragraph">
<p>This cop is enabled in Rails 6.1 or higher.</p>
</div>
<div class="sect2">
<h3 id="examples-railswheremissing"><a class="anchor" href="#examples-railswheremissing"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Post.left_joins(:author).where(authors: { id: nil })

# good
Post.where.missing(:author)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railswheremissing"><a class="anchor" href="#references-railswheremissing"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#finding-missing-relationship-records" class="bare">https://rails.rubystyle.guide/#finding-missing-relationship-records</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railswherenot"><a class="anchor" href="#railswherenot"></a>Rails/WhereNot</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where manually constructed SQL
in <code>where</code> can be replaced with <code>where.not(&#8230;&#8203;)</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railswherenot"><a class="anchor" href="#examples-railswherenot"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where('name != ?', 'Gabe')
User.where('name != :name', name: 'Gabe')
User.where('name &lt;&gt; ?', 'Gabe')
User.where('name &lt;&gt; :name', name: 'Gabe')
User.where('name IS NOT NULL')
User.where('name NOT IN (?)', ['john', 'jane'])
User.where('name NOT IN (:names)', names: ['john', 'jane'])
User.where('users.name != :name', name: 'Gabe')

# good
User.where.not(name: 'Gabe')
User.where.not(name: nil)
User.where.not(name: ['john', 'jane'])
User.where.not(users: { name: 'Gabe' })</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railswherenot"><a class="anchor" href="#references-railswherenot"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#hash-conditions" class="bare">https://rails.rubystyle.guide/#hash-conditions</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railswherenotwithmultipleconditions"><a class="anchor" href="#railswherenotwithmultipleconditions"></a>Rails/WhereNotWithMultipleConditions</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.18</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies calls to <code>where.not</code> with multiple hash arguments.</p>
</div>
<div class="paragraph">
<p>The behavior of <code>where.not</code> changed in Rails 6.1. Prior to the change,
<code>.where.not(trashed: true, role: 'admin')</code> evaluated to
<code>WHERE trashed != TRUE AND role != 'admin'</code>.
From Rails 6.1 onwards, this executes the query
<code>WHERE NOT (trashed == TRUE AND roles == 'admin')</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-railswherenotwithmultipleconditions"><a class="anchor" href="#examples-railswherenotwithmultipleconditions"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where.not(trashed: true, role: 'admin')
User.where.not(trashed: true, role: ['moderator', 'admin'])
User.joins(:posts).where.not(posts: { trashed: true, title: 'Rails' })

# good
User.where.not(trashed: true)
User.where.not(role: ['moderator', 'admin'])
User.where.not(trashed: true).where.not(role: ['moderator', 'admin'])
User.where.not('trashed = ? OR role = ?', true, 'admin')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-railswherenotwithmultipleconditions"><a class="anchor" href="#configurable-attributes-railswherenotwithmultipleconditions"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>warning</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-railswherenotwithmultipleconditions"><a class="anchor" href="#references-railswherenotwithmultipleconditions"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#where-not-with-multiple-attributes" class="bare">https://rails.rubystyle.guide/#where-not-with-multiple-attributes</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="railswhererange"><a class="anchor" href="#railswhererange"></a>Rails/WhereRange</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Requires Ruby version 2.6
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Rails version: 6.0
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where manually constructed SQL
in <code>where</code> can be replaced with ranges.</p>
</div>
<div class="sect2">
<h3 id="safety-railswhererange"><a class="anchor" href="#safety-railswhererange"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because it can change the query
by explicitly attaching the column to the wrong table.
For example, <code>Booking.joins(:events).where('end_at &lt; ?', Time.current)</code> will correctly
implicitly attach the <code>end_at</code> column to the <code>events</code> table. But when autocorrected to
<code>Booking.joins(:events).where(end_at: &#8230;&#8203;Time.current)</code>, it will now be incorrectly
explicitly attached to the <code>bookings</code> table.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-railswhererange"><a class="anchor" href="#examples-railswhererange"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
User.where('age &gt;= ?', 18)
User.where.not('age &gt;= ?', 18)
User.where('age &lt; ?', 18)
User.where('age &gt;= ? AND age &lt; ?', 18, 21)
User.where('age &gt;= :start', start: 18)
User.where('users.age &gt;= ?', 18)

# good
User.where(age: 18..)
User.where.not(age: 18..)
User.where(age: ...18)
User.where(age: 18...21)
User.where(users: { age: 18.. })

# good
# There are no beginless ranges in ruby.
User.where('age &gt; ?', 18)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-railswhererange"><a class="anchor" href="#references-railswhererange"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://rails.rubystyle.guide/#where-ranges" class="bare">https://rails.rubystyle.guide/#where-ranges</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="cops.html">Cops</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright (C) 2012-2024 <a href="https://batsov.com">Bozhidar Batsov</a> and RuboCop contributors.</p>
  <p>Except where otherwise noted, docs.rubocop.org is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a> (CC BY-SA 4.0).</p>
</footer>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3.3.3"></script>
<script type="text/javascript">
 docsearch({
   container: '#docsearch',
   appId: '2GTF3GZ5BX',
   apiKey: 'b6bbe6539f46224f4f39cd14a1b7ae78',
   indexName: 'rubocop',
   debug: false // Set debug to true if you want to inspect the dropdown
 });
</script>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
