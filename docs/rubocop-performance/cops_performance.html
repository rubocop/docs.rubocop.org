<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Performance :: RuboCop Docs</title>
    <link rel="canonical" href="https://docs.rubocop.org/rubocop-performance/cops_performance.html">
    <link rel="prev" href="cops.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../_/css/site.css">
<link rel="stylesheet" href="../_/css/site-extra.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3.3.3">
<style>:root{--docsearch-primary-color: #bd362f} </style>
<link rel="icon" href="../_/img/favicon.ico" type="image/x-icon">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-140153536-1"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','UA-140153536-1')</script>
  </head>
  <body class="article">
<header class="header" role="banner">
  <nav class="navbar">
    <div class="navbar-brand">
      <div class="navbar-item">
        <a href="https://rubocop.org">RuboCop</a>
        <span class="separator">//</span>
        <a href="https://docs.rubocop.org">Docs</a>
      </div>
      <div class="navbar-item">
        <div id="docsearch"></div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href=index.html>Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Style Guides</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://rubystyle.guide">Ruby</a>
            <a class="navbar-item" href="https://rails.rubystyle.guide">Rails</a>
            <a class="navbar-item" href="https://rspec.rubystyle.guide">RSpec</a>
            <a class="navbar-item" href="https://minitest.rubystyle.guide">Minitest</a>
          </div>
        </div>
        <a class="navbar-item" href="https://www.rubydoc.info/gems/rubocop">API Docs</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Projects</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rubocop/rubocop">RuboCop</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-ast">RuboCop AST</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-capybara">RuboCop Capybara</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-factory_bot">RuboCop factory_bot</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-minitest">RuboCop Minitest</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-performance">RuboCop Performance</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rails">RuboCop Rails</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rake">RuboCop Rake</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rspec">RuboCop RSpec</a>
            <a class="navbar-item" href="https://github.com/rubocop/rubocop-rspec_rails">RuboCop RSpec Rails</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://github.com/rubocop">GitHub Org</a>
            <a class="navbar-item" href="https://gitter.im/bbatsov/rubocop">Chat (Gitter)</a>
            <a class="navbar-item" href="https://opencollective.com/rubocop">Open Collective</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="rubocop-performance" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="index.html">RuboCop Performance</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="usage.html">Usage</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="cops.html">Cops</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Cops Documentation</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="cops_performance.html">Performance</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">RuboCop Performance</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../rubocop/index.html">RuboCop</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.65/index.html">1.65</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.64/index.html">1.64</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.63/index.html">1.63</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.62/index.html">1.62</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.61/index.html">1.61</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.60/index.html">1.60</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.59/index.html">1.59</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.58/index.html">1.58</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.57/index.html">1.57</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.56/index.html">1.56</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.55/index.html">1.55</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.54/index.html">1.54</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.53/index.html">1.53</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.52/index.html">1.52</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.51/index.html">1.51</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.50/index.html">1.50</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.49/index.html">1.49</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.48/index.html">1.48</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.47/index.html">1.47</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.46/index.html">1.46</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.45/index.html">1.45</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.44/index.html">1.44</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.43/index.html">1.43</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.42/index.html">1.42</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.41/index.html">1.41</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.40/index.html">1.40</a>
        </li>
        <li class="version">
          <a href="../rubocop/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-ast/1.32/index.html">RuboCop AST</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-ast/1.32/index.html">1.32</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.12/index.html">1.12</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.11/index.html">1.11</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.10/index.html">1.10</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.9/index.html">1.9</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.8/index.html">1.8</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.7/index.html">1.7</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.6/index.html">1.6</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.5/index.html">1.5</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.4/index.html">1.4</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.3/index.html">1.3</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.2/index.html">1.2</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.1/index.html">1.1</a>
        </li>
        <li class="version">
          <a href="../rubocop-ast/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-capybara/index.html">RuboCop Capybara</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-capybara/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop-capybara/2.21/index.html">2.21</a>
        </li>
        <li class="version">
          <a href="../rubocop-capybara/2.20/index.html">2.20</a>
        </li>
        <li class="version">
          <a href="../rubocop-capybara/2.19/index.html">2.19</a>
        </li>
        <li class="version">
          <a href="../rubocop-capybara/2.18/index.html">2.18</a>
        </li>
        <li class="version">
          <a href="../rubocop-capybara/2.17/index.html">2.17</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-factory_bot/index.html">RuboCop factory_bot</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-factory_bot/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop-factory_bot/2.26/index.html">2.26</a>
        </li>
        <li class="version">
          <a href="../rubocop-factory_bot/2.25/index.html">2.25</a>
        </li>
        <li class="version">
          <a href="../rubocop-factory_bot/2.24/index.html">2.24</a>
        </li>
        <li class="version">
          <a href="../rubocop-factory_bot/2.23/index.html">2.23</a>
        </li>
        <li class="version">
          <a href="../rubocop-factory_bot/2.22/index.html">2.22</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-minitest/index.html">RuboCop Minitest</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-minitest/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.35/index.html">0.35</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.34/index.html">0.34</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.33/index.html">0.33</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.32/index.html">0.32</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.31/index.html">0.31</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.30/index.html">0.30</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.29/index.html">0.29</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.28/index.html">0.28</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.27/index.html">0.27</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.26/index.html">0.26</a>
        </li>
        <li class="version">
          <a href="../rubocop-minitest/0.25/index.html">0.25</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-packaging/index.html">RuboCop Packaging</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-packaging/index.html">master</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="index.html">RuboCop Performance</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="index.html">default</a>
        </li>
        <li class="version">
          <a href="1.21/index.html">1.21</a>
        </li>
        <li class="version">
          <a href="1.20/index.html">1.20</a>
        </li>
        <li class="version">
          <a href="1.19/index.html">1.19</a>
        </li>
        <li class="version">
          <a href="1.18/index.html">1.18</a>
        </li>
        <li class="version">
          <a href="1.17/index.html">1.17</a>
        </li>
        <li class="version">
          <a href="1.16/index.html">1.16</a>
        </li>
        <li class="version">
          <a href="1.15/index.html">1.15</a>
        </li>
        <li class="version">
          <a href="1.14/index.html">1.14</a>
        </li>
        <li class="version">
          <a href="1.13/index.html">1.13</a>
        </li>
        <li class="version">
          <a href="1.12/index.html">1.12</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-rails/index.html">RuboCop Rails</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-rails/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.26/index.html">2.26</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.25/index.html">2.25</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.24/index.html">2.24</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.23/index.html">2.23</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.22/index.html">2.22</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.21/index.html">2.21</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.20/index.html">2.20</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.19/index.html">2.19</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.18/index.html">2.18</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.17/index.html">2.17</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.16/index.html">2.16</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.15/index.html">2.15</a>
        </li>
        <li class="version">
          <a href="../rubocop-rails/2.14/index.html">2.14</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-rspec/index.html">RuboCop RSpec</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-rspec/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/3.0/index.html">3.0</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.31/index.html">2.31</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.30/index.html">2.30</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.29/index.html">2.29</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.28/index.html">2.28</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.27/index.html">2.27</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.26/index.html">2.26</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.25/index.html">2.25</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/2.24/index.html">2.24</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec/1.44/index.html">1.44</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../rubocop-rspec_rails/index.html">RuboCop RSpec Rails</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../rubocop-rspec_rails/index.html">default</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec_rails/2.30/index.html">2.30</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec_rails/2.29/index.html">2.29</a>
        </li>
        <li class="version">
          <a href="../rubocop-rspec_rails/2.28/index.html">2.28</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../rubocop/1.65/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="index.html">RuboCop Performance</a></li>
    <li>Cops Documentation</li>
    <li><a href="cops_performance.html">Performance</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">default</button>
  <div class="version-menu">
    <a class="version is-current" href="cops_performance.html">default</a>
    <a class="version" href="1.21/cops_performance.html">1.21</a>
    <a class="version" href="1.20/cops_performance.html">1.20</a>
    <a class="version" href="1.19/cops_performance.html">1.19</a>
    <a class="version" href="1.18/cops_performance.html">1.18</a>
    <a class="version" href="1.17/cops_performance.html">1.17</a>
    <a class="version" href="1.16/cops_performance.html">1.16</a>
    <a class="version" href="1.15/cops_performance.html">1.15</a>
    <a class="version" href="1.14/cops_performance.html">1.14</a>
    <a class="version" href="1.13/cops_performance.html">1.13</a>
    <a class="version" href="1.12/cops_performance.html">1.12</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/rubocop/rubocop-performance/edit/master/docs/modules/ROOT/pages/cops_performance.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Performance</h1>
<div class="sect1">
<h2 id="performanceancestorsinclude"><a class="anchor" href="#performanceancestorsinclude"></a>Performance/AncestorsInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>ancestors.include?</code> and change them to use <code>&#8656;</code> instead.</p>
</div>
<div class="sect2">
<h3 id="safety"><a class="anchor" href="#safety"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it can&#8217;t tell whether the receiver is a class or an object.
e.g. the false positive was for <code>Nokogiri::XML::Node#ancestors</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples"><a class="anchor" href="#examples"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
A.ancestors.include?(B)

# good
A &lt;= B</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references"><a class="anchor" href="#references"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#ancestorsinclude-vs&#8212;&#8203;code" class="bare">https://github.com/fastruby/fast-ruby#ancestorsinclude-vs&#8212;&#8203;code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancearraysemiinfiniterangeslice"><a class="anchor" href="#performancearraysemiinfiniterangeslice"></a>Performance/ArraySemiInfiniteRangeSlice</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where slicing arrays with semi-infinite ranges
can be replaced by <code>Array#take</code> and <code>Array#drop</code>.
This cop was created due to a mistake in microbenchmark and hence is disabled by default.
Refer <a href="https://github.com/rubocop/rubocop-performance/pull/175#issuecomment-731892717" class="bare">https://github.com/rubocop/rubocop-performance/pull/175#issuecomment-731892717</a></p>
</div>
<div class="sect2">
<h3 id="safety-2"><a class="anchor" href="#safety-2"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe for string slices because strings do not have <code>#take</code> and <code>#drop</code> methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-2"><a class="anchor" href="#examples-2"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array[..2]
array[...2]
array[2..]
array[2...]
array.slice(..2)

# good
array.take(3)
array.take(2)
array.drop(2)
array.drop(2)
array.take(3)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancebigdecimalwithnumericargument"><a class="anchor" href="#performancebigdecimalwithnumericargument"></a>Performance/BigDecimalWithNumericArgument</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where numeric argument to BigDecimal should be
converted to string. Initializing from String is faster
than from Numeric for BigDecimal.</p>
</div>
<div class="sect2">
<h3 id="examples-3"><a class="anchor" href="#examples-3"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
BigDecimal(1, 2)
4.to_d(6)
BigDecimal(1.2, 3, exception: true)
4.5.to_d(6, exception: true)

# good
BigDecimal('1', 2)
BigDecimal('4', 6)
BigDecimal('1.2', 3, exception: true)
BigDecimal('4.5', 6, exception: true)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancebindcall"><a class="anchor" href="#performancebindcall"></a>Performance/BindCall</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.7, <code>UnboundMethod#bind_call</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>bind(obj).call(args, &#8230;&#8203;)</code>
can be replaced by <code>bind_call(obj, args, &#8230;&#8203;)</code>.</p>
</div>
<div class="paragraph">
<p>The <code>bind_call(obj, args, &#8230;&#8203;)</code> method is faster than
<code>bind(obj).call(args, &#8230;&#8203;)</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-4"><a class="anchor" href="#examples-4"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
umethod.bind(obj).call(foo, bar)
umethod.bind(obj).(foo, bar)

# good
umethod.bind_call(obj, foo, bar)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceblockgivenwithexplicitblock"><a class="anchor" href="#performanceblockgivenwithexplicitblock"></a>Performance/BlockGivenWithExplicitBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a <code>block_given?</code> where explicit check
of block argument would suffice.</p>
</div>
<div class="sect2">
<h3 id="examples-5"><a class="anchor" href="#examples-5"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def method(&amp;block)
  do_something if block_given?
end

# good
def method(&amp;block)
  do_something if block
end

# good - block is reassigned
def method(&amp;block)
  block ||= -&gt; { do_something }
  warn "Using default ..." unless block_given?
  # ...
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecaller"><a class="anchor" href="#performancecaller"></a>Performance/Caller</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.49</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>caller[n]</code> can be replaced by <code>caller(n..n).first</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-6"><a class="anchor" href="#examples-6"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
caller[1]
caller.first
caller_locations[1]
caller_locations.first

# good
caller(2..2).first
caller(1..1).first
caller_locations(2..2).first
caller_locations(1..1).first</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecasewhensplat"><a class="anchor" href="#performancecasewhensplat"></a>Performance/CaseWhenSplat</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.34</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Reordering <code>when</code> conditions with a splat to the end
of the <code>when</code> branches can improve performance.</p>
</div>
<div class="paragraph">
<p>Ruby has to allocate memory for the splat expansion every time
that the <code>case</code> <code>when</code> statement is run. Since Ruby does not support
fall through inside of <code>case</code> <code>when</code>, like some other languages do,
the order of the <code>when</code> branches should not matter. By placing any
splat expansions at the end of the list of <code>when</code> branches we will
reduce the number of times that memory has to be allocated for
the expansion. The exception to this is if multiple of your <code>when</code>
conditions can be true for any given condition. A likely scenario for
this defining a higher level when condition to override a condition
that is inside of the splat expansion.</p>
</div>
<div class="sect2">
<h3 id="safety-3"><a class="anchor" href="#safety-3"></a>Safety</h3>
<div class="paragraph">
<p>This cop is not unsafe autocorrection because it is not a guaranteed
performance improvement. If the data being processed by the <code>case</code> condition is
normalized in a manner that favors hitting a condition in the splat expansion,
it is possible that moving the splat condition to the end will use more memory,
and run slightly slower.
See for more details: <a href="https://github.com/rubocop/rubocop/pull/6163" class="bare">https://github.com/rubocop/rubocop/pull/6163</a></p>
</div>
</div>
<div class="sect2">
<h3 id="examples-7"><a class="anchor" href="#examples-7"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
case foo
when *condition
  bar
when baz
  foobar
end

case foo
when *[1, 2, 3, 4]
  bar
when 5
  baz
end

# good
case foo
when baz
  foobar
when *condition
  bar
end

case foo
when 1, 2, 3, 4
  bar
when 5
  baz
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecasecmp"><a class="anchor" href="#performancecasecmp"></a>Performance/Casecmp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.21</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where a case-insensitive string comparison
can better be implemented using <code>casecmp</code>.</p>
</div>
<div class="paragraph">
<p>This cop is disabled by default because <code>String#casecmp</code> only works with
ASCII characters. See <a href="https://github.com/rubocop/rubocop/issues/9753" class="bare">https://github.com/rubocop/rubocop/issues/9753</a>.</p>
</div>
<div class="paragraph">
<p>If you are working only with ASCII characters, then this cop can be
safely enabled.</p>
</div>
<div class="sect2">
<h3 id="safety-4"><a class="anchor" href="#safety-4"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>String#casecmp</code> and <code>String#casecmp?</code> behave
differently when using Non-ASCII characters.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-8"><a class="anchor" href="#examples-8"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.downcase == 'abc'
str.upcase.eql? 'ABC'
'abc' == str.downcase
'ABC'.eql? str.upcase
str.downcase == str.downcase

# good
str.casecmp('ABC').zero?
'abc'.casecmp(str).zero?</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-2"><a class="anchor" href="#references-2"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringcasecmp-vs&#8212;&#8203;stringcasecmp-vs-stringdowncase---code" class="bare">https://github.com/fastruby/fast-ruby#stringcasecmp-vs&#8212;&#8203;stringcasecmp-vs-stringdowncase---code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancechainarrayallocation"><a class="anchor" href="#performancechainarrayallocation"></a>Performance/ChainArrayAllocation</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.59</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>array.compact.flatten.map { |x| x.downcase }</code>.
Each of these methods (<code>compact</code>, <code>flatten</code>, <code>map</code>) will generate a new intermediate array
that is promptly thrown away. Instead it is faster to mutate when we know it&#8217;s safe.</p>
</div>
<div class="sect2">
<h3 id="examples-9"><a class="anchor" href="#examples-9"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array = ["a", "b", "c"]
array.compact.flatten.map { |x| x.downcase }

# good
array = ["a", "b", "c"]
array.compact!
array.flatten!
array.map! { |x| x.downcase }
array</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-3"><a class="anchor" href="#references-3"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://twitter.com/schneems/status/1034123879978029057" class="bare">https://twitter.com/schneems/status/1034123879978029057</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecollectionliteralinloop"><a class="anchor" href="#performancecollectionliteralinloop"></a>Performance/CollectionLiteralInLoop</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where Array and Hash literals are used within loops.
It is better to extract them into a local variable or constant
to avoid unnecessary allocations on each iteration.</p>
</div>
<div class="paragraph">
<p>You can set the minimum number of elements to consider
an offense with <code>MinSize</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-10"><a class="anchor" href="#examples-10"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
users.select do |user|
  %i[superadmin admin].include?(user.role)
end

# good
admin_roles = %i[superadmin admin]
users.select do |user|
  admin_roles.include?(user.role)
end

# good
ADMIN_ROLES = %i[superadmin admin]
...
users.select do |user|
  ADMIN_ROLES.include?(user.role)
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes"><a class="anchor" href="#configurable-attributes"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MinSize</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecomparewithblock"><a class="anchor" href="#performancecomparewithblock"></a>Performance/CompareWithBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.46</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>sort { |a, b| a.foo &lt;&#8658; b.foo }</code>
can be replaced by <code>sort_by(&amp;:foo)</code>.
This cop also checks <code>sort!</code>, <code>min</code>, <code>max</code> and <code>minmax</code> methods.</p>
</div>
<div class="sect2">
<h3 id="examples-11"><a class="anchor" href="#examples-11"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array.sort   { |a, b| a.foo &lt;=&gt; b.foo }
array.sort!  { |a, b| a.foo &lt;=&gt; b.foo }
array.max    { |a, b| a.foo &lt;=&gt; b.foo }
array.min    { |a, b| a.foo &lt;=&gt; b.foo }
array.minmax { |a, b| a.foo &lt;=&gt; b.foo }
array.sort   { |a, b| a[:foo] &lt;=&gt; b[:foo] }

# good
array.sort_by(&amp;:foo)
array.sort_by!(&amp;:foo)
array.sort_by { |v| v.foo }
array.sort_by do |var|
  var.foo
end
array.max_by(&amp;:foo)
array.min_by(&amp;:foo)
array.minmax_by(&amp;:foo)
array.sort_by { |a| a[:foo] }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceconcurrentmonotonictime"><a class="anchor" href="#performanceconcurrentmonotonictime"></a>Performance/ConcurrentMonotonicTime</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>Concurrent.monotonic_time</code>
can be replaced by <code>Process.clock_gettime(Process::CLOCK_MONOTONIC)</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-12"><a class="anchor" href="#examples-12"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
Concurrent.monotonic_time

# good
Process.clock_gettime(Process::CLOCK_MONOTONIC)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-4"><a class="anchor" href="#references-4"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rails/rails/pull/43502" class="bare">https://github.com/rails/rails/pull/43502</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceconstantregexp"><a class="anchor" href="#performanceconstantregexp"></a>Performance/ConstantRegexp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Finds regular expressions with dynamic components that are all constants.</p>
</div>
<div class="paragraph">
<p>Ruby allocates a new Regexp object every time it executes a code containing such
a regular expression. It is more efficient to extract it into a constant,
memoize it, or add an <code>/o</code> option to perform <code>#{}</code> interpolation only once and
reuse that Regexp object.</p>
</div>
<div class="sect2">
<h3 id="examples-13"><a class="anchor" href="#examples-13"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def tokens(pattern)
  pattern.scan(TOKEN).reject { |token| token.match?(/\A#{SEPARATORS}\Z/) }
end

# good
ALL_SEPARATORS = /\A#{SEPARATORS}\Z/
def tokens(pattern)
  pattern.scan(TOKEN).reject { |token| token.match?(ALL_SEPARATORS) }
end

# good
def tokens(pattern)
  pattern.scan(TOKEN).reject { |token| token.match?(/\A#{SEPARATORS}\Z/o) }
end

# good
def separators
  @separators ||= /\A#{SEPARATORS}\Z/
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancecount"><a class="anchor" href="#performancecount"></a>Performance/Count</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.31</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>count</code> on an <code>Enumerable</code> that
follow calls to <code>select</code>, <code>find_all</code>, <code>filter</code> or <code>reject</code>. Querying logic can instead be
passed to the <code>count</code> call.</p>
</div>
<div class="sect2">
<h3 id="safety-5"><a class="anchor" href="#safety-5"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it has known compatibility issues with <code>ActiveRecord</code> and other
frameworks. Before Rails 5.1, <code>ActiveRecord</code> will ignore the block that is passed to <code>count</code>.
Other methods, such as <code>select</code>, will convert the association to an
array and then run the block on the array. A simple work around to
make <code>count</code> work with a block is to call <code>to_a.count {&#8230;&#8203;}</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">`Model.where(id: [1, 2, 3]).select { |m| m.method == true }.size`</code></pre>
</div>
</div>
<div class="paragraph">
<p>becomes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">`Model.where(id: [1, 2, 3]).to_a.count { |m| m.method == true }`</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-14"><a class="anchor" href="#examples-14"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3].select { |e| e &gt; 2 }.size
[1, 2, 3].reject { |e| e &gt; 2 }.size
[1, 2, 3].select { |e| e &gt; 2 }.length
[1, 2, 3].reject { |e| e &gt; 2 }.length
[1, 2, 3].select { |e| e &gt; 2 }.count { |e| e.odd? }
[1, 2, 3].reject { |e| e &gt; 2 }.count { |e| e.even? }
array.select(&amp;:value).count

# good
[1, 2, 3].count { |e| e &gt; 2 }
[1, 2, 3].count { |e| e &lt; 2 }
[1, 2, 3].count { |e| e &gt; 2 &amp;&amp; e.odd? }
[1, 2, 3].count { |e| e &lt; 2 &amp;&amp; e.even? }
Model.select('field AS field_one').count
Model.select(:value).count</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedeleteprefix"><a class="anchor" href="#performancedeleteprefix"></a>Performance/DeletePrefix</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.5
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.5, <code>String#delete_prefix</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>gsub(/\Aprefix/, '')</code> and <code>sub(/\Aprefix/, '')</code>
can be replaced by <code>delete_prefix('prefix')</code>.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>^prefix</code> is unsafe as it will behave incompatible with <code>delete_prefix</code>
for receiver is multiline string.</p>
</div>
<div class="paragraph">
<p>The <code>delete_prefix('prefix')</code> method is faster than <code>gsub(/\Aprefix/, '')</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-6"><a class="anchor" href="#safety-6"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>Pathname</code> has <code>sub</code> but not <code>delete_prefix</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-15"><a class="anchor" href="#examples-15"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.gsub(/\Aprefix/, '')
str.gsub!(/\Aprefix/, '')

str.sub(/\Aprefix/, '')
str.sub!(/\Aprefix/, '')

# good
str.delete_prefix('prefix')
str.delete_prefix!('prefix')</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-true-default"><a class="anchor" href="#safemultiline-true-default"></a>SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
str.gsub(/^prefix/, '')
str.gsub!(/^prefix/, '')
str.sub(/^prefix/, '')
str.sub!(/^prefix/, '')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-false"><a class="anchor" href="#safemultiline-false"></a>SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.gsub(/^prefix/, '')
str.gsub!(/^prefix/, '')
str.sub(/^prefix/, '')
str.sub!(/^prefix/, '')</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-2"><a class="anchor" href="#configurable-attributes-2"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedeletesuffix"><a class="anchor" href="#performancedeletesuffix"></a>Performance/DeleteSuffix</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.5
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.5, <code>String#delete_suffix</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>gsub(/suffix\z/, '')</code> and <code>sub(/suffix\z/, '')</code>
can be replaced by <code>delete_suffix('suffix')</code>.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>suffix$</code> is unsafe as it will behave incompatible with <code>delete_suffix?</code>
for receiver is multiline string.</p>
</div>
<div class="paragraph">
<p>The <code>delete_suffix('suffix')</code> method is faster than <code>gsub(/suffix\z/, '')</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-7"><a class="anchor" href="#safety-7"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>Pathname</code> has <code>sub</code> but not <code>delete_suffix</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-16"><a class="anchor" href="#examples-16"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.gsub(/suffix\z/, '')
str.gsub!(/suffix\z/, '')

str.sub(/suffix\z/, '')
str.sub!(/suffix\z/, '')

# good
str.delete_suffix('suffix')
str.delete_suffix!('suffix')</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-true-default-2"><a class="anchor" href="#safemultiline-true-default-2"></a>SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
str.gsub(/suffix$/, '')
str.gsub!(/suffix$/, '')
str.sub(/suffix$/, '')
str.sub!(/suffix$/, '')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-false-2"><a class="anchor" href="#safemultiline-false-2"></a>SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.gsub(/suffix$/, '')
str.gsub!(/suffix$/, '')
str.sub(/suffix$/, '')
str.sub!(/suffix$/, '')</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-3"><a class="anchor" href="#configurable-attributes-3"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedetect"><a class="anchor" href="#performancedetect"></a>Performance/Detect</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>first</code>, <code>last</code>, <code>[0]</code> or <code>[-1]</code>
chained to <code>select</code>, <code>find_all</code> or <code>filter</code> and change them to use
<code>detect</code> instead.</p>
</div>
<div class="sect2">
<h3 id="safety-8"><a class="anchor" href="#safety-8"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it assumes that the receiver is an
<code>Array</code> or equivalent, but can&#8217;t reliably detect it. For example,
if the receiver is a <code>Hash</code>, it may report a false positive.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-17"><a class="anchor" href="#examples-17"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[].select { |item| true }.first
[].select { |item| true }.last
[].find_all { |item| true }.first
[].find_all { |item| true }.last
[].filter { |item| true }.first
[].filter { |item| true }.last
[].filter { |item| true }[0]
[].filter { |item| true }[-1]

# good
[].detect { |item| true }
[].reverse.detect { |item| true }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-5"><a class="anchor" href="#references-5"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#enumerabledetect-vs-enumerableselectfirst-code" class="bare">https://github.com/fastruby/fast-ruby#enumerabledetect-vs-enumerableselectfirst-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancedoublestartendwith"><a class="anchor" href="#performancedoublestartendwith"></a>Performance/DoubleStartEndWith</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.48</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for double <code>#start_with?</code> or <code>#end_with?</code> calls
separated by <code>||</code>. In some cases such calls can be replaced
with an single <code>#start_with?</code>/<code>#end_with?</code> call.</p>
</div>
<div class="paragraph">
<p><code>IncludeActiveSupportAliases</code> configuration option is used to check for
<code>starts_with?</code> and <code>ends_with?</code>. These methods are defined by Active Support.</p>
</div>
<div class="sect2">
<h3 id="examples-18"><a class="anchor" href="#examples-18"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.start_with?("a") || str.start_with?(Some::CONST)
str.start_with?("a", "b") || str.start_with?("c")
str.end_with?(var1) || str.end_with?(var2)

# good
str.start_with?("a", Some::CONST)
str.start_with?("a", "b", "c")
str.end_with?(var1, var2)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="includeactivesupportaliases-false-default"><a class="anchor" href="#includeactivesupportaliases-false-default"></a>IncludeActiveSupportAliases: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
str.starts_with?("a", "b") || str.starts_with?("c")
str.ends_with?(var1) || str.ends_with?(var2)

str.starts_with?("a", "b", "c")
str.ends_with?(var1, var2)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="includeactivesupportaliases-true"><a class="anchor" href="#includeactivesupportaliases-true"></a>IncludeActiveSupportAliases: true</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.starts_with?("a", "b") || str.starts_with?("c")
str.ends_with?(var1) || str.ends_with?(var2)

# good
str.starts_with?("a", "b", "c")
str.ends_with?(var1, var2)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-4"><a class="anchor" href="#configurable-attributes-4"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludeActiveSupportAliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceendwith"><a class="anchor" href="#performanceendwith"></a>Performance/EndWith</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a regex where <code>String#end_with?</code> would suffice.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>end$</code> is unsafe as it will behave incompatible with <code>end_with?</code>
for receiver is multiline string.</p>
</div>
<div class="sect2">
<h3 id="safety-9"><a class="anchor" href="#safety-9"></a>Safety</h3>
<div class="paragraph">
<p>This will change to a new method call which isn&#8217;t guaranteed to be on the
object. Switching these methods has to be done with knowledge of the types
of the variables which rubocop doesn&#8217;t have.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-19"><a class="anchor" href="#examples-19"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
'abc'.match?(/bc\Z/)
/bc\Z/.match?('abc')
'abc' =~ /bc\Z/
/bc\Z/ =~ 'abc'
'abc'.match(/bc\Z/)
/bc\Z/.match('abc')

# good
'abc'.end_with?('bc')</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-true-default-3"><a class="anchor" href="#safemultiline-true-default-3"></a>SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
'abc'.match?(/bc$/)
/bc$/.match?('abc')
'abc' =~ /bc$/
/bc$/ =~ 'abc'
'abc'.match(/bc$/)
/bc$/.match('abc')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-false-3"><a class="anchor" href="#safemultiline-false-3"></a>SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
'abc'.match?(/bc$/)
/bc$/.match?('abc')
'abc' =~ /bc$/
/bc$/ =~ 'abc'
'abc'.match(/bc$/)
/bc$/.match('abc')</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-5"><a class="anchor" href="#configurable-attributes-5"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-6"><a class="anchor" href="#references-6"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end" class="bare">https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancefixedsize"><a class="anchor" href="#performancefixedsize"></a>Performance/FixedSize</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.35</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Do not compute the size of statically sized objects.</p>
</div>
<div class="sect2">
<h3 id="examples-20"><a class="anchor" href="#examples-20"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># String methods
# bad
'foo'.size
%q[bar].count
%(qux).length

# Symbol methods
# bad
:fred.size
:'baz'.length

# Array methods
# bad
[1, 2, thud].count
%W(1, 2, bar).size

# Hash methods
# bad
{ a: corge, b: grault }.length

# good
foo.size
bar.count
qux.length

# good
:"#{fred}".size
CONST = :baz.length

# good
[1, 2, *thud].count
garply = [1, 2, 3]
garply.size

# good
{ a: corge, **grault }.length
waldo = { a: corge, b: grault }
waldo.size</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceflatmap"><a class="anchor" href="#performanceflatmap"></a>Performance/FlatMap</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>map { &#8230;&#8203; }.flatten</code> and
change them to use <code>flat_map { &#8230;&#8203; }</code> instead.</p>
</div>
<div class="sect2">
<h3 id="examples-21"><a class="anchor" href="#examples-21"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3, 4].map { |e| [e, e] }.flatten(1)
[1, 2, 3, 4].collect { |e| [e, e] }.flatten(1)

# good
[1, 2, 3, 4].flat_map { |e| [e, e] }
[1, 2, 3, 4].map { |e| [e, e] }.flatten
[1, 2, 3, 4].collect { |e| [e, e] }.flatten</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-6"><a class="anchor" href="#configurable-attributes-6"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EnabledForFlattenWithoutParams</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-7"><a class="anchor" href="#references-7"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#enumerablemaparrayflatten-vs-enumerableflat_map-code" class="bare">https://github.com/fastruby/fast-ruby#enumerablemaparrayflatten-vs-enumerableflat_map-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceinefficienthashsearch"><a class="anchor" href="#performanceinefficienthashsearch"></a>Performance/InefficientHashSearch</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for inefficient searching of keys and values within
hashes.</p>
</div>
<div class="paragraph">
<p><code>Hash#keys.include?</code> is less efficient than <code>Hash#key?</code> because
the former allocates a new array and then performs an O(n) search
through that array, while <code>Hash#key?</code> does not allocate any array and
performs a faster O(1) search for the key.</p>
</div>
<div class="paragraph">
<p><code>Hash#values.include?</code> is less efficient than <code>Hash#value?</code>. While they
both perform an O(n) search through all of the values, calling <code>values</code>
allocates a new array while using <code>value?</code> does not.</p>
</div>
<div class="sect2">
<h3 id="safety-10"><a class="anchor" href="#safety-10"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because it can&#8217;t tell whether the receiver is a hash object.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-22"><a class="anchor" href="#examples-22"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
{ a: 1, b: 2 }.keys.include?(:a)
{ a: 1, b: 2 }.keys.include?(:z)
h = { a: 1, b: 2 }; h.keys.include?(100)

# good
{ a: 1, b: 2 }.key?(:a)
{ a: 1, b: 2 }.has_key?(:z)
h = { a: 1, b: 2 }; h.key?(100)

# bad
{ a: 1, b: 2 }.values.include?(2)
{ a: 1, b: 2 }.values.include?('garbage')
h = { a: 1, b: 2 }; h.values.include?(nil)

# good
{ a: 1, b: 2 }.value?(2)
{ a: 1, b: 2 }.has_value?('garbage')
h = { a: 1, b: 2 }; h.value?(nil)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-8"><a class="anchor" href="#references-8"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#hashkey-instead-of-hashkeysinclude-code" class="bare">https://github.com/fastruby/fast-ruby#hashkey-instead-of-hashkeysinclude-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceioreadlines"><a class="anchor" href="#performanceioreadlines"></a>Performance/IoReadlines</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where inefficient <code>readlines</code> method
can be replaced by <code>each_line</code> to avoid fully loading file content into memory.</p>
</div>
<div class="sect2">
<h3 id="examples-23"><a class="anchor" href="#examples-23"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
File.readlines('testfile').each { |l| puts l }
IO.readlines('testfile', chomp: true).each { |l| puts l }

conn.readlines(10).map { |l| l.size }
file.readlines.find { |l| l.start_with?('#') }
file.readlines.each { |l| puts l }

# good
File.open('testfile', 'r').each_line { |l| puts l }
IO.open('testfile').each_line(chomp: true) { |l| puts l }

conn.each_line(10).map { |l| l.size }
file.each_line.find { |l| l.start_with?('#') }
file.each_line { |l| puts l }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-9"><a class="anchor" href="#references-9"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.gitlab.com/ee/development/performance.html#reading-from-files-and-other-data-sources" class="bare">https://docs.gitlab.com/ee/development/performance.html#reading-from-files-and-other-data-sources</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancemapcompact"><a class="anchor" href="#performancemapcompact"></a>Performance/MapCompact</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.7, <code>Enumerable#filter_map</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>map { &#8230;&#8203; }.compact</code> can be replaced by <code>filter_map</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">[true, false, nil].compact              #=&gt; [true, false]
[true, false, nil].filter_map(&amp;:itself) #=&gt; [true]</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-11"><a class="anchor" href="#safety-11"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because <code>map { &#8230;&#8203; }.compact</code> might yield
different results than <code>filter_map</code>. As illustrated in the example, <code>filter_map</code>
also filters out falsy values, while <code>compact</code> only gets rid of <code>nil</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-24"><a class="anchor" href="#examples-24"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
ary.map(&amp;:foo).compact
ary.collect(&amp;:foo).compact

# good
ary.filter_map(&amp;:foo)
ary.map(&amp;:foo).compact!
ary.compact.map(&amp;:foo)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancemapmethodchain"><a class="anchor" href="#performancemapmethodchain"></a>Performance/MapMethodChain</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.19</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks if the map method is used in a chain.</p>
</div>
<div class="paragraph">
<p>Autocorrection is not supported because an appropriate block variable name cannot be determined automatically.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">class X
  def initialize
    @@num = 0
  end

  def foo
    @@num += 1
    self
  end

  def bar
    @@num * 2
  end
end

[X.new, X.new].map(&amp;:foo).map(&amp;:bar) # =&gt; [4, 4]
[X.new, X.new].map { |x| x.foo.bar } # =&gt; [2, 4]</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-12"><a class="anchor" href="#safety-12"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because false positives occur if the number of times the first method is executed
affects the return value of subsequent methods.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-25"><a class="anchor" href="#examples-25"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array.map(&amp;:foo).map(&amp;:bar)

# good
array.map { |item| item.foo.bar }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancemethodobjectasblock"><a class="anchor" href="#performancemethodobjectasblock"></a>Performance/MethodObjectAsBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where methods are converted to blocks, with the
use of <code>&amp;method</code>, and passed as arguments to method calls.
It is faster to replace those with explicit blocks, calling those methods inside.</p>
</div>
<div class="sect2">
<h3 id="examples-26"><a class="anchor" href="#examples-26"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array.map(&amp;method(:do_something))
[1, 2, 3].each(&amp;out.method(:puts))

# good
array.map { |x| do_something(x) }
[1, 2, 3].each { |x| out.puts(x) }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-10"><a class="anchor" href="#references-10"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#normal-way-to-apply-method-vs-method-code" class="bare">https://github.com/fastruby/fast-ruby#normal-way-to-apply-method-vs-method-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceopenstruct"><a class="anchor" href="#performanceopenstruct"></a>Performance/OpenStruct</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for <code>OpenStruct.new</code> calls.
Instantiation of an <code>OpenStruct</code> invalidates
Ruby global method cache as it causes dynamic method
definition during program runtime.
This could have an effect on performance,
especially in case of single-threaded
applications with multiple <code>OpenStruct</code> instantiations.</p>
</div>
<div class="sect2">
<h3 id="safety-13"><a class="anchor" href="#safety-13"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>OpenStruct.new</code> and <code>Struct.new</code>
are not equivalent.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-27"><a class="anchor" href="#examples-27"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
class MyClass
  def my_method
    OpenStruct.new(my_key1: 'my_value1', my_key2: 'my_value2')
  end
end

# good
class MyClass
  MyStruct = Struct.new(:my_key1, :my_key2)
  def my_method
    MyStruct.new('my_value1', 'my_value2')
  end
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancerangeinclude"><a class="anchor" href="#performancerangeinclude"></a>Performance/RangeInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies uses of <code>Range#include?</code> and <code>Range#member?</code>, which iterates over each
item in a <code>Range</code> to see if a specified item is there. In contrast,
<code>Range#cover?</code> simply compares the target item with the beginning and
end points of the <code>Range</code>. In a great majority of cases, this is what
is wanted.</p>
</div>
<div class="sect2">
<h3 id="safety-14"><a class="anchor" href="#safety-14"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>Range#include?</code> (or <code>Range#member?</code>) and <code>Range#cover?</code>
are not equivalent behavior.
Example of a case where <code>Range#cover?</code> may not provide the desired result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">('a'..'z').cover?('yellow') # =&gt; true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-28"><a class="anchor" href="#examples-28"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
('a'..'z').include?('b') # =&gt; true
('a'..'z').member?('b')  # =&gt; true

# good
('a'..'z').cover?('b') # =&gt; true</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-11"><a class="anchor" href="#references-11"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#cover-vs-include-code" class="bare">https://github.com/fastruby/fast-ruby#cover-vs-include-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantblockcall"><a class="anchor" href="#performanceredundantblockcall"></a>Performance/RedundantBlockCall</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies the use of a <code>&amp;block</code> parameter and <code>block.call</code>
where <code>yield</code> would do just as well.</p>
</div>
<div class="sect2">
<h3 id="examples-29"><a class="anchor" href="#examples-29"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def method(&amp;block)
  block.call
end
def another(&amp;func)
  func.call 1, 2, 3
end

# good
def method
  yield
end
def another
  yield 1, 2, 3
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-12"><a class="anchor" href="#references-12"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#proccall-and-block-arguments-vs-yieldcode" class="bare">https://github.com/fastruby/fast-ruby#proccall-and-block-arguments-vs-yieldcode</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantequalitycomparisonblock"><a class="anchor" href="#performanceredundantequalitycomparisonblock"></a>Performance/RedundantEqualityComparisonBlock</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.5
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for uses <code>Enumerable#all?</code>, <code>Enumerable#any?</code>, <code>Enumerable#one?</code>,
and <code>Enumerable#none?</code> are compared with <code>===</code> or similar methods in block.</p>
</div>
<div class="paragraph">
<p>By default, <code>Object#===</code> behaves the same as <code>Object#==</code>, but this
behavior is appropriately overridden in subclass. For example,
<code>Range#===</code> returns <code>true</code> when argument is within the range.</p>
</div>
<div class="paragraph">
<p>This cop has <code>AllowRegexpMatch</code> option and it is true by default because
<code>regexp.match?('string')</code> often used in block changes to the opposite result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">[/pattern/].all? { |regexp| regexp.match?('pattern') } # =&gt; true
[/pattern/].all? { |regexp| regexp =~ 'pattern' }      # =&gt; true
[/pattern/].all?('pattern')                            # =&gt; false</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="safety-15"><a class="anchor" href="#safety-15"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because <code>===</code> and <code>==</code> do not always behave the same.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-30"><a class="anchor" href="#examples-30"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
items.all? { |item| pattern === item }
items.all? { |item| item == other }
items.all? { |item| item.is_a?(Klass) }
items.all? { |item| item.kind_of?(Klass) }

# good
items.all?(pattern)
items.all?(Klass)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="allowregexpmatch-true-default"><a class="anchor" href="#allowregexpmatch-true-default"></a>AllowRegexpMatch: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
items.all? { |item| item =~ pattern }
items.all? { |item| item.match?(pattern) }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="allowregexpmatch-false"><a class="anchor" href="#allowregexpmatch-false"></a>AllowRegexpMatch: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
items.all? { |item| item =~ pattern }
items.all? { |item| item.match?(pattern) }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-7"><a class="anchor" href="#configurable-attributes-7"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AllowRegexpMatch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-13"><a class="anchor" href="#references-13"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/rails/rails/pull/41363" class="bare">https://github.com/rails/rails/pull/41363</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantmatch"><a class="anchor" href="#performanceredundantmatch"></a>Performance/RedundantMatch</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies the use of <code>Regexp#match</code> or <code>String#match</code>, which
returns <code>#&lt;MatchData&gt;</code>/<code>nil</code>. The return value of <code>=~</code> is an integral
index/<code>nil</code> and is more performant.</p>
</div>
<div class="sect2">
<h3 id="examples-31"><a class="anchor" href="#examples-31"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
do_something if str.match(/regex/)
while regex.match('str')
  do_something
end

# good
method(str =~ /regex/)
return value unless regex =~ 'str'</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantmerge"><a class="anchor" href="#performanceredundantmerge"></a>Performance/RedundantMerge</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>Hash#merge!</code> can be replaced by <code>Hash#[]=</code>.
You can set the maximum number of key-value pairs to consider
an offense with <code>MaxKeyValuePairs</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-16"><a class="anchor" href="#safety-16"></a>Safety</h3>
<div class="paragraph">
<p>This cop is unsafe because RuboCop cannot determine if the
receiver of <code>merge!</code> is actually a hash or not.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-32"><a class="anchor" href="#examples-32"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
hash.merge!(a: 1)
hash.merge!({'key' =&gt; 'value'})

# good
hash[:a] = 1
hash['key'] = 'value'</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="maxkeyvaluepairs-2-default"><a class="anchor" href="#maxkeyvaluepairs-2-default"></a>MaxKeyValuePairs: 2 (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
hash.merge!(a: 1, b: 2)

# good
hash[:a] = 1
hash[:b] = 2</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-8"><a class="anchor" href="#configurable-attributes-8"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MaxKeyValuePairs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-14"><a class="anchor" href="#references-14"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#hashmerge-vs-hash-code" class="bare">https://github.com/fastruby/fast-ruby#hashmerge-vs-hash-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantsortblock"><a class="anchor" href="#performanceredundantsortblock"></a>Performance/RedundantSortBlock</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>sort { |a, b| a &lt;&#8658; b }</code> can be replaced with <code>sort</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-33"><a class="anchor" href="#examples-33"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array.sort { |a, b| a &lt;=&gt; b }

# good
array.sort</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantsplitregexpargument"><a class="anchor" href="#performanceredundantsplitregexpargument"></a>Performance/RedundantSplitRegexpArgument</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>split</code> argument can be replaced from
a deterministic regexp to a string.</p>
</div>
<div class="sect2">
<h3 id="examples-34"><a class="anchor" href="#examples-34"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
'a,b,c'.split(/,/)

# good
'a,b,c'.split(',')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceredundantstringchars"><a class="anchor" href="#performanceredundantstringchars"></a>Performance/RedundantStringChars</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for redundant <code>String#chars</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-35"><a class="anchor" href="#examples-35"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.chars[0..2]
str.chars.slice(0..2)
str.chars.last

# good
str[0..2].chars

# bad
str.chars.first
str.chars.first(2)

# good
str[0]
str[0...2].chars
str[-1]

# bad
str.chars.take(2)
str.chars.length
str.chars.size
str.chars.empty?

# good
str[0...2].chars
str.length
str.size
str.empty?

# For example, if the receiver is an empty string, it will be incompatible.
# If a negative value is specified for the receiver, `nil` is returned.
str.chars.last(2) # Incompatible with `str[-2..-1].chars`.
str.chars.drop(2) # Incompatible with `str[2..-1].chars`.</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceregexpmatch"><a class="anchor" href="#performanceregexpmatch"></a>Performance/RegexpMatch</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.4
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.47</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.4, <code>String#match?</code>, <code>Regexp#match?</code>, and <code>Symbol#match?</code>
have been added. The methods are faster than <code>match</code>.
Because the methods avoid creating a <code>MatchData</code> object or saving
backref.
So, when <code>MatchData</code> is not used, use <code>match?</code> instead of <code>match</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-36"><a class="anchor" href="#examples-36"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
def foo
  if x =~ /re/
    do_something
  end
end

# bad
def foo
  if x !~ /re/
    do_something
  end
end

# bad
def foo
  if x.match(/re/)
    do_something
  end
end

# bad
def foo
  if /re/ === x
    do_something
  end
end

# good
def foo
  if x.match?(/re/)
    do_something
  end
end

# good
def foo
  if !x.match?(/re/)
    do_something
  end
end

# good
def foo
  if x =~ /re/
    do_something(Regexp.last_match)
  end
end

# good
def foo
  if x.match(/re/)
    do_something($~)
  end
end

# good
def foo
  if /re/ === x
    do_something($~)
  end
end</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-15"><a class="anchor" href="#references-15"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#regexp-vs-regexpmatch-vs-regexpmatch-vs-stringmatch-vs-string-vs-stringmatch-code-" class="bare">https://github.com/fastruby/fast-ruby#regexp-vs-regexpmatch-vs-regexpmatch-vs-stringmatch-vs-string-vs-stringmatch-code-</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancereverseeach"><a class="anchor" href="#performancereverseeach"></a>Performance/ReverseEach</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>reverse.each</code> and change them to use <code>reverse_each</code> instead.</p>
</div>
<div class="paragraph">
<p>If the return value is used, it will not be detected because the result will be different.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">[1, 2, 3].reverse.each {} #=&gt; [3, 2, 1]
[1, 2, 3].reverse_each {} #=&gt; [1, 2, 3]</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="examples-37"><a class="anchor" href="#examples-37"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
items.reverse.each

# good
items.reverse_each</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-16"><a class="anchor" href="#references-16"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#enumerablereverseeach-vs-enumerablereverse_each-code" class="bare">https://github.com/fastruby/fast-ruby#enumerablereverseeach-vs-enumerablereverse_each-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancereversefirst"><a class="anchor" href="#performancereversefirst"></a>Performance/ReverseFirst</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>reverse.first(n)</code> and <code>reverse.first</code>
can be replaced by <code>last(n).reverse</code> and <code>last</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-38"><a class="anchor" href="#examples-38"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array.reverse.first(5)
array.reverse.first

# good
array.last(5).reverse
array.last</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceselectmap"><a class="anchor" href="#performanceselectmap"></a>Performance/SelectMap</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.7
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.7, <code>Enumerable#filter_map</code> has been added.</p>
</div>
<div class="paragraph">
<p>This cop identifies places where <code>select.map</code> can be replaced by <code>filter_map</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-39"><a class="anchor" href="#examples-39"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
ary.select(&amp;:foo).map(&amp;:bar)
ary.filter(&amp;:foo).map(&amp;:bar)

# good
ary.filter_map { |o| o.bar if o.foo }</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesize"><a class="anchor" href="#performancesize"></a>Performance/Size</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.30</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies usages of <code>count</code> on an <code>Array</code> and <code>Hash</code> and change them to <code>size</code>.</p>
</div>
<div class="paragraph">
<p>TODO: Add advanced detection of variables that could
have been assigned to an array or a hash.</p>
</div>
<div class="sect2">
<h3 id="examples-40"><a class="anchor" href="#examples-40"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3].count
(1..3).to_a.count
Array[*1..3].count
Array(1..3).count

# bad
{a: 1, b: 2, c: 3}.count
[[:foo, :bar], [1, 2]].to_h.count
Hash[*('a'..'z')].count
Hash(key: :value).count

# good
[1, 2, 3].size
(1..3).to_a.size
Array[*1..3].size
Array(1..3).size

# good
{a: 1, b: 2, c: 3}.size
[[:foo, :bar], [1, 2]].to_h.size
Hash[*('a'..'z')].size
Hash(key: :value).size

# good
[1, 2, 3].count { |e| e &gt; 2 }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-17"><a class="anchor" href="#references-17"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#arraylength-vs-arraysize-vs-arraycount-code" class="bare">https://github.com/fastruby/fast-ruby#arraylength-vs-arraysize-vs-arraycount-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesortreverse"><a class="anchor" href="#performancesortreverse"></a>Performance/SortReverse</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>sort { |a, b| b &lt;&#8658; a }</code>
can be replaced by a faster <code>sort.reverse</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-41"><a class="anchor" href="#examples-41"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
array.sort { |a, b| b &lt;=&gt; a }

# good
array.sort.reverse</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesqueeze"><a class="anchor" href="#performancesqueeze"></a>Performance/Squeeze</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>gsub(/a+/, 'a')</code> and <code>gsub!(/a+/, 'a')</code>
can be replaced by <code>squeeze('a')</code> and <code>squeeze!('a')</code>.</p>
</div>
<div class="paragraph">
<p>The <code>squeeze('a')</code> method is faster than <code>gsub(/a+/, 'a')</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-42"><a class="anchor" href="#examples-42"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.gsub(/a+/, 'a')
str.gsub!(/a+/, 'a')

# good
str.squeeze('a')
str.squeeze!('a')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-18"><a class="anchor" href="#references-18"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#remove-extra-spaces-or-other-contiguous-characters-code" class="bare">https://github.com/fastruby/fast-ruby#remove-extra-spaces-or-other-contiguous-characters-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestartwith"><a class="anchor" href="#performancestartwith"></a>Performance/StartWith</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.10</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a regex where <code>String#start_with?</code> would suffice.</p>
</div>
<div class="paragraph">
<p>This cop has <code>SafeMultiline</code> configuration option that <code>true</code> by default because
<code>^start</code> is unsafe as it will behave incompatible with <code>start_with?</code>
for receiver is multiline string.</p>
</div>
<div class="sect2">
<h3 id="safety-17"><a class="anchor" href="#safety-17"></a>Safety</h3>
<div class="paragraph">
<p>This will change to a new method call which isn&#8217;t guaranteed to be on the
object. Switching these methods has to be done with knowledge of the types
of the variables which rubocop doesn&#8217;t have.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-43"><a class="anchor" href="#examples-43"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
'abc'.match?(/\Aab/)
/\Aab/.match?('abc')
'abc' =~ /\Aab/
/\Aab/ =~ 'abc'
'abc'.match(/\Aab/)
/\Aab/.match('abc')

# good
'abc'.start_with?('ab')</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-true-default-4"><a class="anchor" href="#safemultiline-true-default-4"></a>SafeMultiline: true (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># good
'abc'.match?(/^ab/)
/^ab/.match?('abc')
'abc' =~ /^ab/
/^ab/ =~ 'abc'
'abc'.match(/^ab/)
/^ab/.match('abc')</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="safemultiline-false-4"><a class="anchor" href="#safemultiline-false-4"></a>SafeMultiline: false</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
'abc'.match?(/^ab/)
/^ab/.match?('abc')
'abc' =~ /^ab/
/^ab/ =~ 'abc'
'abc'.match(/^ab/)
/^ab/.match('abc')</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-9"><a class="anchor" href="#configurable-attributes-9"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SafeMultiline</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-19"><a class="anchor" href="#references-19"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end" class="bare">https://github.com/fastruby/fast-ruby#stringmatch-vs-stringmatch-vs-stringstart_withstringend_with-code-start-code-end</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringidentifierargument"><a class="anchor" href="#performancestringidentifierargument"></a>Performance/StringIdentifierArgument</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where string identifier argument can be replaced
by symbol identifier argument.
It prevents the redundancy of the internal string-to-symbol conversion.</p>
</div>
<div class="paragraph">
<p>This cop targets methods that take identifier (e.g. method name) argument
and the following examples are parts of it.</p>
</div>
<div class="sect2">
<h3 id="examples-44"><a class="anchor" href="#examples-44"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
send('do_something')
attr_accessor 'do_something'
instance_variable_get('@ivar')
respond_to?("string_#{interpolation}")

# good
send(:do_something)
attr_accessor :do_something
instance_variable_get(:@ivar)
respond_to?(:"string_#{interpolation}")

# good - these methods don't support namespaced symbols
const_get("#{module_path}::Base")
const_source_location("#{module_path}::Base")
const_defined?("#{module_path}::Base")</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringinclude"><a class="anchor" href="#performancestringinclude"></a>Performance/StringInclude</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.12</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies unnecessary use of a regex where <code>String#include?</code> would suffice.</p>
</div>
<div class="sect2">
<h3 id="safety-18"><a class="anchor" href="#safety-18"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s offenses are not safe to autocorrect if a receiver is nil or a Symbol.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-45"><a class="anchor" href="#examples-45"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
str.match?(/ab/)
/ab/.match?(str)
str =~ /ab/
/ab/ =~ str
str.match(/ab/)
/ab/.match(str)
/ab/ === str

# good
str.include?('ab')</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancestringreplacement"><a class="anchor" href="#performancestringreplacement"></a>Performance/StringReplacement</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.33</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>gsub</code> can be replaced by <code>tr</code> or <code>delete</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-46"><a class="anchor" href="#examples-46"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
'abc'.gsub('b', 'd')
'abc'.gsub('a', '')
'abc'.gsub(/a/, 'd')
'abc'.gsub!('a', 'd')

# good
'abc'.gsub(/.*/, 'a')
'abc'.gsub(/a+/, 'd')
'abc'.tr('b', 'd')
'a b c'.delete(' ')</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="references-20"><a class="anchor" href="#references-20"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/fastruby/fast-ruby#stringgsub-vs-stringtr-code" class="bare">https://github.com/fastruby/fast-ruby#stringgsub-vs-stringtr-code</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancesum"><a class="anchor" href="#performancesum"></a>Performance/Sum</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.4
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where custom code finding the sum of elements
in some Enumerable object can be replaced by <code>Enumerable#sum</code> method.</p>
</div>
<div class="sect2">
<h3 id="safety-19"><a class="anchor" href="#safety-19"></a>Safety</h3>
<div class="paragraph">
<p>Autocorrections are unproblematic wherever an initial value is provided explicitly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">[1, 2, 3].reduce(4, :+) # =&gt; 10
[1, 2, 3].sum(4) # =&gt; 10

[].reduce(4, :+) # =&gt; 4
[].sum(4) # =&gt; 4</code></pre>
</div>
</div>
<div class="paragraph">
<p>This also holds true for non-numeric types which implement a <code>:+</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">['l', 'o'].reduce('Hel', :+) # =&gt; "Hello"
['l', 'o'].sum('Hel') # =&gt; "Hello"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When no initial value is provided though, <code>Enumerable#reduce</code> will pick the first enumerated value
as initial value and successively add all following values to it, whereas
<code>Enumerable#sum</code> will set an initial value of <code>0</code> (<code>Integer</code>) which can lead to a <code>TypeError</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">[].reduce(:+) # =&gt; nil
[1, 2, 3].reduce(:+) # =&gt; 6
['H', 'e', 'l', 'l', 'o'].reduce(:+) # =&gt; "Hello"

[].sum # =&gt; 0
[1, 2, 3].sum # =&gt; 6
['H', 'e', 'l', 'l', 'o'].sum # =&gt; in `+': String can't be coerced into Integer (TypeError)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-47"><a class="anchor" href="#examples-47"></a>Examples</h3>
<div class="sect3">
<h4 id="onlysumorwithinitialvalue-false-default"><a class="anchor" href="#onlysumorwithinitialvalue-false-default"></a>OnlySumOrWithInitialValue: false (default)</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3].inject(:+)                        # Autocorrections for cases without initial value are unsafe
[1, 2, 3].inject(&amp;:+)                       # and will only be performed when using the `-A` option.
[1, 2, 3].reduce { |acc, elem| acc + elem } # They can be prohibited completely using `SafeAutoCorrect: true`.
[1, 2, 3].reduce(10, :+)
[1, 2, 3].map { |elem| elem ** 2 }.sum
[1, 2, 3].collect(&amp;:count).sum(10)

# good
[1, 2, 3].sum
[1, 2, 3].sum(10)
[1, 2, 3].sum { |elem| elem ** 2 }
[1, 2, 3].sum(10, &amp;:count)</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="onlysumorwithinitialvalue-true"><a class="anchor" href="#onlysumorwithinitialvalue-true"></a>OnlySumOrWithInitialValue: true</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
[1, 2, 3].reduce(10, :+)
[1, 2, 3].map { |elem| elem ** 2 }.sum
[1, 2, 3].collect(&amp;:count).sum(10)

# good
[1, 2, 3].sum(10)
[1, 2, 3].sum { |elem| elem ** 2 }
[1, 2, 3].sum(10, &amp;:count)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configurable-attributes-10"><a class="anchor" href="#configurable-attributes-10"></a>Configurable attributes</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Configurable values</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OnlySumOrWithInitialValue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="references-21"><a class="anchor" href="#references-21"></a>References</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://blog.bigbinary.com/2016/11/02/ruby-2-4-introduces-enumerable-sum.html" class="bare">https://blog.bigbinary.com/2016/11/02/ruby-2-4-introduces-enumerable-sum.html</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performancetimesmap"><a class="anchor" href="#performancetimesmap"></a>Performance/TimesMap</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.36</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.13</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Checks for .times.map calls.
In most cases such calls can be replaced
with an explicit array creation.</p>
</div>
<div class="sect2">
<h3 id="safety-20"><a class="anchor" href="#safety-20"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because <code>Integer#times</code> does nothing if receiver is 0
or less. However, <code>Array.new</code> raises an error if argument is less than 0.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby">-1.times{}    # does nothing
Array.new(-1) # ArgumentError: negative array size</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="examples-48"><a class="anchor" href="#examples-48"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
9.times.map do |i|
  i.to_s
end

# good
Array.new(9) do |i|
  i.to_s
end</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceunfreezestring"><a class="anchor" href="#performanceunfreezestring"></a>Performance/UnfreezeString</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Required Ruby version: 2.3
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always (Unsafe)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.9</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In Ruby 2.3 or later, use unary plus operator to unfreeze a string
literal instead of <code>String#dup</code> and <code>String.new</code>.
Unary plus operator is faster than <code>String#dup</code>.</p>
</div>
<div class="sect2">
<h3 id="safety-21"><a class="anchor" href="#safety-21"></a>Safety</h3>
<div class="paragraph">
<p>This cop&#8217;s autocorrection is unsafe because <code>String.new</code> (without operator) is not
exactly the same as <code>''`. These differ in encoding. `String.new.encoding` is always
`ASCII-8BIT`. However, `('').encoding</code> is the same as script encoding(e.g. <code>UTF-8</code>).
if you expect <code>ASCII-8BIT</code> encoding, disable this cop.</p>
</div>
</div>
<div class="sect2">
<h3 id="examples-49"><a class="anchor" href="#examples-49"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
''.dup          # when Ruby 3.2 or lower
"something".dup # when Ruby 3.2 or lower
String.new
String.new('')
String.new('something')

# good
+'something'
+''</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="performanceuridefaultparser"><a class="anchor" href="#performanceuridefaultparser"></a>Performance/UriDefaultParser</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enabled by default</th>
<th class="tableblock halign-left valign-top">Safe</th>
<th class="tableblock halign-left valign-top">Supports autocorrection</th>
<th class="tableblock halign-left valign-top">Version Added</th>
<th class="tableblock halign-left valign-top">Version Changed</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Identifies places where <code>URI::Parser.new</code> can be replaced by <code>URI::DEFAULT_PARSER</code>.</p>
</div>
<div class="sect2">
<h3 id="examples-50"><a class="anchor" href="#examples-50"></a>Examples</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-ruby hljs" data-lang="ruby"># bad
URI::Parser.new

# good
URI::DEFAULT_PARSER</code></pre>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="cops.html">Cops</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <p>Copyright (C) 2012-2024 <a href="https://batsov.com">Bozhidar Batsov</a> and RuboCop contributors.</p>
  <p>Except where otherwise noted, docs.rubocop.org is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a> (CC BY-SA 4.0).</p>
</footer>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@docsearch/js@3.3.3"></script>
<script type="text/javascript">
 docsearch({
   container: '#docsearch',
   appId: '2GTF3GZ5BX',
   apiKey: 'b6bbe6539f46224f4f39cd14a1b7ae78',
   indexName: 'rubocop',
   debug: false // Set debug to true if you want to inspect the dropdown
 });
</script>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async src="../_/js/vendor/highlight.js"></script>
  </body>
</html>
